<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>图论入门 | Zdx-1</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('/img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Zdx-1" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>图论入门</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2024-03-11T13:13:17.000Z" id="date"> 2024-03-11</time></div></span><br><span>Last Update: <div class="control"><time datetime="2024-03-31T12:54:26.000Z" id="updated"> 2024-03-31</time></div></span></div></div><hr><div id="post-content"><h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><p>本章节为图论最基本的内容，要求每位同学都要尽量掌握。</p>
<h2 id="图的基本概念"><a href="#图的基本概念" class="headerlink" title="图的基本概念"></a>图的基本概念</h2><p>图：由点(<code>node</code>，或者 <code>vertex</code>)和连接点的边(<code>edge</code>)组成。图是点和边构成的网。</p>
<p>树：特殊的图</p>
<p>树，即连通无环图树的结点从根开始，层层扩展子树，是一种层次关系，这种层次关系，保证了树上不会出现环路。两点之间的路径：有且仅有一条路径。最近公共祖先。</p>
<h3 id="图的种类"><a href="#图的种类" class="headerlink" title="图的种类"></a>图的种类</h3><p>（1）无向无权图，边没有权值、没有方向； （2）有向无权图，边有方向、无权值； （3）加权无向图，边有权值，但没有方向； （4）加权有向图； （5）有向无环图（Directed Acyclic Graph，DAG）。</p>
<h3 id="图算法的时间分析"><a href="#图算法的时间分析" class="headerlink" title="图算法的时间分析"></a>图算法的时间分析</h3><p>图算法的复杂度和边的数量 E、点的数量 V 相关。$O(V+E)$：几乎是图问题中能达到的最好程度。$O(V\log E)$、$O(E\log V)$：很好的算法。$O(V^2)$、$O(E^2)$或更高：不算是好的算法。</p>
<h2 id="图的存储"><a href="#图的存储" class="headerlink" title="图的存储"></a>图的存储</h2><p>能快速访问：图的存储，能让程序很快定位结点 <code>u</code> 和 <code>v</code> 的边<code>(u, v)</code> 。</p>
<ul>
<li>数组存边：简单、空间使用最少；无法快递定位</li>
<li>邻接矩阵：简单、空间使用最大；定位最快 <code>dis[a][b]</code></li>
<li>邻接表：空间很少，定位较快</li>
<li>链式前向星：空间更少，定位较快</li>
</ul>
<p><strong>注： 存储方式跟题目相匹配，占用空间少定位快也不一定是问题的最优存储方式。</strong></p>
<h3 id="数组存边"><a href="#数组存边" class="headerlink" title="数组存边"></a>数组存边</h3><p>优点：简单、最省空间。 缺点：无法定位某条边。 应用：<code>bellman-ford</code> 算法、最小生成树的 <code>kruskal</code> 算法</p>
<ul>
<li>C++</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// c/c++实现</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span>&#123;</span><br>    <span class="hljs-type">int</span> from,to,dis;<br>&#125;e[M]; <span class="hljs-comment">//结构体数组存边</span><br><br><span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;++i)<br>    <span class="hljs-built_in">cin</span>&gt;&gt;e[i].from&gt;&gt;e[i].to&gt;&gt;e[i].dis;<br></code></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//Java实现</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span> &#123; <span class="hljs-type">int</span> from; <span class="hljs-type">int</span> to; <span class="hljs-type">int</span> dis;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Edge</span><span class="hljs-params">(<span class="hljs-type">int</span> from, <span class="hljs-type">int</span> to, <span class="hljs-type">int</span> dis)</span> &#123;<br>        <span class="hljs-built_in">this</span>.from = from;<br>        <span class="hljs-built_in">this</span>.to = to;<br>        <span class="hljs-built_in">this</span>.dis = dis;<br>    &#125;<br><br>&#125;<br><br>Edge[] e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Edge</span>[M];<br><br><span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br><span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> sc.nextInt();<br><span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> sc.nextInt();<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; ++i)<br>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> sc.nextInt();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> sc.nextInt();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">dis</span> <span class="hljs-operator">=</span> sc.nextInt();<br>    e[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Edge</span>(from, to, dis);<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python实现</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">self, f, t, d</span>):<br>        self.<span class="hljs-keyword">from</span> = f<br>        self.to = t<br>        self.dis = d<br><br>e = [Edge(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M)]<br><br>n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>):<br>    e[i].<span class="hljs-keyword">from</span>, e[i].to, e[i].dis = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br></code></pre></td></tr></table></figure>

<h3 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h3><p>二维数组： $graph[NUM ][NUM ]$ 无向图： $graph[i][j]&#x3D;graph[j][i]。$ 有向图： $graph[i][j]\neq graph[j][i]。$ 权值： $graph[i][j]存结点i到j的边的权值。$ 例如 $graph[1][2]&#x3D; 3，graph[2][1] &#x3D; 5等等。$ 用 $graph[i][j]&#x3D; INF表示i，j之间无边。$</p>
<p>优点：</p>
<ul>
<li>适合稠密图；</li>
<li>编码非常简短；</li>
<li>对边的存储、查询、更新等操作又快又简单。</li>
</ul>
<p>缺点：</p>
<ul>
<li>存储复杂度 $O(V^2)$太高。V&#x3D;10000 时，空间 100M。</li>
<li>不能存储重边。</li>
</ul>
<h3 id="邻接表和链式前向星"><a href="#邻接表和链式前向星" class="headerlink" title="邻接表和链式前向星"></a>邻接表和链式前向星</h3><p>邻接表（指针或数组下标）和链式前向星（容器模拟）的思路一样，只是表达方式不同。</p>
<p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/29bc6278e9e147f9597ba0c263fc1903-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/29bc6278e9e147f9597ba0c263fc1903-0.png" alt="图片描述"></p>
<ul>
<li>C++</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span><br>    <span class="hljs-type">int</span> from, to; <span class="hljs-type">long</span> <span class="hljs-type">long</span> w; <span class="hljs-comment">//起点，终点，权值。起点from并没有用到，e[i]的i就是from</span><br>    edge(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> c)&#123;from=a; to=b; w=c;&#125;<br>&#125;;<br><span class="hljs-built_in">vector</span>&lt;edge&gt;e[N];          <span class="hljs-comment">//用于存储图</span><br></code></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span> &#123;<br>    <span class="hljs-type">int</span> from, to;<br>    <span class="hljs-type">long</span> w;<br><br>    Edge(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">long</span> c) &#123;<br>        from = a;<br>        to = b;<br>        w = c;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">static</span> ArrayList&lt;Edge&gt;[] e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>[N];<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined">class Edge:<br>    def __init__(self, fr, to, w):<br>        self.fr = fr<br>        self.to = to<br>        self.w = w<br><br>e = [[] for _ in range(N)]<br></code></pre></td></tr></table></figure>

<p>我们会在使用的时候进行讲解。</p>
<h2 id="最短路问题"><a href="#最短路问题" class="headerlink" title="最短路问题"></a>最短路问题</h2><p>最广为人知的图论问题就是最短路径问题。</p>
<p>简单图的最短路径</p>
<ul>
<li>树上的路径：任意 $2$ 点之间</li>
</ul>
<p>只有一条路径</p>
<ul>
<li>所有边长都为 $1$ 的图：用 <code>BFS</code> 搜最短路径，复杂度 $O(n+m)$</li>
</ul>
<p>普通图的最短路径</p>
<ul>
<li>边长：不一定等于 $1$，而且可能为负数</li>
<li>算法：<code>Floyd</code>、<code>Dijkstra</code>、<code>SPFA</code> 等，各有应用场景，不可互相替代</li>
</ul>
<h3 id="最短路算法比较"><a href="#最短路算法比较" class="headerlink" title="最短路算法比较"></a>最短路算法比较</h3><table>
<thead>
<tr>
<th>问题</th>
<th>边权</th>
<th>算法</th>
<th>时间复杂度</th>
</tr>
</thead>
<tbody><tr>
<td>一个起点，一个终点</td>
<td>非负数；无边权（或边权为 1）</td>
<td>A*</td>
<td>&lt; $O((m+n)\log n)$</td>
</tr>
<tr>
<td></td>
<td></td>
<td>双向广搜</td>
<td>&lt; $O((m+n)\log n)$</td>
</tr>
<tr>
<td></td>
<td></td>
<td>贪心最优搜索</td>
<td>&lt; $O(m+n)$</td>
</tr>
<tr>
<td>一个起点到其他所有点</td>
<td>无边权（或边权为 1）</td>
<td>BFS</td>
<td>$O(m+n)$</td>
</tr>
<tr>
<td></td>
<td>非负数</td>
<td>Dijkstra(堆优化优先队列)</td>
<td>$O((m+n)\log n)$</td>
</tr>
<tr>
<td></td>
<td>允许有负数</td>
<td>SPFA</td>
<td>&lt; $O(mn)$</td>
</tr>
<tr>
<td>所有点对之间</td>
<td>允许有负数</td>
<td>Floyd-Warshall</td>
<td>$O(n^3)$</td>
</tr>
</tbody></table>
<p>什么算法也不能解决存在负环图的最短路的问题！最多是判断是否存在，或者找到负环。</p>
<p>网站推荐：<a target="_blank" rel="noopener" href="https://csacademy.com/app/graph_editor/?tdsourcetag=s_pctim_aiomsg">CSAcademy Graph Editor</a></p>
<p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/5c77aaf44a27ba24fd4dfee6aa36a8ce-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/5c77aaf44a27ba24fd4dfee6aa36a8ce-0.png" alt="图片描述"></p>
<p>方便图论的学习。</p>
<h3 id="Floyd-算法"><a href="#Floyd-算法" class="headerlink" title="Floyd 算法"></a>Floyd 算法</h3><ul>
<li>最简单的最短路径算法，代码仅有 $4$ 行</li>
<li>存图：最简单的矩阵存图</li>
<li>易懂，比暴力的搜索更简单易懂。</li>
<li>效率不高，不能用于大图在某些场景下有自己的优势，难以替代。能做传递闭包问题（离散数学）</li>
</ul>
<p>C++、Java</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//java 和 c++</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">1</span>; k&lt;=n; k++)         <span class="hljs-comment">//floyd的三重循环</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>; i&lt;=n; i++)<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>; j&lt;=n; j++)      <span class="hljs-comment">// k循环在i、j循环外面</span><br>            dp[i][j] = min(dp[i][j], dp[i][k] + dp[k][j]);<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>): <span class="hljs-comment">#floyd的三重循环</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>): <span class="hljs-comment"># k循环在i、j循环外面</span><br>            dp[i][j] = <span class="hljs-built_in">min</span>(dp[i][j], dp[i][k] + dp[k][j])<br></code></pre></td></tr></table></figure>

<p><code>Floyd算法</code>：<code>多源</code>最短路算法，一次计算能得到图中每一对结点之间（<code>多对多</code>）的最短路径。 <code>Dijkstra</code>、<code>Bellman-Ford</code>、<code>SPFA</code>算法：<code>单源</code>最短路径算法（<code>Single source shortest path algorithm</code>），一次计算能得到一个起点到其他所有点（<code>一对多</code>）的最短路径。在截止目前的蓝桥杯大赛中，<code>Floyd</code>算法是最常见的最短路径算法。 以上统计包括国赛和省赛，所以另外两种仍然要进行学习。</p>
<h4 id="Floyd-算法思想：动态规划"><a href="#Floyd-算法思想：动态规划" class="headerlink" title="Floyd 算法思想：动态规划"></a>Floyd 算法思想：动态规划</h4><p>下面为 <code>Floyd</code> 算法的原理，不看背代码也可以。</p>
<ul>
<li>动态规划：求图上两点 <code>i</code>、<code>j</code> 之间的最短距离，按“从小图到全图”的步骤，在逐步扩大图的过程中计算和更新最短路。</li>
<li>定义状态：<code>dp[k][i][j]，i、j、k</code>是点的编号，范围 <code>1 ~ n</code>。状态<code>dp[k][i][j]</code>表示在包含 <code>1 ~ k</code> 点的子图上，点对 <code>i、j</code> 之间的最短路。</li>
<li>状态转移方程：从子图 <code>1 ~ k-1</code> 扩展到子图 <code>1 ~ k</code> $dp[k][i][j] &#x3D; min(dp[k-1][i][j], dp[k-1][i][k] + dp[k-1][k][j])$</li>
</ul>
<p>首先是包含 <code>1 ~ k-1</code> 点的子图。 $dp[k-1][i][j]$：不包含 <code>k</code> 点子图内的点对 <code>i、j</code> 的最短路； $dp[k-1][i][k] + dp[k-1][k][j]$：经过 k 点的新路径的长度，即这条路径从 <code>i</code> 出发，先到 <code>k</code>，再从 <code>k</code> 到终点 <code>j</code>。 比较：不经过 <code>k</code> 的最短路径$dp[k-1][i][j]$和经过 <code>k</code> 的新路径，较小者就是新的$dp[k][i][j]$。</p>
<p>所以 <code>Floyd</code> 的原理就是每次引入一个新的点，用它去更新其他点的最短距离。</p>
<p><code>k</code> 从 <code>1</code> 逐步扩展到 <code>n</code>：最后得到的$dp[n][i][j]$是点对 <code>i、j</code> 之间的最短路径长度。 初值$dp[0][i][j]$：若 <code>i、j</code> 是直连的，就是它们的边长；若不直连，赋值为无穷大。 <code>i、j</code> 是任意点对：计算结束后得到了所有点对之间的最短路。</p>
<p>$dp[k][i][j] &#x3D; min(dp[k-1][i][j], dp[k-1][i][k] + dp[k-1][k][j])$ 用滚动数组简化： $dp[i][j] &#x3D; min(dp[i][j], dp[i][k] + dp[k][j])$</p>
<p><strong>特点：</strong></p>
<ul>
<li>在一次计算后求得所有结点之间的最短距离。</li>
<li>代码极其简单，是最简单的最短路算法。</li>
<li>效率低下，计算复杂度是 $O(n^3)$，只能用于 $n &lt; 300$ 的小规模的图。</li>
<li>存图用邻接矩阵 <code>dp[][]</code> 。因为 <code>Floyd</code> 算法计算的结果是所有点对之间的最短路，本身就需要 <code>n^2</code> 的空间，用矩阵存储最合适。</li>
<li>能判断负圈。 负圈：若图中有权值为负的边，某个经过这个负边的环路，所有边长相加的总长度也是负数，这就是负圈。在这个负圈上每绕一圈，总长度就更小，从而陷入在负圈上兜圈子的死循环。 <code>Floyd</code> 算法很容易判断负圈，只要在算法运行过程出现任意一个 <code>dp[i][i] &lt; 0</code> 就说明有负圈。因为 <code>dp[i][i]</code> 是从 <code>i</code> 出发，经过其他中转点绕一圈回到自己的最短路径，如果小于零，就存在负圈。</li>
</ul>
<h3 id="Dijkstra-算法"><a href="#Dijkstra-算法" class="headerlink" title="Dijkstra 算法"></a>Dijkstra 算法</h3><ul>
<li>Dijkstra：单源最短路径问题。</li>
<li>优点：非常高效而且稳定。</li>
<li>缺点：只能处理不含有负权边的图。</li>
<li>思路：贪心思想+优先队列。</li>
</ul>
<h4 id="算法思想"><a href="#算法思想" class="headerlink" title="算法思想"></a>算法思想</h4><p><code>Dijkstra</code> 算法算是贪心思想实现的，首先把起点到所有点的距离存下来找个最短的，然后松弛一次再找出最短的，所谓的松弛操作就是，遍历一遍看通过刚刚找到的距离最短的点作为中转站会不会更近，如果更近了就更新距离，这样把所有的点找遍之后就存下了起点到其他所有点的最短距离。</p>
<p><strong>为什么是每次都是找最小的？</strong></p>
<p>因为最小边的不会被其它的点松弛，只有可能最小边去松弛别人。 如果存在一个点 $K$ 能够松弛 $ab$ 的话那么一定有 $ak$ 距离加上 $kb$ 的距离小于 $ab$，已知 $ab$ 最短，所以不存在 $ak + kb &lt; ab$。</p>
<p><code>Dijkstra</code> 算法应用了贪心法的思想，即“抄近路走，肯定能找到最短路径”。</p>
<p>算法高效稳定：</p>
<ul>
<li><code>Dijkstra</code> 的每次迭代，只需要检查上次已经确定最短路径的那些结点的邻居，检查范围很小，算法是高效的；</li>
<li>每次迭代，都能得到至少一个结点的最短路径，算法是稳定的</li>
</ul>
<p>优先队列实现：</p>
<ul>
<li>每次往队列中放新数据时，按从小到大的顺序放，采用小顶堆的方式，复杂度是 $O(logn)$，保证最小的数总在最前面；</li>
<li>找最小值，直接取 <code>B</code> 的第一个数，复杂度是 $O(1)$。</li>
<li>复杂度：用优先队列时，<code>Dijkstra</code> 算法的复杂度是 $O(mlogn)$，是最高效的最短路算法。</li>
</ul>
<p>维护两个集合：已确定最短路径的结点集合 <code>A</code>、这些结点向外扩散的邻居结点集合 <code>B</code>。</p>
<ol>
<li>把起点 <code>s</code> 放到 <code>A</code> 中，把 <code>s</code> 所有的邻居放到 <code>B</code> 中。此时，邻居到 <code>s</code> 的距离就是直连距离。</li>
<li>从 <code>B</code> 中找出距离起点 <code>s</code> 最短的结点 <code>u</code>，放到 <code>A</code> 中。</li>
<li>把 <code>u</code> 所有的新邻居放到 <code>B</code> 中。显然，<code>u</code> 的每一条边都连接了一个邻居，每个新邻居都要加进去。其中 <code>u</code> 的一个新邻居 <code>v</code>，它到 <code>s</code> 的距离 <code>dis(s, v)</code> 等于 <code>dis(s, u) + dis(u, v)</code>。</li>
<li>重复(2)、(3)，直到 <code>B</code> 为空时，结束。</li>
</ol>
<p><strong>Dijkstra 的局限性是边的权值不能为负数：</strong></p>
<p>Dijkstra 基于 <code>BFS</code>，计算过程是从起点 <code>s</code> 逐步往外扩散的过程，每扩散一次就用贪心得到到一个点的最短路。 扩散要求路径越来越长，如果遇到一个负权边，会导致路径变短，使扩散失效。</p>
<p>Dijkstra 模板如下：</p>
<ul>
<li>C++</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span>LL;<br><span class="hljs-comment">//这样定义INF的好处是: INF &lt;= INF+x</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N= <span class="hljs-number">3e5</span>+<span class="hljs-number">2</span>;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span><br>    <span class="hljs-type">int</span> from, to; <span class="hljs-type">long</span> <span class="hljs-type">long</span> w; <span class="hljs-comment">//起点，终点，权值。起点from并没有用到，e[i]的i就是from</span><br>    edge(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> c)&#123;from=a; to=b; w=c;&#125;<br>&#125;;<br><span class="hljs-built_in">vector</span>&lt;edge&gt;e[N];          <span class="hljs-comment">//用于存储图</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">s_node</span>&#123;</span><br>    <span class="hljs-type">int</span> id; <span class="hljs-type">long</span> <span class="hljs-type">long</span> n_dis;   <span class="hljs-comment">//id：结点；n_dis：这个结点到起点的距离</span><br>    s_node(<span class="hljs-type">int</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> c)&#123;id=b; n_dis=c;&#125;<br>    <span class="hljs-type">bool</span> operator &lt; (<span class="hljs-type">const</span> s_node &amp; a) <span class="hljs-type">const</span><br>    &#123; <span class="hljs-keyword">return</span> n_dis &gt; a.n_dis;&#125;<br>&#125;;<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-type">int</span> pre[N];                                <span class="hljs-comment">//记录前驱结点，用于生成路径</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">print_path</span><span class="hljs-params">(<span class="hljs-type">int</span> s, <span class="hljs-type">int</span> t)</span> &#123;            <span class="hljs-comment">//打印从s到t的最短路</span><br>    <span class="hljs-keyword">if</span>(s==t)&#123; <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, s); <span class="hljs-keyword">return</span>; &#125;  <span class="hljs-comment">//打印起点</span><br>    print_path(s, pre[t]);                 <span class="hljs-comment">//先打印前一个点</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, t);                      <span class="hljs-comment">//后打印当前点。最后打印的是终点t</span><br>&#125;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span>  dis[N];         <span class="hljs-comment">//记录所有结点到起点的距离</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">dijkstra</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> s = <span class="hljs-number">1</span>;             <span class="hljs-comment">//起点s是1</span><br>    <span class="hljs-type">bool</span> done[N]; <span class="hljs-comment">//done[i]=true表示到结点i的最短路径已经找到</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) &#123;dis[i]=INF; done[i]=<span class="hljs-literal">false</span>; &#125;    <span class="hljs-comment">//初始化</span><br>    dis[s]=<span class="hljs-number">0</span>;                           <span class="hljs-comment">//起点到自己的距离是0</span><br>    <span class="hljs-built_in">priority_queue</span> &lt;s_node&gt; Q;          <span class="hljs-comment">//优先队列，存结点信息</span><br>    Q.push(s_node(s, dis[s]));          <span class="hljs-comment">//起点进队列</span><br>    <span class="hljs-keyword">while</span> (!Q.empty())   &#123;<br>        s_node u = Q.top();             <span class="hljs-comment">//pop出距起点s距离最小的结点u</span><br>        Q.pop();<br>        <span class="hljs-keyword">if</span>(done[u.id])  <span class="hljs-keyword">continue</span>;       <span class="hljs-comment">//丢弃已经找到最短路径的结点。即集合A中的结点            </span><br>        done[u.id]= <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;e[u.id].size(); i++) &#123;  <span class="hljs-comment">//检查结点u的所有邻居</span><br>            edge y = e[u.id][i];         <span class="hljs-comment">//u.id的第i个邻居是y.to</span><br>            <span class="hljs-keyword">if</span>(done[y.to])  <span class="hljs-keyword">continue</span>;    <span class="hljs-comment">//丢弃已经找到最短路径的邻居结点                </span><br>            <span class="hljs-keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;<br>                dis[y.to] = y.w + u.n_dis;<br>                Q.push(s_node(y.to, dis[y.to]));  <span class="hljs-comment">//扩展新的邻居，放到优先队列中</span><br>                pre[y.to]=u.id;  <span class="hljs-comment">//如果有需要，记录路径</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// print_path(s,n);          //如果有需要，打印路径: 起点1，终点n</span><br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)    e[i].clear();<br>    <span class="hljs-keyword">while</span> (m--) &#123;<br>        <span class="hljs-type">int</span> u,v,w;  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%lld&quot;</span>,&amp;u,&amp;v,&amp;w);<br>        e[u].push_back(edge(u,v,w));<br>     <span class="hljs-comment">// e[v].push_back(edge(v,u,w));    //本题是单向道路</span><br>    &#125;<br>    dijkstra();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)&#123;<br>        <span class="hljs-keyword">if</span>(dis[i]&gt;=INF)  <span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-string">&quot;-1 &quot;</span>;<br>        <span class="hljs-keyword">else</span>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld &quot;</span>, dis[i]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">INF</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x3f3f3f3f3f3f3f3fL</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">300005</span>;<br>    <span class="hljs-keyword">static</span> ArrayList&lt;Edge&gt;[] e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> n, m;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] pre = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span>[] dis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span>[] done = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[N];<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span> &#123;<br>        <span class="hljs-type">int</span> from, to;<br>        <span class="hljs-type">long</span> w;<br><br>        Edge(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">long</span> c) &#123;<br>            from = a;<br>            to = b;<br>            w = c;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SNode</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;SNode&gt; &#123;<br>        <span class="hljs-type">int</span> id;<br>        <span class="hljs-type">long</span> n_dis;<br><br>        SNode(<span class="hljs-type">int</span> b, <span class="hljs-type">long</span> c) &#123;<br>            id = b;<br>            n_dis = c;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(SNode o)</span> &#123;<br>            <span class="hljs-keyword">return</span> Long.compare(n_dis, o.n_dis);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printPath</span><span class="hljs-params">(<span class="hljs-type">int</span> s, <span class="hljs-type">int</span> t)</span> &#123;<br>        <span class="hljs-keyword">if</span> (s == t) &#123;<br>            System.out.print(s + <span class="hljs-string">&quot; &quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        printPath(s, pre[t]);<br>        System.out.print(t + <span class="hljs-string">&quot; &quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dijkstra</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        PriorityQueue&lt;SNode&gt; Q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();<br>        Arrays.fill(dis, INF);<br>        dis[s] = <span class="hljs-number">0</span>;<br>        Q.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SNode</span>(s, dis[s]));<br>        <span class="hljs-keyword">while</span> (!Q.isEmpty()) &#123;<br>            <span class="hljs-type">SNode</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> Q.poll();<br>            <span class="hljs-keyword">if</span> (done[u.id])<br>                <span class="hljs-keyword">continue</span>;<br>            done[u.id] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">for</span> (Edge y : e[u.id]) &#123;<br>                <span class="hljs-keyword">if</span> (done[y.to])<br>                    <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;<br>                    dis[y.to] = y.w + u.n_dis;<br>                    Q.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SNode</span>(y.to, dis[y.to]));<br>                    pre[y.to] = u.id;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// printPath(s, n);</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">br</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in));<br>        <span class="hljs-type">StringTokenizer</span> <span class="hljs-variable">st</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringTokenizer</span>(br.readLine());<br>        n = Integer.parseInt(st.nextToken());<br>        m = Integer.parseInt(st.nextToken());<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)<br>            e[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>            st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringTokenizer</span>(br.readLine());<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> Integer.parseInt(st.nextToken());<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> Integer.parseInt(st.nextToken());<br>            <span class="hljs-type">long</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> Long.parseLong(st.nextToken());<br>            e[u].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Edge</span>(u, v, w));<br>            <span class="hljs-comment">// e[v].add(new Edge(v, u, w)); //本题是单向道路</span><br>        &#125;<br>        dijkstra();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">if</span> (dis[i] &gt;= INF)<br>                System.out.print(<span class="hljs-string">&quot;-1 &quot;</span>);<br>            <span class="hljs-keyword">else</span><br>                System.out.print(dis[i] + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs undefined">import heapq<br><br>INF = 0x3f3f3f3f3f3f3f3f<br>N = 300002<br><br>class Edge:<br>    def __init__(self, fr, to, w):<br>        self.fr = fr<br>        self.to = to<br>        self.w = w<br><br>class SNode:<br>    def __init__(self, id, n_dis):<br>        self.id = id<br>        self.n_dis = n_dis<br><br>    def __lt__(self, other):<br>        return self.n_dis &lt; other.n_dis<br><br>def print_path(s, t):<br>    if s == t:<br>        print(s, end=&quot; &quot;)<br>        return<br>    print_path(s, pre[t])<br>    print(t, end=&quot; &quot;)<br><br>def dijkstra():<br>    s = 1<br>    done = [False] * N<br>    dis = [INF] * N<br>    pre = [-1] * N<br>    dis[s] = 0<br>    pq = []<br>    heapq.heappush(pq, SNode(s, dis[s]))<br>    while pq:<br>        u = heapq.heappop(pq)<br>        if done[u.id]:<br>            continue<br>        done[u.id] = True<br>        for y in e[u.id]:<br>            if done[y.to]:<br>                continue<br>            if dis[y.to] &gt; y.w + u.n_dis:<br>                dis[y.to] = y.w + u.n_dis<br>                heapq.heappush(pq, SNode(y.to, dis[y.to]))<br>                pre[y.to] = u.id<br>    for i in range(1, n+1):<br>        if dis[i] &gt;= INF:<br>            print(&quot;-1&quot;, end=&quot; &quot;)<br>        else:<br>            print(dis[i], end=&quot; &quot;)<br><br>n, m = map(int, input().split())<br>e = [[] for _ in range(N)]<br>for i in range(m):<br>    u, v, w = map(int, input().split())<br>    e[u].append(Edge(u, v, w))<br><br>dijkstra()<br></code></pre></td></tr></table></figure>

<h3 id="Bellman-Ford-算法"><a href="#Bellman-Ford-算法" class="headerlink" title="Bellman-Ford 算法"></a>Bellman-Ford 算法</h3><p>BFS 的扩散思想，每个人都去问自己的相邻节点到 <code>S</code> 点的距离最近是多少。</p>
<p>第一轮至少有一个点得到了到 <code>S</code> 的最短距离，即与 <code>S</code> 相邻的节点，标记为 <code>T1</code></p>
<p>重复以上操作，那么必然至少又有一个节点找到了与 <code>S</code> 的最短距离，即与 <code>T1</code> 相邻的节点，标记为 <code>T2</code></p>
<p><strong>一共需要几轮操作？</strong></p>
<p>每一轮操作，都至少有一个新的结点得到了到 <code>S</code> 的最短路径。所以，最多只需要 <code>n</code> 轮操作，就能完成 <code>n</code> 个结点。在每一轮操作中，需要检查所有 <code>m</code> 个边，更新最短距离。</p>
<p>Bellman-Ford 算法的复杂度：<code>O(nm)</code>。</p>
<p><strong>Bellman-Ford 能判断负圈：</strong></p>
<p>没有负圈时，只需要 <code>n</code> 轮就结束。</p>
<p>如果超过 <code>n</code> 轮，最短路径还有变化，那么肯定有负圈。</p>
<h4 id="SPFA-算法"><a href="#SPFA-算法" class="headerlink" title="SPFA 算法"></a>SPFA 算法</h4><p>队列优化版的 Bellman-Ford</p>
<p>SPFA &#x3D; 队列处理+Bellman-Ford。</p>
<p>Bellman-Ford 算法有很多低效或无效的操作。其核心内容，是在每一轮操作中，更新所有结点到起点 <code>S</code> 的最短距离。 计算和调整一个结点 <code>U</code> 到 <code>S</code> 的最短距离后，如果紧接着调整 <code>U</code> 的邻居结点，这些邻居肯定有新的计算结果；而如果漫无目的地计算不与 <code>U</code> 相邻的结点，很可能毫无变化，所以这些操作是低效的。</p>
<p><strong>改进：</strong> 计算结点 <code>U</code> 之后，下一步只计算和调整它的邻居，能加快收敛的过程。 这些步骤用队列进行操作，这就是 SPFA。</p>
<p>（1）起点 <code>S</code> 入队，计算它所有邻居到 <code>S</code> 的最短距离。把 <code>S</code> 出队，状态有更新的邻居入队，没更新的不入队。 （2）现在队列的头部是 <code>S</code> 的一个邻居 <code>U</code>。弹出 <code>U</code>，更新它所有邻居的状态，把其中有状态变化的邻居入队列。 （3）继续以上过程，直到队列空。这也意味着，所有结点的状态都不再更新。最后的状态就是到起点 <code>S</code> 的最短路径。</p>
<p>弹出 <code>U</code> 之后，在后面的计算中，<code>U</code> 可能会再次更新状态（后来发现，<code>U</code> 借道别的结点去 <code>S</code>，路更近）。所以，<code>U</code> 可能需要重新入队列。 有可能只有很少结点重新进入队列，也有可能很多。这取决于图的特征。</p>
<p><strong>所以，SPFA 是不稳定的,所以根据题目的类型，我们要选择合适的算法。</strong></p>
<p><strong>SPFA 模板如下：</strong></p>
<ul>
<li>C++</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e3</span>+<span class="hljs-number">10</span>;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<br>    <span class="hljs-type">int</span> to;    <span class="hljs-type">long</span> <span class="hljs-type">long</span> w;<br>    <span class="hljs-built_in">edge</span>(<span class="hljs-type">int</span> tt,<span class="hljs-type">long</span> <span class="hljs-type">long</span> ww) &#123;to = tt; w = ww;&#125;<br>&#125;;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> dist[N];<br><span class="hljs-type">int</span> inq[N];<br>vector&lt;edge&gt; e[N];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">spfa</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist,<span class="hljs-number">0x3f</span>,<span class="hljs-built_in">sizeof</span>(dist));<br>    dist[s] = <span class="hljs-number">0</span>;      <span class="hljs-comment">//起点到自己的距离是0</span><br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(s);        <span class="hljs-comment">//从s开始，s进队列</span><br>    inq[s] = <span class="hljs-number">1</span>;       <span class="hljs-comment">//起点在队列中</span><br>    <span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>()) &#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        inq[u] = <span class="hljs-number">0</span>;   <span class="hljs-comment">//u已经不在队列中</span><br>        <span class="hljs-keyword">if</span>(dist[u] == INF)     <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;i &lt; e[u].<span class="hljs-built_in">size</span>();i++) &#123;   <span class="hljs-comment">//遍历u的邻居</span><br>            <span class="hljs-type">int</span> v = e[u][i].to;<br>            <span class="hljs-type">long</span> <span class="hljs-type">long</span> w = e[u][i].w;<br>            <span class="hljs-keyword">if</span>(dist[v] &gt; dist[u]+w) &#123;         <span class="hljs-comment">//u的第i个邻居v，它借道u，到s更近</span><br>                dist[v] = dist[u]+w;          <span class="hljs-comment">//更新邻居v到s的距离</span><br>                <span class="hljs-keyword">if</span>(!inq[v]) &#123;      <span class="hljs-comment">//邻居v更新状态了，但v不在队列中，放进队列</span><br>                    q.<span class="hljs-built_in">push</span>(v);<br>                    inq[v] = <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n,m,s;cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= m;i++)    &#123;<br>        <span class="hljs-type">int</span> u,v; <span class="hljs-type">long</span> <span class="hljs-type">long</span> w;<br>        cin&gt;&gt;u&gt;&gt;v&gt;&gt;w;<br>        e[u].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">edge</span>(v,w));<br>    &#125;<br>    <span class="hljs-built_in">spfa</span>(s);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++) &#123;<br>        <span class="hljs-keyword">if</span>(dist[i]==INF)  cout &lt;&lt; <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">else</span>              cout &lt;&lt; dist[i];<br>        <span class="hljs-keyword">if</span>(i != n)        cout &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>        <span class="hljs-keyword">else</span>              cout &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">INF</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x3f3f3f3f3f3f3f3fL</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">5010</span>;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span>[] dist = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] inq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> List&lt;edge&gt;[] e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>[N];<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">edge</span> &#123;<br>        <span class="hljs-type">int</span> to;<br>        <span class="hljs-type">long</span> w;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">edge</span><span class="hljs-params">(<span class="hljs-type">int</span> tt, <span class="hljs-type">long</span> ww)</span> &#123;<br>            to = tt;<br>            w = ww;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">spfa</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> &#123;<br>        Arrays.fill(dist, INF);<br>        dist[s] = <span class="hljs-number">0</span>;<br>        Queue&lt;Integer&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>        q.add(s);<br>        inq[s] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (!q.isEmpty()) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> q.poll();<br>            inq[u] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span> (dist[u] == INF) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; e[u].size(); i++) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> e[u].get(i).to;<br>                <span class="hljs-type">long</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> e[u].get(i).w;<br>                <span class="hljs-keyword">if</span> (dist[v] &gt; dist[u] + w) &#123;<br>                    dist[v] = dist[u] + w;<br>                    <span class="hljs-keyword">if</span> (inq[v] == <span class="hljs-number">0</span>) &#123;<br>                        q.add(v);<br>                        inq[v] = <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            e[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> in.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> in.nextInt();<br>            <span class="hljs-type">long</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> in.nextLong();<br>            e[u].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">edge</span>(v, w));<br>        &#125;<br>        spfa(s);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">if</span> (dist[i] == INF) System.out.print(<span class="hljs-string">&quot;-1 &quot;</span>);<br>            <span class="hljs-keyword">else</span> System.out.print(dist[i] + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> heapq<br><br>INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span><br>N = <span class="hljs-number">5010</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, to, w</span>):<br>        self.to = to<br>        self.w = w<br><br>dist = [INF] * N<br>inq = [<span class="hljs-number">0</span>] * N<br>e = [[] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">spfa</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">global</span> dist<br>    <span class="hljs-keyword">global</span> inq<br>    dist = [INF] * N<br>    dist[s] = <span class="hljs-number">0</span><br>    q = []<br>    heapq.heappush(q, s)<br>    inq[s] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> q:<br>        u = heapq.heappop(q)<br>        inq[u] = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> dist[u] == INF:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e[u])):<br>            v = e[u][i].to<br>            w = e[u][i].w<br>            <span class="hljs-keyword">if</span> dist[v] &gt; dist[u] + w:<br>                dist[v] = dist[u] + w<br>                <span class="hljs-keyword">if</span> inq[v] == <span class="hljs-number">0</span>:<br>                    heapq.heappush(q, v)<br>                    inq[v] = <span class="hljs-number">1</span><br><br>n, m, s = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    u, v, w = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    e[u].append(Edge(v, w))<br>spfa(s)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> dist[i] == INF:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-1&quot;</span>, end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(dist[i], end=<span class="hljs-string">&quot; &quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Dijkstra：适用于权值为非负的图的单源最短路径，用斐波那契堆的复杂度 <code>O(E+VlgV)</code> BellmanFord：适用于权值有负值的图的单源最短路径，并且能够检测负圈，复杂度 <code>O(VE)</code> SPFA：适用于权值有负值，且没有负圈的图的单源最短路径。论文中的复杂度为 <code>O(kE)</code>, 其中 <code>k</code> 为每个节点进入队列的次数，且 <code>k</code> 一般 <code>&lt;=2</code>，但此处的复杂度证明是有问题的，其实 SPFA 的最坏情况应该是 <code>O(VE)</code>。 Floyd：每对节点之间的最短路径。</p>
<p><strong>所以：</strong></p>
<p>单源最短路 (1)当权值为非负时，用 <code>Dijkstra</code>。 (2)当权值有负值，且没有负圈，则用 <code>SPFA</code>。<code>SPFA</code> 能检测负圈，但是不能输出负圈。 (3)当权值有负值，而且可能存在负圈需要输出，则用 <code>BellmanFord</code>。能够检测并输出负圈。 多源最短路使用 <code>Floyd</code></p>
<h2 id="最小生成树"><a href="#最小生成树" class="headerlink" title="最小生成树"></a>最小生成树</h2><p>在无向图中，连通而且不含有圈（环路）的图，称为树。 最小生成树 MST：一个有 <code>n</code> 个结点的连通图的生成树是原图的极小连通子图，包含原图中的所有 <code>n</code> 个结点，并且边的权值之和最小。</p>
<h3 id="Prim-算法"><a href="#Prim-算法" class="headerlink" title="Prim 算法"></a>Prim 算法</h3><p>对点进行贪心操作：“最近的邻居一定在 MST 上”。 从任意一个点 <code>u</code> 开始，把距离它最近的点 <code>v</code> 加入到 MST 中；下一步，把距离 {<code>u, v</code>} 最近的点 <code>w</code> 加入到 MST 中；继续这个过程，直到所有点都在 MST 中。</p>
<ul>
<li>C++</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> MAXN = <span class="hljs-number">1005</span>;<br><span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; demo;<br><span class="hljs-type">int</span> closest[MAXN],lowcost[MAXN],m,n;<span class="hljs-comment">//m为节点的个数，n为边的数量</span><br><span class="hljs-type">int</span> G[MAXN][MAXN];<span class="hljs-comment">//邻接矩阵</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">prim</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>    &#123;<br>        lowcost[i] = INF;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>    &#123;<br>        closest[i] = <span class="hljs-number">0</span>;<br>    &#125;<br>    closest[<span class="hljs-number">0</span>] = <span class="hljs-number">-1</span>;<span class="hljs-comment">//加入第一个点，-1表示该点在集合U中，否则在集合V中</span><br>    <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>,ans = <span class="hljs-number">0</span>,e = <span class="hljs-number">0</span>;<span class="hljs-comment">//e为最新加入集合的点</span><br>    <span class="hljs-keyword">while</span> (num &lt; m<span class="hljs-number">-1</span>)<span class="hljs-comment">//加入m-1条边</span><br>    &#123;<br>        <span class="hljs-type">int</span> micost = INF,miedge = <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>        <span class="hljs-keyword">if</span>(closest[i] != <span class="hljs-number">-1</span>)<br>        &#123;<br>            <span class="hljs-type">int</span> temp = G[e][i];<br>            <span class="hljs-keyword">if</span>(temp &lt; lowcost[i])<br>            &#123;<br>                lowcost[i] = temp;<br>                closest[i] = e;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(lowcost[i] &lt; micost)<br>            micost = lowcost[miedge=i];<br>        &#125;<br>        ans += micost;<br>        demo.push_back(micost);<br>        closest[e = miedge] = <span class="hljs-number">-1</span>;<br>        num++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;m, &amp;n);<br>    <span class="hljs-built_in">memset</span>(G,INF,<span class="hljs-keyword">sizeof</span>(G));<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)<br>    &#123;<br>       <span class="hljs-type">int</span> a,b,c;<br>       <span class="hljs-built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;c;<br><br>       G[b][a]=G[a][b]=c;<br><br>    &#125;<br><br>    <span class="hljs-built_in">cout</span>&lt;&lt;prim()&lt;&lt;<span class="hljs-built_in">endl</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m<span class="hljs-number">-1</span>;i++) <span class="hljs-built_in">cout</span>&lt;&lt;demo[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INF</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x3f3f3f3f</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAXN</span> <span class="hljs-operator">=</span> <span class="hljs-number">1005</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] closest = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[MAXN];<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] lowcost = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[MAXN];<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[][] G = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[MAXN][MAXN];<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> m;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">List</span> <span class="hljs-variable">demo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        m = scanner.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> scanner.nextInt();<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            G[b][a] = G[a][b] = c;<br>        &#125;<br><br>        System.out.println(prim());<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m - <span class="hljs-number">1</span>; i++) &#123;<br>            System.out.print(demo.get(i) + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">prim</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>            lowcost[i] = INF;<br>            closest[i] = <span class="hljs-number">0</span>;<br>        &#125;<br><br>        closest[<span class="hljs-number">0</span>] = -<span class="hljs-number">1</span>;<span class="hljs-comment">//加入第一个点，-1表示该点在集合U中，否则在集合V中</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, ans = <span class="hljs-number">0</span>, e = <span class="hljs-number">0</span>;<span class="hljs-comment">//e为最新加入集合的点</span><br><br>        <span class="hljs-keyword">while</span> (num &lt; m - <span class="hljs-number">1</span>)<span class="hljs-comment">//加入m-1条边</span><br>        &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">micost</span> <span class="hljs-operator">=</span> INF, miedge = -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>                <span class="hljs-keyword">if</span> (closest[i] != -<span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> G[e][i];<br>                    <span class="hljs-keyword">if</span> (temp &lt; lowcost[i]) &#123;<br>                        lowcost[i] = temp;<br>                        closest[i] = e;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (lowcost[i] &lt; micost) &#123;<br>                        micost = lowcost[miedge = i];<br>                    &#125;<br>                &#125;<br>            &#125;<br>            ans += micost;<br>            demo.add(micost);<br>            closest[e = miedge] = -<span class="hljs-number">1</span>;<br>            num++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python">INF = <span class="hljs-number">0x3f3f3f3f</span><br>MAXN = <span class="hljs-number">1005</span><br>closest = [<span class="hljs-number">0</span>] * MAXN<br>lowcost = [<span class="hljs-number">0</span>] * MAXN<br>G = [[INF] * MAXN <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(MAXN)]<br>demo = []<br><br>m,n = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    a,b,c = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    G[b][a]=G[a][b]=c<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">prim</span>():<br>    <span class="hljs-keyword">global</span> closest, lowcost, G, m<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        lowcost[i] = INF<br>        closest[i] = <span class="hljs-number">0</span><br><br>    closest[<span class="hljs-number">0</span>] = -<span class="hljs-number">1</span><br>    num = <span class="hljs-number">0</span><br>    ans = <span class="hljs-number">0</span><br>    e = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> num &lt; m-<span class="hljs-number">1</span>:<br>        micost = INF<br>        miedge = -<span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>            <span class="hljs-keyword">if</span> closest[i] != -<span class="hljs-number">1</span>:<br>                temp = G[e][i]<br>                <span class="hljs-keyword">if</span> temp &lt; lowcost[i]:<br>                    lowcost[i] = temp<br>                    closest[i] = e<br>                <span class="hljs-keyword">if</span> lowcost[i] &lt; micost:<br>                    miedge=i<br>                    micost = lowcost[miedge]<br>        ans += micost<br>        demo.append(micost)<br>        e = miedge<br>        closest[e] = -<span class="hljs-number">1</span><br>        num += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> ans<br><br><span class="hljs-built_in">print</span>(prim())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m - <span class="hljs-number">1</span>): <span class="hljs-built_in">print</span>(demo[i], end=<span class="hljs-string">&#x27; &#x27;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="kruskal-算法"><a href="#kruskal-算法" class="headerlink" title="kruskal 算法"></a>kruskal 算法</h3><p>对边进行贪心操作：“最短的边一定在 <code>MST</code> 上”。 从最短的边开始，把它加入到 <code>MST</code> 中；在剩下的边中找最短的边，加入到 <code>MST</code> 中；继续这个过程，直到所有点都在 <code>MST</code> 中。</p>
<p><code>kruskal</code> 算法的 2 个关键技术： （1）对边进行排序。 （2）判断圈，即处理连通性问题。这个问题用并查集简单而高效，并查集是 <code>kruskal</code> 算法的实现基础。</p>
<p>初始时最小生成树 <code>MST</code> 为空。开始的时候，每个点属于独立的集。</p>
<p>按边长从小到大进行边的遍历操作：</p>
<p>尝试将最小边加入最小生成树：</p>
<ul>
<li>如果边的两个端点属于同一个集合，就说明这两个点已经被加入最小生成树。则不能将边加入，否则就会生成一个环。</li>
<li>如果两个端点不属于同一个集合，就说明该点还未纳入最小生成树，此边可以加入。</li>
</ul>
<p>重复上述操作，直到加入 <code>n-1</code> 条边。</p>
<p><code>kruskal</code> 算法的复杂度包括两部分：对边的排序 <code>O(ElogE)</code>，并查集的操作 <code>O(E)</code>，一共是 <code>O(ElogE + E)</code>，约等于 <code>O(ElogE)</code>，时间主要花在排序上。</p>
<p>如果图的边很多，<code>kruskal</code> 的复杂度要差一些。<code>kruskal</code> 适用于稀疏图，<code>prim</code> 适合稠密图。</p>
<p><strong>模板如下：</strong></p>
<ul>
<li>C++</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><br><span class="hljs-type">int</span> n,m;<br><span class="hljs-type">int</span> father[<span class="hljs-number">1100000</span>];<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-type">int</span> x;<br>    <span class="hljs-type">int</span> y;<br>    <span class="hljs-type">int</span> k;<br>&#125; Q[<span class="hljs-number">1100000</span>];<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (father[x] == x)<br>        <span class="hljs-keyword">return</span> x;<br>    <span class="hljs-keyword">return</span> father[x] = find(father[x]);<br>&#125;<br><span class="hljs-type">bool</span> <span class="hljs-title function_">cmp</span><span class="hljs-params">(node a, node b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> a.k &lt; b.k;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);<br><br>    <span class="hljs-type">int</span> cont = <span class="hljs-number">0</span>,<br>        sum = <span class="hljs-number">0</span>, st = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;Q[i].x, &amp;Q[i].y, &amp;Q[i].k);<br>        cont += Q[i].k;<br>    &#125;<br>    sort(Q, Q + m, cmp);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        father[i] = i;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>    &#123;<br>        <span class="hljs-type">int</span> tx = find(Q[i].x);<br>        <span class="hljs-type">int</span> ty = find(Q[i].y);<br>        <span class="hljs-keyword">if</span> (tx != ty)<br>        &#123;<br>            sum += Q[i].k;<br>            st++;<br>            father[tx] = ty;<br>            <span class="hljs-keyword">if</span> (st == n - <span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, sum);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> n, m;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] father;<br>    <span class="hljs-keyword">static</span> Node[] Q;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>        <span class="hljs-type">int</span> x;<br>        <span class="hljs-type">int</span> y;<br>        <span class="hljs-type">int</span> k;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> k)</span> &#123;<br>            <span class="hljs-built_in">this</span>.x = x;<br>            <span class="hljs-built_in">this</span>.y = y;<br>            <span class="hljs-built_in">this</span>.k = k;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        n = scanner.nextInt();<br>        m = scanner.nextInt();<br><br>        father = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n + <span class="hljs-number">1</span>];<br>        Q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>[m];<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">cont</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, sum = <span class="hljs-number">0</span>, st = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            Q[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(x, y, k);<br>            cont += k;<br>        &#125;<br>        Arrays.sort(Q, (a, b) -&gt; a.k - b.k);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)<br>            father[i] = i;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">tx</span> <span class="hljs-operator">=</span> find(Q[i].x);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">ty</span> <span class="hljs-operator">=</span> find(Q[i].y);<br>            <span class="hljs-keyword">if</span> (tx != ty) &#123;<br>                sum += Q[i].k;<br>                st++;<br>                father[tx] = ty;<br>                <span class="hljs-keyword">if</span> (st == n - <span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        System.out.println(sum);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>        <span class="hljs-keyword">if</span> (father[x] == x)<br>            <span class="hljs-keyword">return</span> x;<br>        <span class="hljs-keyword">return</span> father[x] = find(father[x]);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br>father = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br>Q = []<br><br>cont = <span class="hljs-number">0</span><br><span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>st = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    x, y, k = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    Q.append(&#123;<span class="hljs-string">&#x27;x&#x27;</span>: x, <span class="hljs-string">&#x27;y&#x27;</span>: y, <span class="hljs-string">&#x27;k&#x27;</span>: k&#125;)<br>    cont += k<br><br>Q.sort(key=<span class="hljs-keyword">lambda</span> x:x[<span class="hljs-string">&#x27;k&#x27;</span>])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">x</span>):<br><br>    <span class="hljs-keyword">if</span> father[x] == x :<br>        <span class="hljs-keyword">return</span> x<br>    father[x] = find(father[x])<br>    <span class="hljs-keyword">return</span> father[x]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    tx = find(Q[i][<span class="hljs-string">&#x27;x&#x27;</span>])<br>    ty = find(Q[i][<span class="hljs-string">&#x27;y&#x27;</span>])<br>    <span class="hljs-keyword">if</span> tx != ty:<br>        <span class="hljs-built_in">sum</span> += Q[i][<span class="hljs-string">&#x27;k&#x27;</span>]<br>        st += <span class="hljs-number">1</span><br>        father[tx] = ty<br>        <span class="hljs-keyword">if</span> st == n - <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>)<br></code></pre></td></tr></table></figure>

<h2 id="图论例题"><a href="#图论例题" class="headerlink" title="图论例题"></a>图论例题</h2><h2 id="蓝桥王国-lanqiaoOJ-题号-1122"><a href="#蓝桥王国-lanqiaoOJ-题号-1122" class="headerlink" title="蓝桥王国 lanqiaoOJ 题号 1122"></a>蓝桥王国 lanqiaoOJ 题号 1122</h2><p><strong>题目描述</strong></p>
<p>蓝桥王国一共有 $N$ 个建筑和 $M$ 条单向道路，每条道路都连接着两个建筑，每个建筑都有自己编号，分别为 $1 \sim N$。（其中皇宫的编号为 1）国王想让小明回答从皇宫到每个建筑的最短路径是多少，但紧张的小明此时已经无法思考，请你编写程序帮助小明回答国王的考核。</p>
<p><strong>输入描述</strong></p>
<p>输入第一行包含 2 个正整数 $N,M$。第 2 到 $M+1$ 行每行包含三个正整数 $u,v,w$，表示 $u \to v$ 之间存在一条距离为 $w$ 的路。$1 \leq N \leq 3 \times 10^5$，$1 \leq M \leq 10^6$，$1 \leq u_i , v_i \leq N$，$0 \leq w_i \leq 10^9$。</p>
<p><strong>输出描述</strong></p>
<p>输出仅一行，共 $N$ 个数，分别表示从皇宫到编号为 $1 \sim N$ 建筑的最短距离，两两之间用空格隔开。（如果无法到达则输出 −1）</p>
<p><strong>解题思路:</strong></p>
<p>本题为单源最短路的模板题，直接套模板即可，本题我们采用 Dijkstra。</p>
<p>C++ 语言描述:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span>LL;<br><span class="hljs-comment">//这样定义INF的好处是: INF &lt;= INF+x</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N= <span class="hljs-number">3e5</span>+<span class="hljs-number">2</span>;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<br>    <span class="hljs-type">int</span> from, to; <span class="hljs-type">long</span> <span class="hljs-type">long</span> w; <span class="hljs-comment">//起点，终点，权值。起点from并没有用到，e[i]的i就是from</span><br>    <span class="hljs-built_in">edge</span>(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> c)&#123;from=a; to=b; w=c;&#125;<br>&#125;;<br>vector&lt;edge&gt;e[N];          <span class="hljs-comment">//用于存储图</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">s_node</span>&#123;<br>    <span class="hljs-type">int</span> id; <span class="hljs-type">long</span> <span class="hljs-type">long</span> n_dis;   <span class="hljs-comment">//id：结点；n_dis：这个结点到起点的距离</span><br>    <span class="hljs-built_in">s_node</span>(<span class="hljs-type">int</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> c)&#123;id=b; n_dis=c;&#125;<br>    <span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-type">const</span> s_node &amp; a) <span class="hljs-type">const</span><br>    &#123; <span class="hljs-keyword">return</span> n_dis &gt; a.n_dis;&#125;<br>&#125;;<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-type">int</span> pre[N];                                <span class="hljs-comment">//记录前驱结点，用于生成路径</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print_path</span><span class="hljs-params">(<span class="hljs-type">int</span> s, <span class="hljs-type">int</span> t)</span> </span>&#123;            <span class="hljs-comment">//打印从s到t的最短路</span><br>    <span class="hljs-keyword">if</span>(s==t)&#123; <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, s); <span class="hljs-keyword">return</span>; &#125;  <span class="hljs-comment">//打印起点</span><br>    <span class="hljs-built_in">print_path</span>(s, pre[t]);                 <span class="hljs-comment">//先打印前一个点</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, t);                      <span class="hljs-comment">//后打印当前点。最后打印的是终点t</span><br>&#125;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span>  dis[N];         <span class="hljs-comment">//记录所有结点到起点的距离</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> s = <span class="hljs-number">1</span>;             <span class="hljs-comment">//起点s是1</span><br>    <span class="hljs-type">bool</span> done[N]; <span class="hljs-comment">//done[i]=true表示到结点i的最短路径已经找到</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) &#123;dis[i]=INF; done[i]=<span class="hljs-literal">false</span>; &#125;    <span class="hljs-comment">//初始化</span><br>    dis[s]=<span class="hljs-number">0</span>;                           <span class="hljs-comment">//起点到自己的距离是0</span><br>    priority_queue &lt;s_node&gt; Q;          <span class="hljs-comment">//优先队列，存结点信息</span><br>    Q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">s_node</span>(s, dis[s]));          <span class="hljs-comment">//起点进队列</span><br>    <span class="hljs-keyword">while</span> (!Q.<span class="hljs-built_in">empty</span>())   &#123;<br>        s_node u = Q.<span class="hljs-built_in">top</span>();             <span class="hljs-comment">//pop出距起点s距离最小的结点u</span><br>        Q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">if</span>(done[u.id])  <span class="hljs-keyword">continue</span>;       <span class="hljs-comment">//丢弃已经找到最短路径的结点。即集合A中的结点</span><br>        done[u.id]= <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;e[u.id].<span class="hljs-built_in">size</span>(); i++) &#123;  <span class="hljs-comment">//检查结点u的所有邻居</span><br>            edge y = e[u.id][i];         <span class="hljs-comment">//u.id的第i个邻居是y.to</span><br>            <span class="hljs-keyword">if</span>(done[y.to])  <span class="hljs-keyword">continue</span>;    <span class="hljs-comment">//丢弃已经找到最短路径的邻居结点</span><br>            <span class="hljs-keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;<br>                dis[y.to] = y.w + u.n_dis;<br>                Q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">s_node</span>(y.to, dis[y.to]));  <span class="hljs-comment">//扩展新的邻居，放到优先队列中</span><br>                pre[y.to]=u.id;  <span class="hljs-comment">//如果有需要，记录路径</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// print_path(s,n);          //如果有需要，打印路径: 起点1，终点n</span><br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)    e[i].<span class="hljs-built_in">clear</span>();<br>    <span class="hljs-keyword">while</span> (m--) &#123;<br>        <span class="hljs-type">int</span> u,v,w;  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%lld&quot;</span>,&amp;u,&amp;v,&amp;w);<br>        e[u].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">edge</span>(u,v,w));<br>     <span class="hljs-comment">// e[v].push_back(edge(v,u,w));    //本题是单向道路</span><br>    &#125;<br>    <span class="hljs-built_in">dijkstra</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)&#123;<br>        <span class="hljs-keyword">if</span>(dis[i]&gt;=INF)  cout&lt;&lt;<span class="hljs-string">&quot;-1 &quot;</span>;<br>        <span class="hljs-keyword">else</span>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld &quot;</span>, dis[i]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> heapq<br><br>INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span><br>N = <span class="hljs-number">300002</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, fr, to, w</span>):<br>        self.fr = fr<br>        self.to = to<br>        self.w = w<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SNode</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, <span class="hljs-built_in">id</span>, n_dis</span>):<br>        self.<span class="hljs-built_in">id</span> = <span class="hljs-built_in">id</span><br>        self.n_dis = n_dis<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__lt__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">return</span> self.n_dis &lt; other.n_dis<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_path</span>(<span class="hljs-params">s, t</span>):<br>    <span class="hljs-keyword">if</span> s == t:<br>        <span class="hljs-built_in">print</span>(s, end=<span class="hljs-string">&quot; &quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    print_path(s, pre[t])<br>    <span class="hljs-built_in">print</span>(t, end=<span class="hljs-string">&quot; &quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dijkstra</span>():<br>    s = <span class="hljs-number">1</span><br>    done = [<span class="hljs-literal">False</span>] * N<br>   <br><br> dis = [INF] * N<br>    pre = [-<span class="hljs-number">1</span>] * N<br>    dis[s] = <span class="hljs-number">0</span><br>    pq = []<br>    heapq.heappush(pq, SNode(s, dis[s]))<br>    <span class="hljs-keyword">while</span> pq:<br>        u = heapq.heappop(pq)<br>        <span class="hljs-keyword">if</span> done[u.<span class="hljs-built_in">id</span>]:<br>            <span class="hljs-keyword">continue</span><br>        done[u.<span class="hljs-built_in">id</span>] = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> e[u.<span class="hljs-built_in">id</span>]:<br>            <span class="hljs-keyword">if</span> done[y.to]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> dis[y.to] &gt; y.w + u.n_dis:<br>                dis[y.to] = y.w + u.n_dis<br>                heapq.heappush(pq, SNode(y.to, dis[y.to]))<br>                pre[y.to] = u.<span class="hljs-built_in">id</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> dis[i] &gt;= INF:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-1&quot;</span>, end=<span class="hljs-string">&quot; &quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(dis[i], end=<span class="hljs-string">&quot; &quot;</span>)<br><br>n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>e = [[] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    u, v, w = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    e[u].append(Edge(u, v, w))<br><br>dijkstra()<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">INF</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x3f3f3f3f3f3f3f3fL</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">300005</span>;<br>    <span class="hljs-keyword">static</span> ArrayList&lt;Edge&gt;[] e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> n, m;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] pre = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span>[] dis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span>[] done = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[N];<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span> &#123;<br>        <span class="hljs-type">int</span> from, to;<br>        <span class="hljs-type">long</span> w;<br><br>        Edge(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">long</span> c) &#123;<br>            from = a;<br>            to = b;<br>            w = c;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SNode</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;SNode&gt; &#123;<br>        <span class="hljs-type">int</span> id;<br>        <span class="hljs-type">long</span> n_dis;<br><br>        SNode(<span class="hljs-type">int</span> b, <span class="hljs-type">long</span> c) &#123;<br>            id = b;<br>            n_dis = c;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(SNode o)</span> &#123;<br>            <span class="hljs-keyword">return</span> Long.compare(n_dis, o.n_dis);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printPath</span><span class="hljs-params">(<span class="hljs-type">int</span> s, <span class="hljs-type">int</span> t)</span> &#123;<br>        <span class="hljs-keyword">if</span> (s == t) &#123;<br>            System.out.print(s + <span class="hljs-string">&quot; &quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        printPath(s, pre[t]);<br>        System.out.print(t + <span class="hljs-string">&quot; &quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dijkstra</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        PriorityQueue&lt;SNode&gt; Q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();<br>        Arrays.fill(dis, INF);<br>        dis[s] = <span class="hljs-number">0</span>;<br>        Q.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SNode</span>(s, dis[s]));<br>        <span class="hljs-keyword">while</span> (!Q.isEmpty()) &#123;<br>            <span class="hljs-type">SNode</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> Q.poll();<br>            <span class="hljs-keyword">if</span> (done[u.id])<br>                <span class="hljs-keyword">continue</span>;<br>            done[u.id] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">for</span> (Edge y : e[u.id]) &#123;<br>                <span class="hljs-keyword">if</span> (done[y.to])<br>                    <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;<br>                    dis[y.to] = y.w + u.n_dis;<br>                    Q.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SNode</span>(y.to, dis[y.to]));<br>                    pre[y.to] = u.id;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// printPath(s, n);</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">br</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in));<br>        <span class="hljs-type">StringTokenizer</span> <span class="hljs-variable">st</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringTokenizer</span>(br.readLine());<br>        n = Integer.parseInt(st.nextToken());<br>        m = Integer.parseInt(st.nextToken());<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)<br>            e[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>            st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringTokenizer</span>(br.readLine());<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> Integer.parseInt(st.nextToken());<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> Integer.parseInt(st.nextToken());<br>            <span class="hljs-type">long</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> Long.parseLong(st.nextToken());<br>            e[u].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Edge</span>(u, v, w));<br>            <span class="hljs-comment">// e[v].add(new Edge(v, u, w)); //本题是单向道路</span><br>        &#125;<br>        dijkstra();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">if</span> (dis[i] &gt;= INF)<br>                System.out.print(<span class="hljs-string">&quot;-1 &quot;</span>);<br>            <span class="hljs-keyword">else</span><br>                System.out.print(dis[i] + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="随机数据下的最短路问题-lanqiaoOJ-题号-1366"><a href="#随机数据下的最短路问题-lanqiaoOJ-题号-1366" class="headerlink" title="随机数据下的最短路问题 lanqiaoOJ 题号 1366"></a>随机数据下的最短路问题 lanqiaoOJ 题号 1366</h2><p><strong>题目描述</strong></p>
<p>给定 $N$ 个点和 $M$ 条单向道路，每条道路都连接着两个点，每个点都有自己编号，分别为 $1 \sim N$。问你从 $S$ 点出发，到达每个点的最短路径为多少。</p>
<p><strong>输入描述</strong></p>
<p>输入第一行包含三个正整数 $N,M,S$。第 2 到 $M+1$ 行每行包含三个正整数 $u,v,w$，表示 $u \to v$ 之间存在一条距离为 $w$ 的路。$1 \leq N \leq 5 \times 10^3$，$1 \leq M \leq 5 \times 10^4$，$1 \leq u_i, v_i \leq N$，$0 \leq w_i \leq 10^9$。</p>
<p><strong>输出描述</strong></p>
<p>输出仅一行，共 $N$ 个数，分别表示从编号 $S$ 到编号为 $1 \sim N$ 点的最短距离，两两之间用空格隔开。（如果无法到达则输出 −1）</p>
<p><strong>解题思路:</strong></p>
<p>本题为单源最短路的模板题，直接套模板即可，本题我们采用 SPFA。</p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e3</span>+<span class="hljs-number">10</span>;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span><br>    <span class="hljs-type">int</span> to;    <span class="hljs-type">long</span> <span class="hljs-type">long</span> w;<br>    edge(<span class="hljs-type">int</span> tt,<span class="hljs-type">long</span> <span class="hljs-type">long</span> ww) &#123;to = tt; w = ww;&#125;<br>&#125;;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> dist[N];<br><span class="hljs-type">int</span> inq[N];<br><span class="hljs-built_in">vector</span>&lt;edge&gt; e[N];<br><span class="hljs-type">void</span> <span class="hljs-title function_">spfa</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist,<span class="hljs-number">0x3f</span>,<span class="hljs-keyword">sizeof</span>(dist));<br>    dist[s] = <span class="hljs-number">0</span>;      <span class="hljs-comment">//起点到自己的距离是0</span><br>    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.push(s);        <span class="hljs-comment">//从s开始，s进队列</span><br>    inq[s] = <span class="hljs-number">1</span>;       <span class="hljs-comment">//起点在队列中</span><br>    <span class="hljs-keyword">while</span>(!q.empty()) &#123;<br>        <span class="hljs-type">int</span> u = q.front();<br>        q.pop();<br>        inq[u] = <span class="hljs-number">0</span>;   <span class="hljs-comment">//u已经不在队列中</span><br>        <span class="hljs-keyword">if</span>(dist[u] == INF)     <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;i &lt; e[u].size();i++) &#123;   <span class="hljs-comment">//遍历u的邻居</span><br>            <span class="hljs-type">int</span> v = e[u][i].to;<br>            <span class="hljs-type">long</span> <span class="hljs-type">long</span> w = e[u][i].w;<br>            <span class="hljs-keyword">if</span>(dist[v] &gt; dist[u]+w) &#123;         <span class="hljs-comment">//u的第i个邻居v，它借道u，到s更近</span><br>                dist[v] = dist[u]+w;          <span class="hljs-comment">//更新邻居v到s的距离</span><br>                <span class="hljs-keyword">if</span>(!inq[v]) &#123;      <span class="hljs-comment">//邻居v更新状态了，但v不在队列中，放进队列</span><br>                    q.push(v);<br>                    inq[v] = <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> n,m,s;<span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;s;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= m;i++)    &#123;<br>        <span class="hljs-type">int</span> u,v; <span class="hljs-type">long</span> <span class="hljs-type">long</span> w;<br>        <span class="hljs-built_in">cin</span>&gt;&gt;u&gt;&gt;v&gt;&gt;w;<br>        e[u].push_back(edge(v,w));<br>    &#125;<br>    spfa(s);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++) &#123;<br>        <span class="hljs-keyword">if</span>(dist[i]==INF)  <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">else</span>              <span class="hljs-built_in">cout</span> &lt;&lt; dist[i];<br>        <span class="hljs-keyword">if</span>(i != n)        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>        <span class="hljs-keyword">else</span>              <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> heapq<br><br>INF = <span class="hljs-number">0x3f3f3f3f3f3f3f3f</span><br>N = <span class="hljs-number">5010</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, to, w</span>):<br>        self.to = to<br>        self.w = w<br><br>dist = [INF] * N<br>inq = [<span class="hljs-number">0</span>] * N<br>e = [[] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">spfa</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">global</span> dist<br>    <span class="hljs-keyword">global</span> inq<br>    dist = [INF] * N<br>    dist[s] = <span class="hljs-number">0</span><br>    q = []<br>    heapq.heappush(q, s)<br>    inq[s] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> q:<br>        u = heapq.heappop(q)<br>        inq[u] = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> dist[u] == INF:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e[u])):<br>            v = e[u][i].to<br>            w = e[u][i].w<br>            <span class="hljs-keyword">if</span> dist[v] &gt; dist[u] + w:<br>                dist[v] = dist[u] + w<br>                <span class="hljs-keyword">if</span> inq[v] == <span class="hljs-number">0</span>:<br>                    heapq.heappush(q, v)<br>                    inq[v] = <span class="hljs-number">1</span><br><br>n, m, s = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    u, v, w = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    e[u].append(Edge(v, w))<br>spfa(s)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> dist[i] == INF:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-1&quot;</span>, end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(dist[i], end=<span class="hljs-string">&quot; &quot;</span>)<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">INF</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x3f3f3f3f3f3f3f3fL</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">5010</span>;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span>[] dist = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] inq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> List&lt;edge&gt;[] e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>[N];<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">edge</span> &#123;<br>        <span class="hljs-type">int</span> to;<br>        <span class="hljs-type">long</span> w;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">edge</span><span class="hljs-params">(<span class="hljs-type">int</span> tt, <span class="hljs-type">long</span> ww)</span> &#123;<br>            to = tt;<br>            w = ww;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">spfa</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> &#123;<br>        Arrays.fill(dist, INF);<br>        dist[s] = <span class="hljs-number">0</span>;<br>        Queue&lt;Integer&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>        q.add(s);<br>        inq[s] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (!q.isEmpty()) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> q.poll();<br>            inq[u] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span> (dist[u] == INF) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; e[u].size(); i++) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> e[u].get(i).to;<br>                <span class="hljs-type">long</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> e[u].get(i).w;<br>                <span class="hljs-keyword">if</span> (dist[v] &gt; dist[u] + w) &#123;<br>                    dist[v] = dist[u] + w;<br>                    <span class="hljs-keyword">if</span> (inq[v] == <span class="hljs-number">0</span>) &#123;<br>                        q.add(v);<br>                        inq[v] = <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> in.nextInt();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            e[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> in.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> in.nextInt();<br>            <span class="hljs-type">long</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> in.nextLong();<br>            e[u].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">edge</span>(v, w));<br>        &#125;<br>        spfa(s);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-keyword">if</span> (dist[i] == INF) System.out.print(<span class="hljs-string">&quot;-1 &quot;</span>);<br>            <span class="hljs-keyword">else</span> System.out.print(dist[i] + <span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="路径-OJ-编号-1460"><a href="#路径-OJ-编号-1460" class="headerlink" title="路径 OJ 编号 1460"></a>路径 OJ 编号 1460</h2><p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/e77a71de068da604d1245d5231201326-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/e77a71de068da604d1245d5231201326-0.png" alt="图片描述"></p>
<p><strong>解题思路:</strong></p>
<p>填空题对时间没有要求，用最简单的 floyd</p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">3000</span>;<br><span class="hljs-type">const</span> ll INF = <span class="hljs-number">1e18</span>;<br>ll mp[N][N];<br><span class="hljs-type">void</span> <span class="hljs-title function_">floyd</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>;k &lt;= n;k++)<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++)<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>;j &lt;= n;j++)<br>                mp[i][j] = min(mp[i][j], mp[i][k] + mp[k][j]);<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">2021</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>;j &lt;= n;j++)&#123;<br>            <span class="hljs-keyword">if</span>(i == j) mp[i][j] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(i - j)&lt;=<span class="hljs-number">21</span>) mp[i][j]=mp[j][i]=i*j/__gcd(i, j);<br>            <span class="hljs-keyword">else</span> mp[i][j] = mp[j][i] = INF;<br>        &#125;<br>    &#125;<br>    floyd(n);<br>    <span class="hljs-built_in">cout</span> &lt;&lt; mp[<span class="hljs-number">1</span>][<span class="hljs-number">2021</span>];<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lcm</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(a * b / math.gcd(a, b))<br><br>n = <span class="hljs-number">2021</span><br>g = [[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">2</span>)] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">2</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> i == j:<br>            g[i][j] = g[j][i] = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">abs</span>(i - j) &lt;= <span class="hljs-number">21</span>:<br>            g[i][j] = g[j][i] = lcm(i, j)<br>        <span class="hljs-keyword">else</span>:<br>            g[i][j] = <span class="hljs-number">1000000000</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> g[i][j] &gt; g[i][k] + g[k][j]:<br>                g[i][j] = g[i][k] + g[k][j]<br><span class="hljs-built_in">print</span>(g[<span class="hljs-number">1</span>][n])<br><br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">2021</span>;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">gcd</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> &#123;<br>        <span class="hljs-keyword">return</span> b == <span class="hljs-number">0</span> ? a : gcd(b, a % b);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">lcm</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> &#123;<br>        <span class="hljs-keyword">return</span> a * b / gcd(a, b);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span>[][] floyd = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n][n];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; n &amp;&amp; j &lt; i + <span class="hljs-number">22</span>; j++)<br>                floyd[i][j] = floyd[j][i] = lcm(i + <span class="hljs-number">1</span>, j + <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; k &lt; n; k++)<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)<br>                    <span class="hljs-keyword">if</span> (floyd[i][k] != <span class="hljs-number">0</span> &amp;&amp; floyd[k][j] != <span class="hljs-number">0</span> &amp;&amp; (floyd[i][j] == <span class="hljs-number">0</span> || floyd[i][k] + floyd[k][j] &lt; floyd[i][j]))<br>                        floyd[i][j] = floyd[i][k] + floyd[k][j];<br>        System.out.println(floyd[<span class="hljs-number">0</span>][n - <span class="hljs-number">1</span>]);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="出差"><a href="#出差" class="headerlink" title="出差"></a>出差</h2><p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/6fab239959de9ee1ffb4d57d7654fabf-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/6fab239959de9ee1ffb4d57d7654fabf-0.png" alt="图片描述"></p>
<p><strong>解题思路:</strong></p>
<p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/a28b434cf3a3579931db1586e3d0d710-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/a28b434cf3a3579931db1586e3d0d710-0.png" alt="图片描述"></p>
<p>我们这里给大家一个朴素的 dijkstra 的模板，大家感受一下，优先队列到底优化的那一部分。</p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">1010</span>;<br><br><span class="hljs-comment">//邻接矩阵</span><br><span class="hljs-type">int</span> gra[N][N];<br><span class="hljs-type">int</span> dist[N];<br><span class="hljs-type">int</span> g[N];<br><span class="hljs-type">bool</span> st[N];<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-comment">//朴素版dijkstra</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">dijkstra</span><span class="hljs-params">()</span><br>&#123;<br>     <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ )<br>    &#123;<br>        <span class="hljs-type">int</span> t = <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">if</span> (!st[j] &amp;&amp; (t == <span class="hljs-number">-1</span> || dist[t] &gt; dist[j]))<br>                t = j;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            dist[j] = min(dist[j], dist[t] + gra[t][j]);<br>        st[t] = <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dist[n];<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i) <span class="hljs-built_in">cin</span>&gt;&gt;g[i];<br>    g[n]=<span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">memset</span>(gra, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> gra);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;++i)&#123;<br>        <span class="hljs-type">int</span> u,v,c;<br>        <span class="hljs-built_in">cin</span>&gt;&gt;u&gt;&gt;v&gt;&gt;c;<br>        gra[u][v]=g[v]+c;<br>        gra[v][u]=g[u]+c;<br>    &#125;<br>    <span class="hljs-built_in">cout</span>&lt;&lt;dijkstra()&lt;&lt;<span class="hljs-built_in">endl</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span><br><br>n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br><span class="hljs-comment"># 邻接矩阵</span><br>gra = [[<span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)] * (n+<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>dist = [<span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)] * (n+<span class="hljs-number">1</span>)<br>g = [<span class="hljs-number">0</span>] + <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split()))<br>g[n] = <span class="hljs-number">0</span><br>st = [<span class="hljs-literal">False</span>] * (n+<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 朴素版 Dijkstra</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dijkstra</span>() -&gt; <span class="hljs-built_in">int</span>:<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>):<br>        t = -<span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> st[j] <span class="hljs-keyword">and</span> (t == -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> dist[t] &gt; dist[j]):<br>                t = j<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>            dist[j] = <span class="hljs-built_in">min</span>(dist[j], dist[t] + gra[t][j])<br>        st[t] = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> dist[n]<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    u, v, c = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    gra[u][v] = g[v] + c<br>    gra[v][u] = g[u] + c<br><br><span class="hljs-built_in">print</span>(dijkstra())<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">1010</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[][] gra = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N][N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] dist = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] g = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span>[] st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> n, m;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scan</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        n = scan.nextInt();<br>        m = scan.nextInt();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;<br>            g[i] = scan.nextInt();<br>        &#125;<br>        g[n] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; i &lt; N ; i ++) Arrays.fill(gra[i], <span class="hljs-number">0x3f3f3f</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= m; ++i) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> scan.nextInt(), v = scan.nextInt(), c = scan.nextInt();<br>            gra[u][v] = g[v] + c;<br>            gra[v][u] = g[u] + c;<br>        &#125;<br>        System.out.println(dijkstra());<br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">dijkstra</span><span class="hljs-params">()</span> &#123;<br>        Arrays.fill(dist, <span class="hljs-number">10000000</span>);<br>        dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;<br>                <span class="hljs-keyword">if</span>(!st[j] &amp;&amp; (t == -<span class="hljs-number">1</span> || dist[t] &gt; dist[j])) &#123;<br>                    t = j;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(t == -<span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;<br>                dist[j] = Math.min(dist[j], dist[t] + gra[t][j]);<br>            &#125;<br>            st[t] = <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> dist[n];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="聪明的猴子"><a href="#聪明的猴子" class="headerlink" title="聪明的猴子"></a>聪明的猴子</h2><p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/ceeb52dc7e8b316134f2c9c7b74b1c11-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/ceeb52dc7e8b316134f2c9c7b74b1c11-0.png" alt="图片描述"></p>
<hr>
<p><strong>解题思路:</strong></p>
<p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/f77dcab941517e1b3648b7cb3c2fa740-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/f77dcab941517e1b3648b7cb3c2fa740-0.png" alt="图片描述"></p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">int</span> a[<span class="hljs-number">5005</span>], x[<span class="hljs-number">5005</span>], y[<span class="hljs-number">5005</span>], f[<span class="hljs-number">5005</span>];<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span>&#123;</span><br>    <span class="hljs-type">int</span> x;<br>    <span class="hljs-type">int</span> y;<br>    <span class="hljs-type">double</span> w;<br>&#125;edge[<span class="hljs-number">1000005</span>];<br><span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>&#123;<br>    <span class="hljs-keyword">if</span> (x == f[x])<br>        <span class="hljs-keyword">return</span> x;<br>    f[x] = find(f[x]);<br>    <span class="hljs-keyword">return</span> f[x];<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">cmp</span><span class="hljs-params">(Edge a, Edge b)</span>&#123;<br>    <span class="hljs-keyword">return</span> a.w &lt; b.w;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span>&#123;<br>    <span class="hljs-type">int</span> xx = find(x);<br>    <span class="hljs-type">int</span> yy = find(y);<br>    <span class="hljs-keyword">if</span> (xx != yy)<br>        f[yy] = xx;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> n, m;<br>    <span class="hljs-built_in">cin</span> &gt;&gt; m;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)<br>        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];<br>    <span class="hljs-built_in">cin</span> &gt;&gt; n;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        <span class="hljs-built_in">cin</span> &gt;&gt; x[i] &gt;&gt; y[i];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        f[i] = i;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; j++)&#123;<br>            <span class="hljs-type">double</span> w = <span class="hljs-built_in">sqrt</span>((x[i] - x[j])*(x[i] - x[j]) + (y[i] - y[j])*(y[i] - y[j]));<br>            edge[++cnt] = &#123;i, j, w&#125;;<br>        &#125;<br>    &#125;<br>    sort(edge + <span class="hljs-number">1</span>, edge + cnt + <span class="hljs-number">1</span>, cmp);<br>    <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">double</span> max = <span class="hljs-number">0.0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt; i++)&#123;<br>        <span class="hljs-keyword">if</span> (find(edge[i].x)!=find(edge[i].y))&#123;<br>            merge(edge[i].x, edge[i].y);<br>            num++;<br>            max = max&gt;=edge[i].w?max:edge[i].w;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (num == n - <span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-type">int</span> ans = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)<br>        <span class="hljs-keyword">if</span> (a[i] &gt;= max)<br>            ans++;<br>    <span class="hljs-built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="hljs-built_in">endl</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span>:<br>    x = <span class="hljs-number">0</span><br>    y = <span class="hljs-number">0</span><br>    w = <span class="hljs-number">0.0</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, x, y, w</span>):<br>        self.x = x<br>        self.y = y<br>        self.w = w<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">if</span> f[x]==x:<br>        <span class="hljs-keyword">return</span> f[x]<br>    <span class="hljs-keyword">else</span>:<br>        f[x] = find(f[x])<br>        <span class="hljs-keyword">return</span> f[x]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">x,y</span>):<br>    xx = find(x)<br>    yy = find(y)<br>    <span class="hljs-keyword">if</span> xx!=yy:<br>        f[yy] = xx<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    m = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>    a = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split()))<br>    n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>    x = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n + <span class="hljs-number">2</span>)]<br>    y = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n + <span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        b = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split()))<br>        x[i + <span class="hljs-number">1</span>] = b[<span class="hljs-number">0</span>]<br>        y[i + <span class="hljs-number">1</span>] = b[<span class="hljs-number">1</span>]<br>    edge_list = []<br>    maxvalue = <span class="hljs-number">0</span><br>    num = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i + <span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>            w = math.sqrt((x[i] - x[j]) * (x[i] - x[j]) + (y[i] - y[j]) * (y[i] - y[j]))<br>            edge =  Edge(i, j, w)<br>            edge_list.append(edge)<br><br>    edge_list.sort(key=<span class="hljs-keyword">lambda</span> x: x.w)<br>    f = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n + <span class="hljs-number">1</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> edge_list:<br>        <span class="hljs-keyword">if</span> find(i.x)!=find(i.y):<br>            merge(i.x,i.y)<br>            maxvalue = <span class="hljs-built_in">max</span>(maxvalue,i.w)<br>            num+=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> num==n-<span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">break</span><br>    ans = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">if</span> a[i]&gt;=maxvalue:<br>            ans+=<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.BufferedReader;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStreamReader;<br><span class="hljs-keyword">import</span> java.io.OutputStreamWriter;<br><span class="hljs-keyword">import</span> java.io.PrintWriter;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">ans</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> n;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] a;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> m;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] x;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] y;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> max;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] f;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in));<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(System.out));<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br>        m = Integer.parseInt(in.readLine().trim());<br>        a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[m];<br>        String[] s = in.readLine().trim().split(<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>            a[i] = Integer.parseInt(s[i]);<br>        n = Integer.parseInt(in.readLine().trim());<br>        x = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>        y = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) &#123;<br>            s = in.readLine().trim().split(<span class="hljs-string">&quot; &quot;</span>);<br>            x[i] = Integer.parseInt(s[<span class="hljs-number">0</span>]);<br>            y[i] = Integer.parseInt(s[<span class="hljs-number">1</span>]);<br>        &#125;<br>        ArrayList&lt;Edge&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n-<span class="hljs-number">1</span>;i++) &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=i+<span class="hljs-number">1</span>;j&lt;n;j++) &#123;<br>                <span class="hljs-type">double</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> Math.sqrt((x[i]-x[j])*(x[i]-x[j])+(y[i]-y[j])*(y[i]-y[j]));<br>                <span class="hljs-type">Edge</span> <span class="hljs-variable">edge</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Edge</span>(i, j, l);<br>                list.add(edge);<br>            &#125;<br>        &#125;<br>        Collections.sort(list);<br>        f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)<br>            f[i] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;list.size();i++) &#123;<br>            <span class="hljs-type">Edge</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> list.get(i);<br>            <span class="hljs-keyword">if</span>(find(e.x)!=find(e.y)) &#123;<br>                merge(e.x,e.y);<br>                max = Math.max(max, e.w);<br>                num++;<br>                <span class="hljs-keyword">if</span>(num==n-<span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>            <span class="hljs-keyword">if</span>(a[i]&gt;=max)<br>                ans++;<br>        System.out.println(ans);<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>        <span class="hljs-keyword">if</span>(f[x] == x)<br>            <span class="hljs-keyword">return</span> f[x];<br>        f[x] = find(f[x]);<br>        <span class="hljs-keyword">return</span> f[x];<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">xx</span> <span class="hljs-operator">=</span> find(x);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">yy</span> <span class="hljs-operator">=</span> find(y);<br>        <span class="hljs-keyword">if</span>(xx!=yy)<br>            f[yy] = xx;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Edge</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Edge&gt;&#123;<br>    <span class="hljs-type">int</span> x;<br>    <span class="hljs-type">int</span> y;<br>    <span class="hljs-type">double</span> w;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Edge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">double</span> w)</span> &#123;<br>        <span class="hljs-built_in">super</span>();<br>        <span class="hljs-built_in">this</span>.x = x;<br>        <span class="hljs-built_in">this</span>.y = y;<br>        <span class="hljs-built_in">this</span>.w = w;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Edge o)</span> &#123;<br>        <span class="hljs-comment">// TODO Auto-generated method stub</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.w&gt;o.w?<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="通电"><a href="#通电" class="headerlink" title="通电"></a>通电</h2><p class='item-img' data-src='/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/e0bde279d708165b220cfdf8848e1467-0.png'><img src="/./../images/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/e0bde279d708165b220cfdf8848e1467-0.png" alt="图片描述"></p>
<p><strong>解题思路:</strong></p>
<p>给了你 <code>n</code> 个节点，又给了你 <code>n</code> 个基点之间相互连接需要多少钱，现在要 <code>n</code> 个村庄都通电，只需要保证 <code>n</code> 个节点构成连通子图即可。</p>
<p>最小的连通子图是树，也就是构造一棵树，那么在图上构造一棵最最少花费的树的问题即为最小生成树。</p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> MAXN = <span class="hljs-number">1005</span>;<br><span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; demo;<br><span class="hljs-type">double</span> closest[MAXN], lowcost[MAXN];<br><span class="hljs-type">int</span> m, n;             <span class="hljs-comment">// m为节点的个数，n为边的数量</span><br><span class="hljs-type">double</span> G[MAXN][MAXN]; <span class="hljs-comment">// 邻接矩阵</span><br><span class="hljs-type">double</span> <span class="hljs-title function_">prim</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>    &#123;<br>        lowcost[i] = INF;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>    &#123;<br>        closest[i] = <span class="hljs-number">0</span>;<br>    &#125;<br>    closest[<span class="hljs-number">0</span>] = <span class="hljs-number">-1</span>;             <span class="hljs-comment">// 加入第一个点，-1表示该点在集合U中，否则在集合V中</span><br>    <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>,  e = <span class="hljs-number">0</span>; <span class="hljs-comment">// e为最新加入集合的点</span><br>    <span class="hljs-type">double</span> ans=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (num &lt; m - <span class="hljs-number">1</span>)          <span class="hljs-comment">// 加入m-1条边</span><br>    &#123;<br>        <span class="hljs-type">int</span> miedge = <span class="hljs-number">-1</span>;<br>        <span class="hljs-type">double</span> micost = INF;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>            <span class="hljs-keyword">if</span> (closest[i] != <span class="hljs-number">-1</span>)<br>            &#123;<br>                <span class="hljs-type">double</span> temp = G[e][i];<br>                <span class="hljs-keyword">if</span> (temp &lt; lowcost[i])<br>                &#123;<br>                    lowcost[i] = temp;<br>                    closest[i] = e;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (lowcost[i] &lt; micost)<br>                    micost = lowcost[miedge = i];<br>            &#125;<br>        ans += micost;<br>        demo.push_back(micost);<br>        closest[e = miedge] = <span class="hljs-number">-1</span>;<br>        num++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-type">double</span> x, y, h;<br>&#125; dis[MAXN];<br><br><span class="hljs-type">double</span> <span class="hljs-title function_">getDistance</span><span class="hljs-params">(node a, node b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-built_in">pow</span>(a.x - b.x, <span class="hljs-number">2</span>) + <span class="hljs-built_in">pow</span>(a.y - b.y, <span class="hljs-number">2</span>)) + <span class="hljs-built_in">pow</span>(a.h - b.h, <span class="hljs-number">2</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;m);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lf%lf%lf&quot;</span>, &amp;dis[i].x, &amp;dis[i].y, &amp;dis[i].h);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m - <span class="hljs-number">1</span>; i++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt; m; j++)<br>        &#123;<br>            G[i][j] = getDistance(dis[i], dis[j]);<br>            G[j][i] = G[i][j];<br>        &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.2lf&quot;</span>, prim());<br>    <span class="hljs-comment">// for (int i = 0; i &lt; m - 1; i++)</span><br>    <span class="hljs-comment">//     cout &lt;&lt; demo[i] &lt;&lt; &quot; &quot;;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">caculate</span>(<span class="hljs-params">x1,y1,h1,x2,y2,h2</span>):<br>    <span class="hljs-keyword">return</span> math.sqrt( (x1-x2)**<span class="hljs-number">2</span>+(y1-y2)**<span class="hljs-number">2</span>)+(h1-h2)**<span class="hljs-number">2</span>\<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">if</span> x!=ufs[x]:<br>        ufs[x]=find(ufs[x])<br>    <span class="hljs-keyword">return</span> ufs[x]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">kruskal</span>():<br>    <span class="hljs-keyword">global</span> ufs<br>    ufs=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>))<br>    my_brige.sort(key=<span class="hljs-keyword">lambda</span> x:x[<span class="hljs-number">2</span>])<br>    ans=<span class="hljs-number">0</span><br>    cnt=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> a,b,w <span class="hljs-keyword">in</span> my_brige:<br>        x=find(a)<br>        y=find(b)<br>        <span class="hljs-keyword">if</span> x==y:<br>            <span class="hljs-keyword">continue</span><br>        cnt+=<span class="hljs-number">1</span><br>        ans+=w<br>        ufs[x]=y<br><br>        <span class="hljs-keyword">if</span> cnt==n-<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> ans<br><br><br><br>n=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>brige=[[] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>    x,y,h=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    brige[i]=(x,y,h)<br><br><br>my_brige=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        x1,y1,h1=brige[i]<br>        x2,y2,h2=brige[j]<br>        w=caculate(x1,y1,h1,x2,y2,h2)<br>        my_brige.append((i,j,w))<br>ans=kruskal()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;:.2f&#125;&quot;</span>.<span class="hljs-built_in">format</span>(ans))<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Comparator;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">1010</span>;<br>    <span class="hljs-keyword">static</span> List&lt;Node&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] x = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N], y = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N], z = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> n;<br>    <span class="hljs-comment">//并查集数组</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        n = sc.nextInt();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            x[i] = sc.nextInt();<br>            y[i] = sc.nextInt();<br>            z[i] = sc.nextInt();<br>        &#125;<br>        <span class="hljs-comment">//建边  任意两个村庄都要建边</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; n; j++) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> x[i] - x[j];<br>                <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> y[i] - y[j];<br>                <span class="hljs-type">double</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> z[i] - z[j];<br>                <span class="hljs-comment">// i 村庄 到  j 村庄的 距离</span><br>                <span class="hljs-type">double</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> Math.sqrt(l * l + r * r) + c * c;<br>                list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(i, j, s));<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// 核心：按权值排序</span><br>        list.sort(Comparator.comparingDouble(a -&gt; a.w));<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            q[i] = i;<br>        &#125;<br>        <span class="hljs-comment">//记录权重之和，答案</span><br>        <span class="hljs-type">double</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; list.size(); i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> list.get(i).a;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> list.get(i).b;<br>            <span class="hljs-type">double</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> list.get(i).w;<br>            a = find(a);<br>            b = find(b);<br>            <span class="hljs-keyword">if</span> (a != b) &#123;<br>                q[a] = b;<br>                res += w;<br>            &#125;<br>        &#125;<br>        System.out.printf(<span class="hljs-string">&quot;%.2f&quot;</span>, res);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>        <span class="hljs-keyword">if</span> (q[x] != x) q[x] = find(q[x]);<br>        <span class="hljs-keyword">return</span> q[x];<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>        <span class="hljs-type">int</span> a, b;<br>        <span class="hljs-type">double</span> w;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">double</span> w)</span> &#123;<br>            <span class="hljs-built_in">this</span>.a = a;<br>            <span class="hljs-built_in">this</span>.b = b;<br>            <span class="hljs-built_in">this</span>.w = w;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="机房"><a href="#机房" class="headerlink" title="机房"></a>机房</h2><p>这天, 小明在机房学习。</p>
<p>他发现机房里一共有 $n$ 台电脑, 编号为 1 到 $n$, 电脑和电脑之间有网线连 接, 一共有 $n-1$ 根网线将 $n$ 台电脑连接起来使得任意两台电脑都直接或者间 接地相连。</p>
<p>小明发现每台电脑转发、发送或者接受信息需要的时间取决于这台电脑和 多少台电脑直接相连, 而信息在网线中的传播时间可以忽略。比如如果某台电脑 用网线直接连接了另外 $d$ 台电脑, 那么任何经过这台电脑的信息都会延迟 $d$ 单 位时间 (发送方和接收方也会产生这样的延迟, 当然如果发送方和接收方都是 同一台电脑就只会产生一次延迟)。</p>
<p>小明一共产生了 $m$ 个疑问: 如果电脑 $u_{i}$ 向电脑 $v_{i}$ 发送信息, 那么信息从 $u_{i}$ 传到 $v_{i}$ 的最短时间是多少?</p>
<p><strong>解题思路:</strong></p>
<p>还是一道比较明显的求<code>LCA</code>(最近公共祖先)模型的题目,我们可以使用多种方法来解决该问题，这里我们使用更好写的离线的<code>tarjan</code>算法来解决该问题。</p>
<p>除去<code>tarjan</code>算法必用的基础数组，我们还有一个数组<code>d[]</code>,<code>d[i]</code>记录的是每个点的出度，也就是它的延迟时间，以及数组<code>w[]</code>,<code>w[i]</code>的含义是点<code>i</code>到根节点的延迟时间。在通过<code>dfs</code>求出每个点<code>i</code>的<code>w[i]</code>以后，在<code>tarjan</code>中我们该如何求出两点的延迟时间呢？</p>
<p>我们设点<code>i</code>到<code>j</code>的延迟时间为$f(x)$,当我们求得<code>i</code>与<code>j</code>的最近公共祖先为<code>anc</code>，我们首先让$f(x)&#x3D;w[i]+w[j]$,但很明显，我们多加了两遍$w[anc]$，所以我们需要减去两倍的$w[anc]$，但延迟时间还包括经过<code>anc</code>的时间，所以还得加上一个$d[anc]$。<strong>此处请结合<code>w[]</code>和<code>d[]</code>的含义理解。</strong> 最后能得出式子:$f(x)&#x3D;w[i]+w[h]-w[anc]*2+d[anc]$ 我们利用这个式子在<code>tarjan</code>函数中就能得出每个询问的答案，当然对于起始和结束都在同一个节点的情况下,它的答案就是当前节点的出度，我们可以进行特判一下。输入输出较多，建议使用<code>scanf</code>和<code>printf</code>进行输入输出。</p>
<p><strong>时间复杂度</strong>:<code>dfs</code>：每个点遍历一次,复杂度级别$O(n)$,<code>tarjan</code>算法复杂度接近 $O(n+m)$。</p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> LL;<br><span class="hljs-keyword">typedef</span> <span class="hljs-built_in">pair</span>&lt;<span class="hljs-type">int</span>,<span class="hljs-type">int</span>&gt; PII;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">100010</span>;<br><br><span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-type">int</span>,<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;&gt; gra;<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-comment">//单个点的出度</span><br><span class="hljs-type">int</span> d[N];<br><span class="hljs-comment">//记录点i到根节点的延迟</span><br><span class="hljs-type">int</span> w[N];<br><span class="hljs-comment">//并查集数组</span><br><span class="hljs-type">int</span> q[N];<br><span class="hljs-comment">//记录答案</span><br><span class="hljs-type">int</span> res[N];<br><span class="hljs-type">int</span> st[N];<br><span class="hljs-comment">//存下查询</span><br><span class="hljs-built_in">vector</span>&lt;PII&gt;    query[N];<br><span class="hljs-comment">//并查集查询</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>&#123;<br>    <span class="hljs-keyword">if</span>(x!=q[x]) q[x]=find(q[x]);<br>    <span class="hljs-keyword">return</span> q[x];<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u,<span class="hljs-type">int</span> fa)</span><br>&#123;<br>    w[u]+=d[u];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> g:gra[u])&#123;<br>        <span class="hljs-keyword">if</span>(g==fa) <span class="hljs-keyword">continue</span>;<br>        w[g]+=w[u];<br>        dfs(g,u);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">tarjan</span><span class="hljs-params">(<span class="hljs-type">int</span> u)</span><br>&#123;<br>    st[u]=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> j:gra[u])&#123;<br>        <span class="hljs-keyword">if</span>(!st[j])<br>        &#123;<br>            tarjan(j);<br>            q[j]=u;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> item: query[u])&#123;<br>        <span class="hljs-type">int</span> y=item.first,id=item.second;<br>        <span class="hljs-keyword">if</span>(st[y]==<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-type">int</span> anc=find(y);<br>            res[id]=w[y]+w[u]-w[anc]*<span class="hljs-number">2</span>+d[anc];<br>        &#125;<br>    &#125;<br>    st[u]=<span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n<span class="hljs-number">-1</span>;++i)&#123;<br>        <span class="hljs-type">int</span> a,b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);<br>        gra[a].push_back(b);<br>        gra[b].push_back(a);<br>        d[a]++,d[b]++;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;++i)&#123;<br>        <span class="hljs-type">int</span> a,b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);<br>        <span class="hljs-keyword">if</span>(a!=b)&#123;<br>            query[a].push_back(&#123;b,i&#125;);<br>            query[b].push_back(&#123;a,i&#125;);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            res[i]=d[a];<br>        &#125;<br>    &#125;<br>    dfs(<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i) q[i]=i;<br>    tarjan(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;m;++i) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,res[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><br>gra = defaultdict(<span class="hljs-built_in">list</span>)<br>d = [<span class="hljs-number">0</span>] * <span class="hljs-number">100010</span><br>w = [<span class="hljs-number">0</span>] * <span class="hljs-number">100010</span><br>q = [<span class="hljs-number">0</span>] * <span class="hljs-number">100010</span><br>res = [<span class="hljs-number">0</span>] * <span class="hljs-number">100010</span><br>st = [<span class="hljs-number">0</span>] * <span class="hljs-number">100010</span><br>query = [[] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100010</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">if</span> x != q[x]:<br>        q[x] = find(q[x])<br>    <span class="hljs-keyword">return</span> q[x]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">u, fa</span>):<br>    w[u] += d[u]<br>    <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> gra[u]:<br>        <span class="hljs-keyword">if</span> g == fa:<br>            <span class="hljs-keyword">continue</span><br>        w[g] += w[u]<br>        dfs(g, u)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tarjan</span>(<span class="hljs-params">u</span>):<br>    st[u] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> gra[u]:<br>        <span class="hljs-keyword">if</span> st[j] == <span class="hljs-number">0</span>:<br>            tarjan(j)<br>            q[j] = u<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> query[u]:<br>        y, <span class="hljs-built_in">id</span> = item<br>        <span class="hljs-keyword">if</span> st[y] == <span class="hljs-number">2</span>:<br>            anc = find(y)<br>            res[<span class="hljs-built_in">id</span>] = w[y] + w[u] - w[anc] * <span class="hljs-number">2</span> + d[anc]<br>    st[u] = <span class="hljs-number">2</span><br><br>n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>):<br>    a, b = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    gra[a].append(b)<br>    gra[b].append(a)<br>    d[a] += <span class="hljs-number">1</span><br>    d[b] += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    a, b = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br>    <span class="hljs-keyword">if</span> a != b:<br>        query[a].append((b, i))<br>        query[b].append((a, i))<br>    <span class="hljs-keyword">else</span>:<br>        res[i] = d[a]<br><br>dfs(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>    q[i] = i<br>tarjan(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    <span class="hljs-built_in">print</span>(res[i])<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Pair</span> &#123;<br>        <span class="hljs-type">int</span> first, second;<br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Pair</span><span class="hljs-params">(<span class="hljs-type">int</span> first, <span class="hljs-type">int</span> second)</span> &#123;<br>            <span class="hljs-built_in">this</span>.first = first;<br>            <span class="hljs-built_in">this</span>.second = second;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> Map&lt;Integer, List&lt;Integer&gt;&gt; gra = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">100010</span>];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] w = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">100010</span>];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">100010</span>];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">100010</span>];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">100010</span>];<br>    <span class="hljs-keyword">static</span> List&lt;Pair&gt;[] query = <span class="hljs-keyword">new</span> <span class="hljs-title class_">List</span>[<span class="hljs-number">100010</span>];<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>        <span class="hljs-keyword">if</span> (x != q[x]) q[x] = find(q[x]);<br>        <span class="hljs-keyword">return</span> q[x];<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> fa)</span> &#123;<br>        w[u] += d[u];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> g : gra.get(u)) &#123;<br>            <span class="hljs-keyword">if</span> (g == fa) <span class="hljs-keyword">continue</span>;<br>            w[g] += w[u];<br>            dfs(g, u);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tarjan</span><span class="hljs-params">(<span class="hljs-type">int</span> u)</span> &#123;<br>        st[u] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j : gra.get(u)) &#123;<br>            <span class="hljs-keyword">if</span> (st[j] == <span class="hljs-number">0</span>) &#123;<br>                tarjan(j);<br>                q[j] = u;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (Pair item : query[u]) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> item.first, id = item.second;<br>            <span class="hljs-keyword">if</span> (st[y] == <span class="hljs-number">2</span>) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">anc</span> <span class="hljs-operator">=</span> find(y);<br>                res[id] = w[y] + w[u] - w[anc] * <span class="hljs-number">2</span> + d[anc];<br>            &#125;<br>        &#125;<br>        st[u] = <span class="hljs-number">2</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            gra.put(i, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;());<br>            query[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            gra.get(a).add(b);<br>            gra.get(b).add(a);<br>            d[a]++;<br>            d[b]++;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>            <span class="hljs-keyword">if</span> (a != b) &#123;<br>                query[a].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Pair</span>(b, i));<br>                query[b].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Pair</span>(a, i));<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                res[i] = d[a];<br>            &#125;<br>        &#125;<br>        dfs(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>           q[i] = i;<br>        &#125;<br>        tarjan(<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>            System.out.println(res[i]);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="环境治理"><a href="#环境治理" class="headerlink" title="环境治理"></a>环境治理</h2><p>LQ 国拥有 $n$ 个城市, 从 0 到 $n-1$ 编号, 这 $n$ 个城市两两之间都有且仅有 一条双向道路连接, 这意味着任意两个城市之间都是可达的。每条道路都有一 个属性 $D$, 表示这条道路的灰尘度。当从一个城市 $A$ 前往另一个城市 $B$ 时, 可 能存在多条路线, 每条路线的灰尘度定义为这条路线所经过的所有道路的灰尘 度之和, LQ 国的人都很讨厌灰尘, 所以他们总会优先选择灰尘度最小的路线。</p>
<p>LQ 国很看重居民的出行环境, 他们用一个指标 $P$ 来衡量 LQ 国的出行环 境, $P$ 定义为:</p>
<p>$P&#x3D;\sum*{i&#x3D;0}^{n-1} \sum*{j&#x3D;0}^{n-1} d(i, j)$</p>
<p>其中 $d(i, j)$ 表示城市 $i$ 到城市 $j$ 之间灰尘度最小的路线对应的灰尘度的值。 为了改善出行环境, 每个城市都要有所作为, 当某个城市进行道路改善时, 会将与这个城市直接相连的所有道路的灰尘度都减少 1 , 但每条道路都有一个 灰尘度的下限值 $L$, 当灰尘度达到道路的下限值时, 无论再怎么改善, 道路的 灰尘度也不会再减小了。</p>
<p>具体的计划是这样的:</p>
<p>第 1 天, 0 号城市对与其直接相连的道路环境进行改善;</p>
<p>第 2 天, 1 号城市对与其直接相连的道路环境进行改善;</p>
<p>$\cdots$</p>
<p>第 $n$ 天, $n-1$ 号城市对与其直接相连的道路环境进行改善;</p>
<p>第 $n+1$ 天, 0 号城市对与其直接相连的道路环境进行改善;</p>
<p>第 $n+2$ 天, 1 号城市对与其直接相连的道路环境进行改善;</p>
<p>LQ 国想要使得 $P$ 指标满足 $P \leq Q$ 。请问最少要经过多少天之后, $P$ 指标 可以满足 $P \leq Q$ 。如果在初始时就已经满足条件, 则输出 0 ; 如果永远不可能 满足, 则输出 $-1$ 。</p>
<p><strong>解题思路:</strong></p>
<p>首先，对于求解<code>P</code>指的公式，我们要清楚，是每个点到其他所有点的最短路径之和相加，这种涉及到任意两点的最短路，加上 $n$ 的最大范围只有<code>100</code>，很明显我们需要想到<code>Floyd</code>算法求任意两点的最短路。</p>
<p>我们并没有一个直观的算法直接求得答案，所以，我们考虑<strong>二分答案。</strong> 如果改善<code>x</code>天是符合要求的，那么大于<code>x</code>的天数也一定符合，但小于<code>x</code>的天数不一定，所以满足二段性，我们可以二分。</p>
<p>我们用<code>g[][]</code>记录初始道路的灰尘度,<code>m[][]</code>记录每条道路的最低灰尘度,<code>f[][]</code>记录的是在改善<code>x</code>天后的每条道路的环境。这样我们就可以使用二分+<code>Floyd</code>的做法得到答案。</p>
<p>当然这里有一些需要注意的细节问题，当我们改变<code>f[i][j]</code>的值时，相应的也要改变<code>f[j][i]</code>的值，因为任意两点只存在一条双向道路，所以这两个状态应该表示的是同一条道路。每次<code>check</code>时，别忘记将<code>f[][]</code>重置回<code>g[][]</code>，再去减去对于的天数。<code>floyd</code>函数每次跑完后，计算并返回此时的<code>P</code>值。</p>
<p>最开始时我们可以判断每条道路都是最低复杂度的情况下，计算出来的<code>P</code>是否大于<code>Q</code>，如果大于说明肯定无解，直接返回<code>-1</code>即可。二分对于<code>r</code>的上限也需要注意，最多<code>100</code>个点，每个点最大<code>1e5</code>，所以理论上我们只要开到大于<code>1e7</code>以上就不会有问题，否则样例过大时可能会出错。</p>
<p>时间复杂度：$O(n^3log(n*m))$。</p>
<p>C++ 语言描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> LL;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">110</span>;<br><br>LL g[N][N];<br>LL m[N][N];<br>LL f[N][N];<br>LL n,q;<br>LL <span class="hljs-title function_">floyd</span><span class="hljs-params">()</span><br>&#123;<br>    LL a=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                f[i][j] = min(f[i][j], f[i][k] + f[k][j]);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)<br>            a+=f[i][j];<br>    <span class="hljs-keyword">return</span> a;<br>&#125;<br><span class="hljs-comment">//改善X天</span><br><span class="hljs-type">bool</span> <span class="hljs-title function_">check</span><span class="hljs-params">(LL x)</span>&#123;<br>    <span class="hljs-built_in">memcpy</span>(f,g,<span class="hljs-keyword">sizeof</span>(g));<br>    LL h=x/n;<br>    LL s=x%n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)&#123;<br>            <span class="hljs-keyword">if</span>(i==j) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">if</span>(i&lt;=s) f[i][j]=max(m[i][j],f[i][j]-h<span class="hljs-number">-1</span>);<br>            <span class="hljs-keyword">else</span> f[i][j]=max(m[i][j],f[i][j]-h);<br>            f[j][i]=f[i][j];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> floyd()&lt;=q;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">solve</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)&#123;<br>            <span class="hljs-built_in">cin</span>&gt;&gt;g[i][j];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)&#123;<br>            <span class="hljs-built_in">cin</span>&gt;&gt;m[i][j];<br>            f[i][j]=m[i][j];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(floyd()&gt;q)&#123;<br>        <span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-number">-1</span>&lt;&lt;<span class="hljs-built_in">endl</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    LL l=<span class="hljs-number">0</span>,r=<span class="hljs-number">1000000000</span>;<br>    <span class="hljs-keyword">while</span>(l&lt;r)&#123;<br>        <span class="hljs-type">int</span> mid=l+r&gt;&gt;<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(check(mid)) r=mid;<br>        <span class="hljs-keyword">else</span> l=mid+<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-built_in">cout</span>&lt;&lt;r&lt;&lt;<span class="hljs-built_in">endl</span>;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    solve();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> copy<br>N=<span class="hljs-number">110</span><br>g=[[<span class="hljs-number">0</span>]*N <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N)]<br>m=[[<span class="hljs-number">0</span>]*N <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N)]<br>f=[[<span class="hljs-number">0</span>]*N <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N)]<br>n,q=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">floyd</span>(<span class="hljs-params">f</span>):<br>    a=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>                f[i][j]=<span class="hljs-built_in">min</span>(f[i][j],f[i][k]+f[k][j])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>            a=a+f[i][j]<br>    <span class="hljs-keyword">return</span> a<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">x,g</span>):<br>    f=copy.deepcopy(g)<br>    h=x//n<br>    s=x%n<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> i==j:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> i&lt;=s:<br>                f[i][j]=<span class="hljs-built_in">max</span>(m[i][j],f[i][j]-h-<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">else</span>:<br>                f[i][j]=<span class="hljs-built_in">max</span>(m[i][j],f[i][j]-h)<br>            f[j][i]=f[i][j]<br>    <span class="hljs-keyword">return</span>  floyd(f)&lt;=q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        l=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split()))<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>            g[i][j]=l[j-<span class="hljs-number">1</span>]<span class="hljs-comment">#灰尘度</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        l = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split()))<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>            m[i][j]=l[j-<span class="hljs-number">1</span>]<span class="hljs-comment">#灰尘度的下限值</span><br>            f[i][j]=m[i][j]<br>    <span class="hljs-keyword">if</span> floyd(f)&gt;q:<br>        <span class="hljs-built_in">print</span>(-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span><br>    l,r=<span class="hljs-number">0</span>,<span class="hljs-number">10000000</span><br>    <span class="hljs-keyword">while</span> (l &lt; r):<br>        mid=(l+r)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> (check(mid,g)):<br>            r=mid<br>        <span class="hljs-keyword">else</span>:<br>            l=mid+<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(r)<br>solve()<br></code></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> N=<span class="hljs-number">110</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span>[][] g=<span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N][N],m=<span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N][N],f=<span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[N][N];<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> n,q;<br>    <span class="hljs-keyword">static</span> BufferedReader br=<span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in));<br>    <span class="hljs-keyword">static</span> PrintWriter  out=<span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(System.out));<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        String[] s=br.readLine().split(<span class="hljs-string">&quot; &quot;</span>);<br>        n=Long.parseLong(s[<span class="hljs-number">0</span>]);<br>        q=Long.parseLong(s[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>            s=br.readLine().split(<span class="hljs-string">&quot; &quot;</span>);<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)&#123;<br>                g[i][j]=Long.parseLong(s[j-<span class="hljs-number">1</span>]);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>            s=br.readLine().split(<span class="hljs-string">&quot; &quot;</span>);<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)&#123;<br>                m[i][j]=Long.parseLong(s[j-<span class="hljs-number">1</span>]);<br>                f[i][j]=m[i][j];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(floyd()&gt;q)&#123;<br>            out.println(-<span class="hljs-number">1</span>);<br>            out.flush();<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">long</span> l=<span class="hljs-number">0</span>,r=<span class="hljs-number">1000000000</span>;<br>        <span class="hljs-keyword">while</span>(l&lt;r)&#123;<br>            <span class="hljs-type">long</span> mid=l+r&gt;&gt;<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span>(check(mid)) r=mid;<br>            <span class="hljs-keyword">else</span> l=mid+<span class="hljs-number">1</span>;<br>        &#125;<br>        out.println(r);<br>        out.flush();<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">floyd</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">long</span> a=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                    f[i][j] =Math.min(f[i][j], f[i][k] + f[k][j]);<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)<br>                a+=f[i][j];<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">check</span><span class="hljs-params">(<span class="hljs-type">long</span> x)</span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j) f[i][j]=g[i][j];<br>        &#125;<br>        <span class="hljs-type">long</span> h=x/n;<br>        <span class="hljs-type">long</span> s=x%n;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;++j)&#123;<br>                <span class="hljs-keyword">if</span>(i==j) <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">if</span>(i&lt;=s) f[i][j]=Math.max(m[i][j],f[i][j]-h-<span class="hljs-number">1</span>);<br>                <span class="hljs-keyword">else</span> f[i][j]=Math.max(m[i][j],f[i][j]-h);<br>                f[j][i]=f[i][j];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> floyd()&lt;=q;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2024/03/11/%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA/">← Next 简单数论</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2024/03/11/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">zdx</a></h1><div id="description"><p>learn</p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/zdx-1"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:19546328912@163.com"><i class="fa fa-envelope" alt="E-Mail"></i></a><a class="social" target="_blank" rel="noopener" href="https://space.bilibili.com/353147531"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E8%AE%BA"><span class="toc-number">1.</span> <span class="toc-text">图论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.</span> <span class="toc-text">图的基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">2.1.</span> <span class="toc-text">图的种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%AE%97%E6%B3%95%E7%9A%84%E6%97%B6%E9%97%B4%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">图算法的时间分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-number">3.</span> <span class="toc-text">图的存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%AD%98%E8%BE%B9"><span class="toc-number">3.1.</span> <span class="toc-text">数组存边</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%BB%E6%8E%A5%E7%9F%A9%E9%98%B5"><span class="toc-number">3.2.</span> <span class="toc-text">邻接矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%BB%E6%8E%A5%E8%A1%A8%E5%92%8C%E9%93%BE%E5%BC%8F%E5%89%8D%E5%90%91%E6%98%9F"><span class="toc-number">3.3.</span> <span class="toc-text">邻接表和链式前向星</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF%E9%97%AE%E9%A2%98"><span class="toc-number">4.</span> <span class="toc-text">最短路问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF%E7%AE%97%E6%B3%95%E6%AF%94%E8%BE%83"><span class="toc-number">4.1.</span> <span class="toc-text">最短路算法比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Floyd-%E7%AE%97%E6%B3%95"><span class="toc-number">4.2.</span> <span class="toc-text">Floyd 算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Floyd-%E7%AE%97%E6%B3%95%E6%80%9D%E6%83%B3%EF%BC%9A%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92"><span class="toc-number">4.2.1.</span> <span class="toc-text">Floyd 算法思想：动态规划</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dijkstra-%E7%AE%97%E6%B3%95"><span class="toc-number">4.3.</span> <span class="toc-text">Dijkstra 算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E6%80%9D%E6%83%B3"><span class="toc-number">4.3.1.</span> <span class="toc-text">算法思想</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bellman-Ford-%E7%AE%97%E6%B3%95"><span class="toc-number">4.4.</span> <span class="toc-text">Bellman-Ford 算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SPFA-%E7%AE%97%E6%B3%95"><span class="toc-number">4.4.1.</span> <span class="toc-text">SPFA 算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.5.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91"><span class="toc-number">5.</span> <span class="toc-text">最小生成树</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prim-%E7%AE%97%E6%B3%95"><span class="toc-number">5.1.</span> <span class="toc-text">Prim 算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kruskal-%E7%AE%97%E6%B3%95"><span class="toc-number">5.2.</span> <span class="toc-text">kruskal 算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E8%AE%BA%E4%BE%8B%E9%A2%98"><span class="toc-number">6.</span> <span class="toc-text">图论例题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%93%9D%E6%A1%A5%E7%8E%8B%E5%9B%BD-lanqiaoOJ-%E9%A2%98%E5%8F%B7-1122"><span class="toc-number">7.</span> <span class="toc-text">蓝桥王国 lanqiaoOJ 题号 1122</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%8D%AE%E4%B8%8B%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E9%97%AE%E9%A2%98-lanqiaoOJ-%E9%A2%98%E5%8F%B7-1366"><span class="toc-number">8.</span> <span class="toc-text">随机数据下的最短路问题 lanqiaoOJ 题号 1366</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84-OJ-%E7%BC%96%E5%8F%B7-1460"><span class="toc-number">9.</span> <span class="toc-text">路径 OJ 编号 1460</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BA%E5%B7%AE"><span class="toc-number">10.</span> <span class="toc-text">出差</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84%E7%8C%B4%E5%AD%90"><span class="toc-number">11.</span> <span class="toc-text">聪明的猴子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E7%94%B5"><span class="toc-number">12.</span> <span class="toc-text">通电</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E6%88%BF"><span class="toc-number">13.</span> <span class="toc-text">机房</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%B2%BB%E7%90%86"><span class="toc-number">14.</span> <span class="toc-text">环境治理</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>