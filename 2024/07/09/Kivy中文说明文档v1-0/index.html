<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Kivy中文说明文档v1.0 | Zdx-1</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('/img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Zdx-1" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>Kivy中文说明文档v1.0</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2024-07-09T13:45:29.000Z" id="date"> 2024-07-09</time></div></span><br><span>Last Update: <div class="control"><time datetime="2024-07-09T14:34:02.822Z" id="updated"> 2024-07-09</time></div></span></div></div><hr><div id="post-content"><h1 id="Kivy简介"><a href="#Kivy简介" class="headerlink" title="Kivy简介"></a>Kivy简介</h1><p>Kivy是Python的Gui的一种。</p>
<p>网上关于使用python进行ui设计的文档很少，因此为了自己方便，也为了这个领域的发展，于是编写初稿。</p>
<p><strong>注</strong>：本版本是在windows环境下使用的，后期其他系统可能会添加。</p>
<p><a target="_blank" rel="noopener" href="https://cycleuser.gitbooks.io/kivy-guide-chinese/content/00-Kivy-CN.html">参考文献</a></p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p><strong>官网原文档链接</strong></p>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/installation/installation-windows.html">Installation on Windows</a></p>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/installation/installation-linux.html">Installation on Linux</a></p>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/installation/installation-osx.html">Installation on Mac OS</a></p>
<h2 id="安装前提"><a href="#安装前提" class="headerlink" title="安装前提"></a>安装前提</h2><p>首先你得有一个合适的python环境</p>
<p>官方文档里面提及的是3.9的版本</p>
<p>国内安装比较慢，可以采用国内的开源镜像站</p>
<p><a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/python-release/">阿里云开源镜像站</a></p>
<p>之后最好设置下载镜像源为国内的，国外的比较慢</p>
<h2 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h2><p>安装了Python之后，打开命令行工具cmd，然后按照下面的命令来进行Kivy的安装。</p>
<ol>
<li>首先要保证已经安装了最新的pip和wheel：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python -m pip install --upgrade pip wheel setuptools<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>然后安装必要的依赖包(其中gstreamer大小接近139MB，如果不需要用，就可以跳过不安装这个包:</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python">python -m pip install docutils pygments pypiwin32 kivy.deps.sdl2 kivy.deps.glew<br>python -m pip install kivy.deps.gstreamer --extra-index-url https://kivy.org/downloads/packages/simple/<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>如果上一步都成功了没什么报错，就可以安装Kivy了:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python -m pip install kivy<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>在环境变量中添加一些路径到PATH来避免遇到<a target="_blank" rel="noopener" href="https://github.com/kivy/kivy/issues/3957">各种issues</a> (在你的python.exe所在的路径下运行下面的命令):</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">set</span> PATH=%PATH%;%<span class="hljs-built_in">cd</span>%\share\sdl2\bin;%<span class="hljs-built_in">cd</span>%\share\glew\bin<br></code></pre></td></tr></table></figure>

<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/guide/basic.html">原文地址</a></p>
<h2 id="Kivy环境安装搭建"><a href="#Kivy环境安装搭建" class="headerlink" title="Kivy环境安装搭建"></a>Kivy环境安装搭建</h2><p>Kivy要依赖很多Python包，比如 pygame, gstreamer, PIL, Cairo 等等还有好多。这些包并非都是必需的，要根据你的运行平台来看具体情况，有时候缺那么一两个包就可能导致安装失败，或者运行过程中出错等等，这就挺痛苦的。所以Kivy官方针对Windows和MacOS X提供了集成好关键部件的压缩包，解压缩之后直接就能用。具体的安装过程可以参考下面链接中的中文安装指南：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://blog.cycleuser.org/kivy-installment-tutorial.html">Kivy中文安装指南</a></li>
</ul>
<p>如果你非要自己从零开始安装，那最起码要确保安装有<a target="_blank" rel="noopener" href="http://cython.org/">Cython</a>和<a target="_blank" rel="noopener" href="http://pygame.org/">Pygame</a>。这两个包可以通过pip来安装，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Bash">pip install cython<br>pip install pygame<br>pip install kivy<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/kivy/kivy">Kivy的开发版本</a>也可以通过git来安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash">git <span class="hljs-built_in">clone</span> https://github.com/kivy/kivy<br>make<br></code></pre></td></tr></table></figure>

<h2 id="创建一个应用"><a href="#创建一个应用" class="headerlink" title="创建一个应用"></a>创建一个应用</h2><p>创建一个Kivy应用大概步骤如下：</p>
<ul>
<li>基于App类创建一个子类；</li>
<li>把build()方法实现为返回一个控件实例(这个控件的实例也就是你整个应用的根控件)。</li>
<li>创建一个这个类的实例，然后调用run()方法。</li>
</ul>
<p>下面的代码就是上述思路的最小化实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> kivy<br>kivy.require(<span class="hljs-string">&#x27;1.0.6&#x27;</span>) <span class="hljs-comment"># 注意要把这个版本号改变成你现有的Kivy版本号!</span><br><br><span class="hljs-keyword">from</span> kivy.app <span class="hljs-keyword">import</span> App <span class="hljs-comment"># 译者注：这里就是从kivy.app包里面导入App类</span><br><span class="hljs-keyword">from</span> kivy.uix.label <span class="hljs-keyword">import</span> Label <span class="hljs-comment"># 译者注：这里是从kivy.uix.label包中导入Label控件，这里都注意开头字母要大写</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span>(<span class="hljs-title class_ inherited__">App</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">self</span>): <span class="hljs-comment"># 译者注：这里是实现build()方法</span><br>        <span class="hljs-keyword">return</span> Label(text=<span class="hljs-string">&#x27;Hello world&#x27;</span>) <span class="hljs-comment"># 译者注：在这个方法里面使用了Label控件</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    MyApp().run() <span class="hljs-comment"># 译者注：这里就是运行了。</span><br></code></pre></td></tr></table></figure>

<p>把上面的代码以文本形式复制到一个文本文件中，保存成py文件，例如main.py，然后运行，就行了。</p>
<p class='item-img' data-src='/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/image-20240709221042996.png'><img src="/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/image-20240709221042996.png" alt="运行截图"></p>
<h2 id="Kivy应用的生命周期"><a href="#Kivy应用的生命周期" class="headerlink" title="Kivy应用的生命周期"></a>Kivy应用的生命周期</h2><p>如上图所示，不论什么用途和目的，咱们应用的入口都是这个run()方法，在本文的样例代码中，就是“MyApp().run()”。</p>
<p>下面就一行一行开始详细解释了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> kivy.app <span class="hljs-keyword">import</span> App<br></code></pre></td></tr></table></figure>

<p>为什么要导入这个App类呢？因为咱们自定义的这个App要继承这个类。这个类的位置在kivy安装目录下的kivy目录下的app.py文件中。</p>
<p>如果你想要深入挖掘一下，去了解这个Kivy的App类到底是怎么个内容，你可以打开这个app.py文件，亲自来看看。Kivy作者特别鼓励大家去阅读源码。Kivy基于Python，用Sphinx编写的文档，所以每个类的文档都在对应的文件内。</p>
<p>然后咱们回过头来，继续看本文这次的代码的第二行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> kivy.uix.label <span class="hljs-keyword">import</span> Label<br></code></pre></td></tr></table></figure>

<p>这里一定要特别注意各种包和类的导入。”kivy.uix”这个包的作用是容纳用户界面元素，比如各种输出布局和控件。</p>
<p>接下来看到这一行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span>(<span class="hljs-title class_ inherited__">App</span>):<br></code></pre></td></tr></table></figure>

<p>这一行定义了咱们这次的Kivy应用的基类。如果你要做修改的话，把MyApp改成你要设定的应用名字就可以了。</p>
<p>接着往下看：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">self</span>):<br></code></pre></td></tr></table></figure>

<p>在上面的生命周期图中加粗强调的部分表明，build函数所处的是要进行初始化和返回根控件的位置。根控件返回的操作在下面这一行中实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">return</span> Label(text=<span class="hljs-string">&#x27;Hello world&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>这里我们用文本‘Hello World’对Label这一控件进行了初始化，并且返回了其实例。这个Label就是咱们这个应用的根控件了。</p>
<p>Python是用缩进来区别代码块的，所以一定要注意上面代码的缩进和层次，尤其是函数定义那部分。</p>
<p>然后咱们继续，到了真正让应用开始运行的这部分了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    MyApp().run()<br></code></pre></td></tr></table></figure>

<p>这里对MyApp这个类进行了初始化，然后调用了这个类的run()方法。这样就初始化并启动了我们的Kivy应用了。</p>
<h2 id="运行应用"><a href="#运行应用" class="headerlink" title="运行应用"></a>运行应用</h2><p>接下来就是要在不同操作系统平台上来运行咱们刚刚写好的应用了：</p>
<p>To run the application, follow the instructions for your operating system:</p>
<ul>
<li>Windows 可以在CMD中以如下方式运行：</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs CMD">$ python main.py #用系统Python运行<br><span class="hljs-function">C:\<span class="hljs-title">appdir</span>&gt;<span class="hljs-title">kivy.bat</span> <span class="hljs-title">main.py</span> #用<span class="hljs-title">kivy.bat</span>来运行，注意这里要设定好正确的路径</span><br></code></pre></td></tr></table></figure>

<ul>
<li>Android 下面要运行还需要一些复杂的文件，所以等以后深入了之后再给讲解这部分了。</li>
</ul>
<p>这个应用运行之后的具体效果就是下面图片所示这样，会打开一个窗口，然后展示出一个Label，上面写着文本‘Hello World’，这个Label会覆盖该窗口的全部区域。就这样了。</p>
<p class='item-img' data-src='/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/quickstart.png'><img src="/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/quickstart.png" alt="img"></p>
<h2 id="修改定制这个应用"><a href="#修改定制这个应用" class="headerlink" title="修改定制这个应用"></a>修改定制这个应用</h2><p>增加一个用户名&#x2F;密码输入的页面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> kivy.app <span class="hljs-keyword">import</span> App<br><span class="hljs-keyword">from</span> kivy.uix.gridlayout <span class="hljs-keyword">import</span> GridLayout<br><span class="hljs-keyword">from</span> kivy.uix.label <span class="hljs-keyword">import</span> Label<br><span class="hljs-keyword">from</span> kivy.uix.textinput <span class="hljs-keyword">import</span> TextInput<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginScreen</span>(<span class="hljs-title class_ inherited__">GridLayout</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        <span class="hljs-built_in">super</span>(LoginScreen, self).__init__(**kwargs)<br>        self.cols = <span class="hljs-number">2</span><br>        self.add_widget(Label(text=<span class="hljs-string">&#x27;User Name&#x27;</span>))<br>        self.username = TextInput(multiline=<span class="hljs-literal">False</span>)<br>        self.add_widget(self.username)<br>        self.add_widget(Label(text=<span class="hljs-string">&#x27;password&#x27;</span>))<br>        self.password = TextInput(password=<span class="hljs-literal">True</span>, multiline=<span class="hljs-literal">False</span>)<br>        self.add_widget(self.password)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span>(<span class="hljs-title class_ inherited__">App</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> LoginScreen()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    MyApp().run()<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/image-20240709221537055.png'><img src="/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/image-20240709221537055.png" alt="运行截图"></p>
<p>在下面这行代码中，我们导入了一种名为Gridlayout的布局：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> kivy.uix.gridlayout <span class="hljs-keyword">import</span> GridLayout<br></code></pre></td></tr></table></figure>

<p>这个类被我们用作基类来制作根控件LoginScreen，在如下代码中进行了定义：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginScreen</span>(<span class="hljs-title class_ inherited__">GridLayout</span>):<br></code></pre></td></tr></table></figure>

<p>如下代码中，我们在LoginScreen类中重新定义了初始化方法<strong>init</strong>()，这样来增加一些控件，并且定义了这些控件的行为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>    <span class="hljs-built_in">super</span>(LoginScreen, self).__init__(**kwargs)<br></code></pre></td></tr></table></figure>

<p>一定要注意这里要加super，才能把现有的新初始化方法覆盖掉继承来的旧初始化方法。另外也要注意，这里调用super的时候没有省略掉**kwargs，这是一种好习惯。</p>
<p>然后继续往下看：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Python">self.cols = <span class="hljs-number">2</span><br>self.add_widget(Label(text=<span class="hljs-string">&#x27;User Name&#x27;</span>))<br>self.username = TextInput(multiline=<span class="hljs-literal">False</span>)<br>self.add_widget(self.username)<br>self.add_widget(Label(text=<span class="hljs-string">&#x27;password&#x27;</span>))<br>self.password = TextInput(password=<span class="hljs-literal">True</span>, multiline=<span class="hljs-literal">False</span>)<br>self.add_widget(self.password)<br></code></pre></td></tr></table></figure>

<p>上面的代码中，我们让GridLayout来管理子控件，把子控件设置为两栏，然后加上用户名和密码的Label字符显示控件和TextInput字符输入控件。</p>
<p>运行上面的代码，得到的窗口效果大概如下图：</p>
<p class='item-img' data-src='/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/guide_customize_step1.png'><img src="/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/guide_customize_step1.png" alt="img"></p>
<p>尝试着重新缩放一下窗口大小，你会发现上面的控件会相对整个窗口的尺寸而自行调整大小，并不需要人为去操作了。这是因为这些控件都使用了默认的尺寸。</p>
<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/guide/environment.html">英文原文</a></p>
<p>Kivy的初始化和很多行为都可以通过各种环境变量来控制。</p>
<p>例如，若要严格设定用PIL进行文本渲染，可以通过如下方式来实现：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">$ KIVY_TEXT=pil python main.py<br></code></pre></td></tr></table></figure>

<p>(译者注：PIL，Python Imaging Library, Python 下常用的绘图库)</p>
<p>所有的这些环境变量的修改设定都需要在导入Kivy之前进行，具体如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> os<br>os.environ[<span class="hljs-string">&#x27;KIVY_TEXT&#x27;</span>] = <span class="hljs-string">&#x27;pil&#x27;</span><br><span class="hljs-keyword">import</span> kivy<br></code></pre></td></tr></table></figure>

<h2 id="路径控制"><a href="#路径控制" class="headerlink" title="路径控制"></a>路径控制</h2><ul>
<li>从Kivy1.0.7版本开始提供</li>
</ul>
<p>You can control the default directories where config files, modules and kivy data are located.</p>
<p>Kivy的配置文件、模块以及数据存储的默认目录，都可手动设定所在位置。</p>
<blockquote>
<p>KIVY_DATA_DIR</p>
</blockquote>
<p>这个是Kivy的数据目录，默认值为&#x2F;data 。</p>
<blockquote>
<p>KIVY_MODULES_DIR</p>
</blockquote>
<p>这个是Kivy的模块目录，默认值为&#x2F;modules 。</p>
<blockquote>
<p>KIVY_HOME</p>
</blockquote>
<p>这个是Kivy的HOME目录，该目录是用来存放本地配置文件的，必须是一个可以写入的位置。对应不同系统也有不同位置：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-bullet">* </span>Desktop: /.kivy<br><span class="hljs-bullet">* </span>Android: /.kivy<br><span class="hljs-bullet">* </span>iOS: /Documents/.kivy<br></code></pre></td></tr></table></figure>

<ul>
<li>从Kivy1.9.0版本开始提供</li>
</ul>
<blockquote>
<p>KIVY_SDL2_PATH</p>
</blockquote>
<p>这个变量若设定了，编译Kivy的时候就会使用该位置的SDL2库文件，而不再使用系统的库文件。在环境变量PATH的开头部位就要设定好这个变量，这样在运行一个Kivy应用的时候才能也使用相同的SDL2库文件。</p>
<ul>
<li>从Kivy1.9.0版本开始提供</li>
</ul>
<h4 id="特别注意"><a href="#特别注意" class="headerlink" title="特别注意"></a>特别注意</h4><p>刚刚这个SDL2路径是用来编译Kivy的。运行程序的话就用不着了。</p>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><blockquote>
<p>KIVY_USE_DEFAULTCONFIG</p>
</blockquote>
<p>若设定了此环境变量，Kivy会读取制定的配置文件。</p>
<blockquote>
<p>KIVY_NO_CONFIG</p>
</blockquote>
<p>若设定了此环境变量，Kivy将不会读取也不会写入任何配置文件。也适用于用户配置文件夹的位置。（译者注：这句话我还没弄明白，因为没有这样尝试。）</p>
<blockquote>
<p>KIVY_NO_FILELOG</p>
</blockquote>
<p>若设定了此环境变量，日志将不再输出到文件内。</p>
<blockquote>
<p>KIVY_NO_CONSOLELOG</p>
</blockquote>
<p>若设定了此环境变量，日志将不再输出到控制台。</p>
<blockquote>
<p>KIVY_NO_ARGS</p>
</blockquote>
<p>若设定了此环境变量，命令行传递的参数将不会被Kivy解析和使用。也就是说，可以不用 – 定义符，就能随便创建一个使用自己参数的脚本或者应用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> os<br>os.environ[<span class="hljs-string">&quot;KIVY_NO_ARGS&quot;</span>] = <span class="hljs-string">&quot;1&quot;</span><br><span class="hljs-keyword">import</span> kivy<br></code></pre></td></tr></table></figure>

<ul>
<li>从Kivy1.9.0版本开始提供</li>
</ul>
<h2 id="限定Kivy-core核心，使用特定版本"><a href="#限定Kivy-core核心，使用特定版本" class="headerlink" title="限定Kivy.core核心，使用特定版本"></a>限定Kivy.core核心，使用特定版本</h2><p>Kivy.core会尝试使用所在平台的最优实现。如果要测试或者定制安装，你可能要把选择器设定为某个特定版本的kivy.core。</p>
<blockquote>
<p>KIVY_WINDOW</p>
</blockquote>
<p>这一变量是用来设定如何创建窗口，可用值：sdl2, pygame, x11, egl_rpi</p>
<blockquote>
<p>KIVY_TEXT</p>
</blockquote>
<p>这一变量是用来设定如何渲染文本，可用值：sdl2, pil, pygame, sdlttf</p>
<blockquote>
<p>KIVY_VIDEO</p>
</blockquote>
<p>这一变量是用来设定如何渲染视频，可用值：pygst, gstplayer, pyglet, ffpyplayer, ffmpeg, gi, null</p>
<blockquote>
<p>KIVY_AUDIO</p>
</blockquote>
<p>这一变量是用来设定如何播放声音，可用值：sdl2, gstplayer, pygst, ffpyplayer, pygame, gi, avplayer</p>
<blockquote>
<p>KIVY_IMAGE</p>
</blockquote>
<p>这一变量是用来设定如何读取图像，可用值：sdl2, pil, pygame, imageio, tex, dds, gif</p>
<blockquote>
<p>KIVY_CAMERA</p>
</blockquote>
<p>这一变量是用来设定如何读取摄像头，可用值：videocapture, avfoundation, pygst, opencv</p>
<blockquote>
<p>KIVY_SPELLING</p>
</blockquote>
<p>这一变量是用来设定拼写，可用值： enchant, osxappkit</p>
<blockquote>
<p>KIVY_CLIPBOARD</p>
</blockquote>
<p>这一变量是用来设定剪切板管理组件，可用值：sdl2, pygame, dummy, android</p>
<h2 id="设置单位"><a href="#设置单位" class="headerlink" title="设置单位"></a>设置单位</h2><blockquote>
<p>KIVY_DPI</p>
</blockquote>
<p>这个是用来设定Metrics.dpi的dpi值的。</p>
<ul>
<li>从Kivy1.4.0版本开始提供</li>
</ul>
<blockquote>
<p>KIVY_METRICS_DENSITY</p>
</blockquote>
<p>这个是用来设定Metrics.density，像素密度。</p>
<ul>
<li>从Kivy1.5.0版本开始提供</li>
</ul>
<blockquote>
<p>KIVY_METRICS_FONTSCALE</p>
</blockquote>
<p>这个是用来设定Metrics.fontscale，字体大小。</p>
<ul>
<li>从Kivy1.5.0版本开始提供</li>
</ul>
<h2 id="图形输出"><a href="#图形输出" class="headerlink" title="图形输出"></a>图形输出</h2><blockquote>
<p>KIVY_GL_BACKEND</p>
</blockquote>
<p>此变量用于设定使用的OpenGL后端，更多细节参考<a target="_blank" rel="noopener" href="http://kivy.org/docs/api-kivy.graphics.cgl.html#module-kivy.graphics.cgl">cgl</a>.</p>
<blockquote>
<p>KIVY_GL_DEBUG</p>
</blockquote>
<p>此变量用于设定是否对OpenGL调用进行日志记录，更多细节参考<a target="_blank" rel="noopener" href="http://kivy.org/docs/api-kivy.graphics.cgl.html#module-kivy.graphics.cgl">cgl</a>.</p>
<blockquote>
<p>KIVY_GRAPHICS</p>
</blockquote>
<p>此变量用于设定是否使用OpenGL ES2，更多细节参考<a target="_blank" rel="noopener" href="http://kivy.org/docs/api-kivy.graphics.cgl.html#module-kivy.graphics.cgl">cgl</a>.</p>
<blockquote>
<p>KIVY_GLES_LIMITS</p>
</blockquote>
<p>此变量用于设定是否强制设定GLES2（默认值为启用，设置为1）。如果设定为false，Kivy将不再兼容GLES2。（译者注：这部分我不懂，就直接生硬翻译了原文，建议大家参考一下原文去理解。）如果设置为true，可能有下表中所示的潜在的不兼容情况：</p>
<table>
<thead>
<tr>
<th>Mesh indices</th>
<th align="center">If true, the number of indices in a mesh is limited to 65535</th>
</tr>
</thead>
<tbody><tr>
<td>Texture blit</td>
<td align="center">When blitting to a texture, the data (color and buffer) format must be the same format as the one used at the texture creation. On desktop, the conversion of different color is correctly handled by the driver, while on Android, most of devices fail to do it. Ref: <a target="_blank" rel="noopener" href="https://github.com/kivy/kivy/issues/1600">https://github.com/kivy/kivy/issues/1600</a></td>
</tr>
</tbody></table>
<ul>
<li>从Kivy1.8.1版本开始提供</li>
</ul>
<blockquote>
<p>KIVY_BCM_DISPMANX_ID</p>
</blockquote>
<p>此变量是针对Raspberry Pi树莓派平台的，用于设定所选择的视频输出端口。默认值为0，下面列表中是在vc_dispmanx_types.h这个头文件中存储的可供选择的变量值：</p>
<ul>
<li>0: DISPMANX_ID_MAIN_LCD</li>
<li>1: DISPMANX_ID_AUX_LCD</li>
<li>2: DISPMANX_ID_HDMI</li>
<li>3: DISPMANX_ID_SDTV</li>
<li>4: DISPMANX_ID_FORCE_LCD</li>
<li>5: DISPMANX_ID_FORCE_TV</li>
<li>6: DISPMANX_ID_FORCE_OTHER</li>
</ul>
<p>（译者注：上面0-6分别是不同的显示输出端口，相信很容易看懂，大家探索一下吧。）</p>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/guide/config.html">英文原文</a></p>
<p>Kivy的配置文件是一个名为config.ini的文本，符合<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/INI_file">标准INI格式</a>。</p>
<h2 id="找到配置文件位置"><a href="#找到配置文件位置" class="headerlink" title="找到配置文件位置"></a>找到配置文件位置</h2><p>Kivy的配置文件存放在环境变量KIVY_HOME所制定的位置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">KIVY_HOME&gt;/config.ini<br></code></pre></td></tr></table></figure>

<p>在桌面平台上，默认的位置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">HOME_DIRECTORY&gt;/.kivy/config.ini<br></code></pre></td></tr></table></figure>

<p>所以，假设你的用户名是“tito”，在各个操作系统下的配置文件位置则如下所示：</p>
<ul>
<li>Windows: <code>C:\Users\tito\.kivy\config.ini</code></li>
<li>OS X: <code>/Users/tito/.kivy/config.ini</code></li>
<li>Linux: <code>/home/tito/.kivy/config.ini</code></li>
</ul>
<p>（译者注：这里要注意，tito只是原文的一个示范，相当于张三李四这样，新手可别照着复制找不到，要用自己操作系统中具体的用户名。）</p>
<p>在Android系统中位置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">ANDROID_APP_PATH&gt;/.kivy/config.ini<br></code></pre></td></tr></table></figure>

<p>假如你的Kivy应用的包名称为“org.kivy.launcher”,那么该Kivy应用的配置文件位于:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">/data/data/org.kivy.launcher/files/.kivy/config.ini<br></code></pre></td></tr></table></figure>

<p>在iOS上Kivy的默认配置文件位于：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">HOME_DIRECTORY&gt;/Documents/.kivy/config.ini<br></code></pre></td></tr></table></figure>

<h2 id="本地配置"><a href="#本地配置" class="headerlink" title="本地配置"></a>本地配置</h2><p>有时候用户或者开发者可能需要针对特定的应用来修改配置，或者对Kivy的某个组件进行测试，比如输入模块之类的。这时候就可以用如下命令创建一份新的配置文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> kivy.config <span class="hljs-keyword">import</span> Config<br>Config.read(file&gt;)<br><span class="hljs-comment"># set config</span><br>Config.write()<br></code></pre></td></tr></table></figure>

<p>有时候本地配置只有一个.ini文件还不够用，比如说可能你要单独使用某个garden、Kivy日志或者其他什么模块，这时候就要把KIVY_HOME这个环境变量进行修改了，指定到目标位置就行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> os<br>os.environ[<span class="hljs-string">&#x27;KIVY_HOME&#x27;</span>] = folder&gt;<br></code></pre></td></tr></table></figure>

<p>还有一种思路，就是在运行Kivy应用之前，在终端中手动修改一下这个环境变量：</p>
<ol>
<li>Windows: <code>set KIVY_HOME=folder&gt;</code></li>
<li>Linux &amp; OSX: <code>export KIVY_HOME=folder&gt;</code></li>
</ol>
<p>在设置了KIVY_HOME之后，所指定的这个文件夹就会被当做默认的.kivy文件夹来用。</p>
<h2 id="详细理解配置项"><a href="#详细理解配置项" class="headerlink" title="详细理解配置项"></a>详细理解配置项</h2><p>在<a target="_blank" rel="noopener" href="http://kivy.org/docs/api-kivy.config.html#module-kivy.config">kivy.config</a> 模块中可以看到全部的配置项的解释。</p>
<h1 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h1><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/guide/architecture.html">英文原文</a></p>
<p>本章我们将从软件工程的角度，来简单介绍一下Kivy的设计。这对于理解各个部分如何配合工作会有帮助。如果你只关注代码，可能有时候会遇到这样一种情况，就是你已经有了一个初步的想法了，但具体怎么去实现可能还是一头雾水，所以本章就针对这种情况，来更深入地讲解一下Kivy的一些基本思想。你也可以先跳过这一章，等以后再翻回来看，不过我们建议开发者还是先看一下这些内容比较好，起码可以快速略读一下有个印象。</p>
<p>Kivy包含的若干个模块，我们将对这些模块一一进行简要说明。下面这幅图是Kivy整个架构的概括图示：</p>
<p class='item-img' data-src='/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/architecture.png'><img src="/./../images/Kivy%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3v1-0/architecture.png" alt="../_images/architecture.png"></p>
<h2 id="核心模块和输入模块"><a href="#核心模块和输入模块" class="headerlink" title="核心模块和输入模块"></a>核心模块和输入模块</h2><p>对理解Kivy的设计内涵，模块化和抽象化的思想是至关重要的。我们试图把各种基本的任务进行抽象，比如打开窗口、显示图像和文本、播放音频、从摄像头获取图像、拼写校正等等。我们将这些部分称为<strong>核心</strong>任务。这样也使得API接口用起来比较简单，扩展起来也容易。更重要的是，这种思路可以让Kivy应用在运行的时候，使用各个运行平台所提供的对应功能的API接口。例如，在苹果的MacOS操作系统、Linux操作系统和Windows操作系统中，就都有各自不同的原生API接口提供各种核心功能。所以就有一部分代码，调用这些不同接口中的某一个，一方面与操作系统进行通信，另一方面与Kivy进行交互，起到中间人的角色，我们称之为<strong>核心模块</strong>。针对不同的操作系统平台要使用各自对应的核心模块，这样的好处是达到一种均衡状态，既能够充分利用操作系统提供的功能，又能尽量提高开发效率。（译者注：我的理解是这样大家平时不用针对不同操作系统去学习和使用各自的API，而只要专心使用Kivy的核心模块进行调用就行了。）这也允许用户来自由选择，使用Kivy提供的核心模块，或者直接使用各个操作系统的API接口。此外，由于使用了各个平台所提供的链接库文件，我们大大减小了Kivy发型版本的体积，也使得打包发布更加容易。这有助于将Kivy应用移植到其他平台。比如Android平台上的Kivy应用就体现了这一特性的好处了。</p>
<p>在输入模块这部分，我们也遵循了同样的思路。<strong>输入模块</strong>，是一段代码，用于针对各种输入设备提供支持，比如苹果公司的Trackpad触摸板，TUIO多点触摸设备，或者是鼠标模拟器等等。如果你需要对某一种新的输入设备添加支持，只需要提供一个新的类，用这个类来读取输入设备的数据，然后传递给Kivy基本事件，就可以了。</p>
<h2 id="图形接口"><a href="#图形接口" class="headerlink" title="图形接口"></a>图形接口</h2><p>Kivy的图形接口是对OpenGL的抽象。在最底层，Kivy使用OpenGL的命令来进行硬件加速的图形绘制。不过写OpenGL的代码可还是挺复杂的，新手就更难以迅速掌握了。所以我们就提供了一系列的图形接口，利用这些接口可以很简单地进行图形绘制，这些接口中用到了例如画布Canvas、矩形Rectangle等几何概念，比OpenGL里面简单不少。</p>
<p>Kivy自带的所有控件，都使用了这个图形接口；出于性能的考虑，此图形接口是用C语言来实现的。</p>
<p>这个图形接口的另一个好处是可以对你代码中的绘图指令进行自动优化。这个很有用，尤其是在你对OpenGL的优化不太熟悉的情况下。这能让你的绘图代码更高效。</p>
<p>当然了，你也可以坚持使用原生的OpenGL命令。目前Kivy在所有操作系统平台上用的都是是OpenGL 2.0 ES (GLES2)，所以如果你希望保持跨平台的兼容性，我们建议你只是用GLES2兼容的函数。</p>
<h2 id="核心模块"><a href="#核心模块" class="headerlink" title="核心模块"></a>核心模块</h2><p>核心模块也就是kivy.core，这个包里面提供了常用的各种功能，比如：</p>
<ul>
<li><p>Clock</p>
<p>时钟类，可以用于安排计时器事件。同时支持一次性计时和周期性计时。</p>
</li>
<li><p>Cache</p>
<p>If you need to cache something that you use often, you can use our class for that instead of writing your own.</p>
<p>缓存类，如果有一些经常用到的数据需要缓存，就可以用这个类，而不用自己写了。</p>
</li>
<li><p>Gesture Detection</p>
<p>手势识别，这个可以用来识别各种划动行为，比如画个圆圈或者方块之类的。可以训练来识别你自己设计的图形。</p>
</li>
<li><p>Kivy Language</p>
<p>Kivy语言，这个是用来简洁高效地描述Kivy应用的用户界面的。</p>
</li>
<li><p>Properties</p>
<p>这里这些属性和Python语言中的属性不同。这里是我们专门写的一些类，通过用户界面描述来连接控件代码。</p>
</li>
</ul>
<h2 id="UIX（控件和布局）"><a href="#UIX（控件和布局）" class="headerlink" title="UIX（控件和布局）"></a>UIX（控件和布局）</h2><p>UIX用户界面模块，包含了常用的各种控件和布局，可以通过复用来快速构建用户界面。</p>
<ul>
<li><p>Widgets 控件</p>
<p>控件是各种用户界面元素，可以添加到程序中来提供各种功能。有的可见，有的不可见。文件浏览器，按钮、滑动页、列表等等，这都属于控件。控件接收动作事件。</p>
</li>
<li><p>Layouts 布局</p>
<p>布局是控件的排列方式。当然，你也可以自己自定义控件的位置，不过从我们提供的预设布局中选择一个来使用，会更方便很多。网格布局、箱式布局等等，都是布局了。你还可以试试复杂的多层网状布局。</p>
</li>
</ul>
<h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><p>如果你用某一种现代的网络浏览器，并且通过一些附加组件对其进行定制，那么你应该就理解了我们提供的各种模块类的基本思想了。各种模块可以用来向Kivy程序中添加功能，即便原作者没有提供的功能也可以加进去了。</p>
<p>例如，有一个模块就能显示当前应用的FPS（Frame Per Second，每秒帧数，即帧率），然后还能统计一段时间的FPS变化。</p>
<p>你可以自己写各种模块添加到应用中。</p>
<h2 id="输入事件（Touches）"><a href="#输入事件（Touches）" class="headerlink" title="输入事件（Touches）"></a>输入事件（Touches）</h2><p>Kivy抽象了各种输入类型和输入设备，比如触控，鼠标按键，多点触摸等等。这些输入类型有一个共同点，就是都可以把各种输入事件映射成屏幕上对应的一种2D形态。（当然了，还有的输入设备就没法用2D形态来表示，比如通过加速度传感器来衡量设备倾斜角度等。这种情况就得另外考虑了。下面我们讨论的只是那些能用2D形态表示的输入事件，复杂的类型以后再说。）</p>
<p>这些输入类型，在Kivy中都用Touch()类的实例来表示。（请注意，这里可不仅仅是针对手指去触摸的那种touch，而是所有可以这样抽象表示的输入事件。这里用<strong>Touch</strong>只是为了方便而这么简称一下。就想象一下，这些<strong>Touches</strong>就是在用户界面或者显示屏上面的那些个<strong>点击行为</strong>。 ）Touch的实例或者对象，有三种状态。当这个Touch进入了其中的某一个状态，你的程序就会被告知此事件的发生。Touch的三种状态如下：</p>
<ul>
<li><p>Down 落下</p>
<p>处于落下状态，只能有一次，就是在发生Touch事件的初始时刻。</p>
</li>
<li><p>Move 移动</p>
<p>这个状态的时间无上限。在一个Touch的生命周期中可以没有这个状态。移动状态只发生在Touch的2D平面位置发生变化的情况下。</p>
</li>
<li><p>Up 抬起</p>
<p>A touch goes up at most once, or never. In practice you will almost always receive an up event because nobody is going to hold a finger on the screen for all eternity, but it is not guaranteed. If you know the input sources your users will be using, you will know whether or not you can rely on this state being entered.</p>
<p>一个Touch要么只能抬起一次，要么就不发生。而实际应用中你会经常遇到Up时间，因为没有人会一直把手指按到屏幕上，不过也有未必就绝对不会有这种情况。若事先知道用户用的输入设备，就可以确定能否完全依靠用户的输入状态。</p>
<p>（译者注：以手指触摸屏幕为例，只有开始接触的时候是Down手指落下这个状态，之后移动就是接下来的Move移动状态，手指抬起来的时候就是Up即抬起状态了；如果以鼠标左键点击为例，按下去左键的时候是Down，按住左键不放进行拖动就是Move，松开左键就是Up了。这段我特别解释一下，因为自己翻译的太生硬了。）</p>
</li>
</ul>
<h2 id="控件和事件调度"><a href="#控件和事件调度" class="headerlink" title="控件和事件调度"></a>控件和事件调度</h2><p>在图形化的软件开发语境下，<strong>控件</strong>这个词经常出现，一般是来描述程序中用于和用户进行交互的组件。在Kivy中，控件是用来接收各种输入事件的。所以并不一定非要在屏幕上能看得到。Kivy当中所有控件都以<strong>控件树</strong>的形式来管理，学过计算机科学中数据结构相关知识的话，就会意识到这是一种树形结构：一个控件可以有任意多个子控件，也可以没有子控件。<strong>根控件</strong>就只能有一个，处于树形结构的顶端，根控件不具有父控件，并且所有其他控件都是根控件的直接或者间接子控件（就像树根一样，所以叫根控件）。</p>
<p>当新的输入数据可用的时候，Kivy会针对每一个Touch发出一个事件。控件树种的根控件首先接收到这个事件。Touch的不同状态，on_touch_down, on_touch_move和on_touch_up （Down落下、Move移动和Up），会作为Touch的参数，提供给根控件，根控件会调用对应的事件Handler来作出反应。</p>
<p>包括根控件在内，控件树种的每个控件都可以有两种选择，处理该事件，或者将该事件传递下去。如果一个事件的Handler返回True，就意味着这个事件已经被接收并妥善处理。这个事件就也到此为止了。如果不是这样，事件的Handler会跳过此处的空间，调用父类中的对应事件的Handler实现，传递给该控件的子控件。这样的过程可以一路走到最基础的控件类Widget，在它的Touch事件Handler中，只是把Touch传递给子控件，而不进行其他的操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># This is analogous for move/up:</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">on_touch_down</span>(<span class="hljs-params">self, touch</span>):<br>    <span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> self.children[:]:<br>        <span class="hljs-keyword">if</span> child.dispatch(<span class="hljs-string">&#x27;on_touch_down&#x27;</span>, touch):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>

<p>说起来挺麻烦，看上去挺复杂，实际上要简单得多。下一章就会讲解如何使用这种特性来快速创建应用了。</p>
<p>经常有一种情况，就是你可能要让一个控件只在屏幕上某个特定的<strong>区域</strong>来监听Touch事件。这时候就可以使用控件的collide_point()方法来实现此目的。只需要把Touch的位置发给该方法，然后如果此位置位于<strong>监听区域</strong>则返回True，反之返回False。默认情况下，这个方法会监听屏幕上的一个矩形区域，根据控件的中心坐标（x &amp; y坐标系），以及空间尺寸（宽度和高度），不过你也可以用自己的类覆盖掉这一行为。</p>
<p>Title: Kivy Widgets Date: 2017-02-26 Category: Kivy Tags: Python,Kivy</p>
<h1 id="控件"><a href="#控件" class="headerlink" title="控件"></a>控件</h1><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/guide/widgets.html">英文原文</a></p>
<h2 id="控件简介"><a href="#控件简介" class="headerlink" title="控件简介"></a>控件简介</h2><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件<code>Widget</code></a>是 Kivy 图形界面中的基本元素。控件提供了一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.html#kivy.graphics.Canvas" title="kivy.graphics.Canvas">画布<code>Canvas</code></a>，这是用来在屏幕上进行绘制的。控件接收事件，并且对事件作出反应。想要对 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件<code>Widget</code></a>进行更深入的了解，可以去看看这个模块的文档。</p>
<h2 id="操作控件树"><a href="#操作控件树" class="headerlink" title="操作控件树"></a>操作控件树</h2><p>Kivy 以树的形式来组织控件。你的应用程序会有一个根控件，通常会含有若干的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件 <code>children</code></a>，这些子控件还可以有自己的子控件。一个控件的子控件会以 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children"><code>children</code></a>属性的形式表述，这个属性是 Kivy 中的一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.properties.html#kivy.properties.ListProperty" title="kivy.properties.ListProperty">列表属性 <code>ListProperty</code></a></p>
<p>可以用一下方法来操作控件树：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.add_widget" title="kivy.uix.widget.Widget.add_widget"><code>add_widget()</code></a>: 添加一个控件作为子控件；</li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.remove_widget" title="kivy.uix.widget.Widget.remove_widget"><code>remove_widget()</code></a>: 从子控件列表中去掉一个控件；</li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.clear_widgets" title="kivy.uix.widget.Widget.clear_widgets"><code>clear_widgets()</code></a>: 清空一个控件的所有子控件。</li>
</ul>
<p>例如下面的代码，就是在一个盒式布局 BoxLayout 中添加一个按钮：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">layout = <span class="hljs-built_in">BoxLayout</span>(<span class="hljs-attribute">padding</span>=&lt;span&gt;<span class="hljs-number">10</span>&lt;/span&gt;)<br><span class="hljs-selector-tag">button</span> = <span class="hljs-built_in">Button</span>(text=&lt;span&gt;<span class="hljs-string">&#x27;My first button&#x27;</span>&lt;/span&gt;)<br>layout<span class="hljs-selector-class">.add_widget</span>(button)<br></code></pre></td></tr></table></figure>

<p>这个按钮就添加到布局当中去了：按钮的 parent 属性会被设置为这个布局；这个按钮也会被添加到布局中的子控件列表。要把这个按钮从这个布局中删掉也很简单：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">layout</span>.remove_widget(<span class="hljs-keyword">button</span>)<br></code></pre></td></tr></table></figure>

<p>移除了之后，这个按钮的 parent 属性就会被设置为 None，也会被从布局的子控件列表中移除。</p>
<p>要是想清空一个控件中的所有自科技，那就用 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.clear_widgets" title="kivy.uix.widget.Widget.clear_widgets"><code>clear_widgets()</code></a>方法就可以了：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">layout.clear_widgets<span class="hljs-comment">()</span><br></code></pre></td></tr></table></figure>

<h4 id="特别注意-1"><a href="#特别注意-1" class="headerlink" title="特别注意"></a>特别注意</h4><p>千万别自己手动去操作子控件列表，除非你确定自己掌控得非常深入透彻。因为控件树是和绘图树联系在一起的。例如，如果你添加了一个控件到子控件列表，但没有添加这个新子控件的画布到绘图树上，那么就会出现这种情况：这个控件确实成了一个子控件，但是屏幕上不会显示出来。此外，如果你后续使用添加、移除、清空控件这些操作，可能还会遇到问题。</p>
<h2 id="遍历控件树"><a href="#遍历控件树" class="headerlink" title="遍历控件树"></a>遍历控件树</h2><p>控件类实例的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件<code>children</code></a>列表属性中包含了所有的子控件。所以可以用如下的方式来进行遍历：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">root = BoxLayout()<br><span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># ... add widgets to root ...&lt;/span&gt;</span><br><span class="hljs-variable">&lt;span&gt;</span>for<span class="hljs-variable">&lt;/span&gt;</span> child <span class="hljs-variable">&lt;span&gt;</span>in<span class="hljs-variable">&lt;/span&gt;</span> root.children:<br>    print(child)<br></code></pre></td></tr></table></figure>

<p>然而，这样的操作可得谨慎使用。如果你要用之前一节中提到的方法来修改这个子控件列表电话，请一定用下面这种方法来做一下备份：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"><span class="hljs-variable">&lt;span&gt;</span>for<span class="hljs-variable">&lt;/span&gt;</span> child <span class="hljs-variable">&lt;span&gt;</span>in<span class="hljs-variable">&lt;/span&gt;</span> root.children[:]:<br>    <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># manipulate the tree. For example here, remove all widgets that have a&lt;/span&gt;</span><br>    <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># width&lt;/span&gt;</span><br>    <span class="hljs-variable">&lt;span&gt;</span>if<span class="hljs-variable">&lt;/span&gt;</span> child.width  <span class="hljs-variable">&lt;span&gt;</span>100<span class="hljs-variable">&lt;/span&gt;</span>:<br>        root.remove_widget(child)<br></code></pre></td></tr></table></figure>

<p>默认情况下，控件是不会对子控件的尺寸&#x2F;位置进行改变的。<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos" title="kivy.uix.widget.Widget.pos">位置属性 <code>pos</code></a>是屏幕坐标系上的绝对值（除非你使用<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.relativelayout.html#module-kivy.uix.relativelayout" title="kivy.uix.relativelayout">相对布局<code>relativelayout</code></a>，这个以后再说），而<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size" title="kivy.uix.widget.Widget.size">尺寸属性 <code>size</code></a>就是一个绝对的尺寸大小。</p>
<h2 id="控件索引Z"><a href="#控件索引Z" class="headerlink" title="控件索引Z"></a>控件索引Z</h2><p>控件绘制的顺序，是基于各个控件在控件树中的位置。<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.add_widget" title="kivy.uix.widget.Widget.add_widget">添加控件方法 <code>add_widget</code></a> 可以接收一个索引参数，这样就能指定该新增控件在控件树中的位置。</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">root.add_widget(widget, <span class="hljs-keyword">index</span>)<br></code></pre></td></tr></table></figure>

<p>索引值小的控件会被绘制在索引值大的控件之上。一定要记住，默认值是 0 ，所以后添加的控件总会在所有控件的最顶层，除非指定了索引值。</p>
<h2 id="整理布局"><a href="#整理布局" class="headerlink" title="整理布局"></a>整理布局</h2><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.layout.html#module-kivy.uix.layout" title="kivy.uix.layout">布局 <code>layout</code></a>是一种特别的控件，它会控制自己子控件的尺寸和位置。有各种不同的布局，这些布局分别为子控件提供拜托你个的自动组织整理。这些布局使用<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint">尺寸推测 <code>size_hint</code></a>和<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos_hint" title="kivy.uix.widget.Widget.pos_hint">位置推测 <code>pos_hint</code></a>这两个属性来决定<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件<code>children</code></a>的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size" title="kivy.uix.widget.Widget.size">尺寸 <code>size</code></a> 和 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos" title="kivy.uix.widget.Widget.pos">位置<code>pos</code></a>。</p>
<p><strong>盒式布局 BoxLayout</strong>: 所有控件充满整个空间，以互相挨着的方块的方式来分布，横着或者竖着排列都可以。子控件的 size_hint 属性可以用来改变每个子控件的比例，也可以设置为固定尺寸。</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/boxlayout1.gif'><img src="https://kivy.org/docs/_images/boxlayout1.gif" alt="../_images/boxlayout1.gif"> <img src="https://kivy.org/docs/_images/gridlayout1.gif" alt="../_images/gridlayout1.gif" class='item-img' data-src='https://kivy.org/docs/_images/gridlayout1.gif'><img src="https://kivy.org/docs/_images/gridlayout1.gif" alt="../_images/gridlayout1.gif"> <img src="https://kivy.org/docs/_images/anchorlayout1.gif" alt="../_images/anchorlayout1.gif" class='item-img' data-src='https://kivy.org/docs/_images/anchorlayout1.gif'><img src="https://kivy.org/docs/_images/anchorlayout1.gif" alt="../_images/anchorlayout1.gif"></p>
<p><strong>网格布局 GridLayout</strong>: 以一张网格的方式来安排控件。你必须指定好网格的维度，确定好分成多少格，这样 Kivy 才能计算出每个元素的尺寸并且确定如何安排这些元素的位置。</p>
<p><strong>栈状布局 StackLayout</strong>: 挨着放一个个控件，彼此邻近，在某一个维度上有固定大小，而使它们填充整个空间。 这适合用来显示相同预定义大小的子控件。</p>
<p><strong>锚式布局 AnchorLayout</strong>: 一种非常简单的布局，只关注子控件的位置。 将子控件放在布局的边界位置。 不支持size_hint。</p>
<p><strong>浮动布局 FloatLayout</strong>: 允许放置具任意位置和尺寸的子控件，可以是绝对尺寸，也可以是相对布局的相对尺寸。 默认的 size_hint（1，1）会让每个子控件都与整个布局一样大，所以如果你多个子控件就要修改这个值。可以把 size_hint 设置成 (None, None)，这样就可以使用 size 这个绝对尺寸属性。控件也支持 pos_hint，这个属性是一个 dict 词典，用来设置相对布局的位置。</p>
<p><strong>相对布局 RelativeLayout</strong>: 和浮动布局 FloatLayout 差不多，不同之处在于子控件的位置是相对于布局空间的，而不是相对于屏幕。</p>
<p>想要深入理解各种布局的话，可以仔细阅读各种文档。</p>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a> 和 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos_hint" title="kivy.uix.widget.Widget.pos_hint"><code>pos_hint</code></a>:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.floatlayout.html#module-kivy.uix.floatlayout" title="kivy.uix.floatlayout"><code>floatlayout</code></a></li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#module-kivy.uix.boxlayout" title="kivy.uix.boxlayout"><code>boxlayout</code></a></li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.gridlayout.html#module-kivy.uix.gridlayout" title="kivy.uix.gridlayout"><code>gridlayout</code></a></li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.stacklayout.html#module-kivy.uix.stacklayout" title="kivy.uix.stacklayout"><code>stacklayout</code></a></li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.relativelayout.html#module-kivy.uix.relativelayout" title="kivy.uix.relativelayout"><code>relativelayout</code></a></li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.anchorlayout.html#module-kivy.uix.anchorlayout" title="kivy.uix.anchorlayout"><code>anchorlayout</code></a></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a> 是一个 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.properties.html#kivy.properties.ReferenceListProperty" title="kivy.properties.ReferenceListProperty">引用列表属性 <code>ReferenceListProperty</code></a> ，包括 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a> 和<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_y" title="kivy.uix.widget.Widget.size_hint_y"><code>size_hint_y</code></a> 两个变量。接收的变量值是从0到1的各种数值，或者 None， 默认值为 (1, 1)。这表示如果控件处在布局之内，布局将会在两个方向分配全部尺寸（相对于布局大小）给该控件。</p>
<p>举个例子，设置<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a> 为 (0.5, 0.8)，就会给该<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件<code>Widget</code></a> 分配<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.layout.html#module-kivy.uix.layout" title="kivy.uix.layout">布局 <code>layout</code></a> 内50% 宽，80% 高的尺寸。</p>
<p>例如下面这个例子：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">BoxLayout:<br>    Button:<br>        text: <span class="hljs-variable">&lt;span&gt;</span>&#x27;Button 1&#x27;<span class="hljs-variable">&lt;/span&gt;</span><br>        <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># default size_hint is 1, 1, we don&#x27;t need to specify it explicitly&lt;/span&gt;</span><br>        <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># however it&#x27;s provided here to make things clear&lt;/span&gt;</span><br>        size_hint: <span class="hljs-variable">&lt;span&gt;</span>1<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>1<span class="hljs-variable">&lt;/span&gt;</span><br></code></pre></td></tr></table></figure>

<p>加载 Kivy 目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> <span class="hljs-variable">$KIVYDIR</span>/examples/demo/kivycatalog<br>python main.py<br></code></pre></td></tr></table></figure>

<p>把上面代码中的 $KIVYDIR 替换成你的 Kivy 安装位置。在左边点击标注有 Box Layout 的按钮。 然后将上面的代码粘贴到窗口右侧的编辑器内。</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/size_hint[B].jpg'><img src="https://kivy.org/docs/_images/size_hint[B].jpg" alt="../_images/size_hint[B].jpg"></p>
<p>然后你就可以看到上图这样的界面了，这个按钮 Button 会占据整个布局<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size" title="kivy.uix.widget.Widget.size">尺寸 <code>size</code></a>的 100%。</p>
<p>修改<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a>&#x2F;<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_y" title="kivy.uix.widget.Widget.size_hint_y"><code>size_hint_y</code></a> 为 .5 这就会把<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件 <code>Widget</code></a> 调整为<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.layout.html#module-kivy.uix.layout" title="kivy.uix.layout">布局 <code>layout</code></a> 的50% <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.width" title="kivy.uix.widget.Widget.width">宽度 <code>width</code></a>&#x2F;<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.height" title="kivy.uix.widget.Widget.height">高度 <code>height</code></a>。</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/size_hint[b_].jpg'><img src="https://kivy.org/docs/_images/size_hint[b_].jpg" alt="../_images/size_hint[b_].jpg"></p>
<p>这时候效果如上图所示，虽然我们已经同时指定了 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a> 和 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_y" title="kivy.uix.widget.Widget.size_hint_y"><code>size_hint_y</code></a> 为 .5，但似乎只有对 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a> 的修改起作用了。这是因为在<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#module-kivy.uix.boxlayout" title="kivy.uix.boxlayout">盒式布局 <code>boxlayout</code></a>中，当<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#kivy.uix.boxlayout.BoxLayout.orientation" title="kivy.uix.boxlayout.BoxLayout.orientation"><code>orientation</code></a>被设置为竖直方向（vertical） 的时候，<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_y" title="kivy.uix.widget.Widget.size_hint_y"><code>size_hint_y</code></a> 由布局来控制，而如果<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#kivy.uix.boxlayout.BoxLayout.orientation" title="kivy.uix.boxlayout.BoxLayout.orientation"><code>orientation</code></a> 被设置为水平方向（horizontal）的时候， <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a> 由布局来控制，所以这些情况手动设定就无效了。 这些受控维度的尺寸，是根据<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件 <code>children</code></a> 在 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#module-kivy.uix.boxlayout" title="kivy.uix.boxlayout"><code>盒式布局 boxlayout</code></a>中的总编号来计算的。在上面的例子中，这个子控件的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_y" title="kivy.uix.widget.Widget.size_hint_y"><code>size_hint_y</code></a> 是受控的(.5&#x2F;.5 &#x3D; 1)。所以，这里控件就占据了上层布局的整个高度。</p>
<p>接下来咱们再添加一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.button.html#kivy.uix.button.Button" title="kivy.uix.button.Button">按钮 <code>Button</code></a>到这个 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.layout.html#module-kivy.uix.layout" title="kivy.uix.layout">布局 <code>layout</code></a>看看有什么效果。</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/size_hint[bb].jpg'><img src="https://kivy.org/docs/_images/size_hint[bb].jpg" alt="../_images/size_hint[bb].jpg"></p>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#module-kivy.uix.boxlayout" title="kivy.uix.boxlayout">盒式布局 <code>boxlayout</code></a> 默认对其所有的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件 <code>children</code></a>分配了等大的空间。在咱们这个例子里面，比例是50-50，因为有两个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件 <code>children</code></a>。那么接下来咱们就对其中的一个子控件设置一下 size_hint，然后看看效果怎么样。</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/size_hint[oB].jpg'><img src="https://kivy.org/docs/_images/size_hint[oB].jpg" alt="../_images/size_hint[oB].jpg"></p>
<p>从上图可以看出，如果一个子控件有了一个指定的 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a>，这就会决定该<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件 <code>Widget</code></a>使用<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.boxlayout.html#module-kivy.uix.boxlayout" title="kivy.uix.boxlayout">盒式布局 <code>boxlayout</code></a>提供的空间中的多大比例，来作为自己的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size" title="kivy.uix.widget.Widget.size">尺寸 <code>size</code></a> 。在我们这个例子中，第一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.button.html#kivy.uix.button.Button" title="kivy.uix.button.Button">按钮 <code>Button</code></a> 的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a>设置为了 .5。那么这个控件分配到的空间计算方法如下：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">first</span> child&#x27;s size_hint divided <span class="hljs-keyword">by</span><br><span class="hljs-keyword">first</span> child&#x27;s size_hint + <span class="hljs-keyword">second</span> child&#x27;s size_hint + ...n(no <span class="hljs-keyword">of</span> children)<br><br><span class="hljs-number">.5</span>/(<span class="hljs-number">.5</span>+<span class="hljs-number">1</span>) = <span class="hljs-number">.333</span>...<br></code></pre></td></tr></table></figure>

<p>盒式布局 BoxLayout 的剩余<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.width" title="kivy.uix.widget.Widget.width">宽度 <code>width</code></a>会分配给另外的一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.children" title="kivy.uix.widget.Widget.children">子控件 <code>children</code></a>。在我们这个例子中，这就意味着第二个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.button.html#kivy.uix.button.Button" title="kivy.uix.button.Button">按钮 <code>Button</code></a> 会占据整个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.layout.html#module-kivy.uix.layout" title="kivy.uix.layout">布局 <code>layout</code></a>的 66.66% <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.width" title="kivy.uix.widget.Widget.width">宽度 <code>width</code></a> 。</p>
<p>修改 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a> 探索一下来多适应一下吧。</p>
<p>如果你想要控制一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件 <code>Widget</code></a>的绝对<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size" title="kivy.uix.widget.Widget.size">尺寸 <code>size</code></a> ，可以把<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_x" title="kivy.uix.widget.Widget.size_hint_x"><code>size_hint_x</code></a>&#x2F;<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint_y" title="kivy.uix.widget.Widget.size_hint_y"><code>size_hint_y</code></a>当中的一个或者两个都设置成 None，这样的话该控件的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.width" title="kivy.uix.widget.Widget.width">宽度 <code>width</code></a> 和<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.height" title="kivy.uix.widget.Widget.height">高度 <code>height</code></a>的属性值就会生效了。</p>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos_hint" title="kivy.uix.widget.Widget.pos_hint"><code>pos_hint</code></a> 是一个词典 dict，默认值是空。相比于<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a>，布局对<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos_hint" title="kivy.uix.widget.Widget.pos_hint"><code>pos_hint</code></a>的处理方式有些不同，不过大体上你还是可以对<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos" title="kivy.uix.widget.Widget.pos"><code>pos</code></a> 的各种属性设定某个值来设定<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget" title="kivy.uix.widget.Widget">控件 <code>Widget</code></a>在<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.parent" title="kivy.uix.widget.Widget.parent">父控件 <code>parent</code></a>中的相对位置（可以设定的属性包括：<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.x" title="kivy.uix.widget.Widget.x"><code>x</code></a>, <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.y" title="kivy.uix.widget.Widget.y"><code>y</code></a>, <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.right" title="kivy.uix.widget.Widget.right"><code>right</code></a>, <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.top" title="kivy.uix.widget.Widget.top"><code>top</code></a>, <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.center_x" title="kivy.uix.widget.Widget.center_x"><code>center_x</code></a>, <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.center_y" title="kivy.uix.widget.Widget.center_y"><code>center_y</code></a>）。</p>
<p>咱们用下面 kivycatalog 中的代码来可视化地理解一下<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos_hint" title="kivy.uix.widget.Widget.pos_hint"><code>pos_hint</code></a>：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">FloatLayout:<br>    Button:<br>        text: <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-string">&quot;We Will&quot;</span><span class="hljs-variable">&lt;/span&gt;</span><br>        pos: <span class="hljs-variable">&lt;span&gt;</span>100<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>100<span class="hljs-variable">&lt;/span&gt;</span><br>        size_hint: <span class="hljs-variable">&lt;span&gt;</span>.2<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>.4<span class="hljs-variable">&lt;/span&gt;</span><br>    Button:<br>        text: <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-string">&quot;Wee Wiill&quot;</span><span class="hljs-variable">&lt;/span&gt;</span><br>        pos: <span class="hljs-variable">&lt;span&gt;</span>200<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>200<span class="hljs-variable">&lt;/span&gt;</span><br>        size_hint: <span class="hljs-variable">&lt;span&gt;</span>.4<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>.2<span class="hljs-variable">&lt;/span&gt;</span><br><br>    Button:<br>        text: <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-string">&quot;ROCK YOU!!&quot;</span><span class="hljs-variable">&lt;/span&gt;</span><br>        pos_hint: &#123;<span class="hljs-variable">&lt;span&gt;</span>&#x27;x&#x27;<span class="hljs-variable">&lt;/span&gt;</span>: <span class="hljs-variable">&lt;span&gt;</span>.3<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>&#x27;y&#x27;<span class="hljs-variable">&lt;/span&gt;</span>: <span class="hljs-variable">&lt;span&gt;</span>.6<span class="hljs-variable">&lt;/span&gt;</span>&#125;<br>        size_hint: <span class="hljs-variable">&lt;span&gt;</span>.5<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>.2<span class="hljs-variable">&lt;/span&gt;</span><br></code></pre></td></tr></table></figure>

<p>这份代码的输出效果如下图所示：</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/pos_hint.jpg'><img src="https://kivy.org/docs/_images/pos_hint.jpg" alt="../_images/pos_hint.jpg"></p>
<p>说了半天<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size_hint" title="kivy.uix.widget.Widget.size_hint"><code>size_hint</code></a>，你不妨自己试试探索一下 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos_hint" title="kivy.uix.widget.Widget.pos_hint"><code>pos_hint</code></a>，来理解一下这个属性对控件位置的效果。</p>
<h2 id="给布局添加背景"><a href="#给布局添加背景" class="headerlink" title="给布局添加背景"></a>给布局添加背景</h2><p>关于布局，有一个问题经常被问道：</p>
<p>“怎么给一个布局添加背景图片&#x2F;颜色&#x2F;视频&#x2F;等等……”</p>
<p>本来默认的各种布局都是没有视觉呈现的：因为布局不像控件，布局是默认不含有绘图指令的。不过呢，还是你可以给一个布局实例添上绘图指令，也就可以添加一个彩色背景了：</p>
<p>在 Python 中的实现方法：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"><span class="hljs-variable">&lt;span&gt;</span>from<span class="hljs-variable">&lt;/span&gt;</span> kivy.graphics <span class="hljs-variable">&lt;span&gt;</span>import<span class="hljs-variable">&lt;/span&gt;</span> Color, Rectangle<br><br><span class="hljs-variable">&lt;span&gt;</span>with<span class="hljs-variable">&lt;/span&gt;</span> layout_instance.canvas.before:<br>    Color(<span class="hljs-variable">&lt;span&gt;</span>0<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>1<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>0<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>1<span class="hljs-variable">&lt;/span&gt;</span>) <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># green; colors range from 0-1 instead of 0-255&lt;/span&gt;</span><br>    self.rect = Rectangle(size=layout_instance.size,<br>                           pos=layout_instance.pos)<br></code></pre></td></tr></table></figure>

<p>然而很不幸，这样只能在布局的初始化位置以布局的初始尺寸绘制一个矩形。所以还要对布局的尺寸和位置变化进行监听，然后对矩形的尺寸位置进行更新，这样才能保证这个矩形一直绘制在布局的内部。可以用如下方式实现：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>with<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> layout_instance.canvas.before:<br>    Color(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>) <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># green; colors range from 0-1 instead of 0-255<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    self.rect = Rectangle(size=layout_instance.size,<br>                           pos=layout_instance.pos)<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>update_rect<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(instance, value)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    <span class="hljs-keyword">instance</span>.rect.pos = <span class="hljs-keyword">instance</span>.pos<br>    <span class="hljs-keyword">instance</span>.rect.size = <span class="hljs-keyword">instance</span>.size<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># listen to size and position changes<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>layout_instance.bind(pos=update_rect, size=update_rect)<br></code></pre></td></tr></table></figure>

<p>在 kv 文件中：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">FloatLayout:<br>    canvas.before:<br>        Color:<br>            rgba: <span class="hljs-variable">&lt;span&gt;</span>0<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>1<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>0<span class="hljs-variable">&lt;/span&gt;</span>, <span class="hljs-variable">&lt;span&gt;</span>1<span class="hljs-variable">&lt;/span&gt;</span><br>        Rectangle:<br>            <span class="hljs-variable">&lt;span&gt;</span><span class="hljs-comment"># self here refers to the widget i.e BoxLayout&lt;/span&gt;</span><br>            pos: self.pos<br>            size: self.size<br></code></pre></td></tr></table></figure>

<p>上面的 Kv 文件中的生命，就建立了一个隐含的绑定：上面 Kv 代码中的最后两行保证了矩形的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos" title="kivy.uix.widget.Widget.pos">位置 <code>pos</code></a>和<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.size" title="kivy.uix.widget.Widget.size">尺寸 <code>size</code></a>会在<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.floatlayout.html#module-kivy.uix.floatlayout" title="kivy.uix.floatlayout">浮动布局 <code>floatlayout</code></a>的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.widget.html#kivy.uix.widget.Widget.pos" title="kivy.uix.widget.Widget.pos">位置 <code>pos</code></a>发生变化的时候进行更新。</p>
<p>接下来咱们把上面的代码片段放进 Kivy 应用里面。</p>
<p>纯 Python 方法：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.app <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> App<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.graphics <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Color, Rectangle<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.floatlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> FloatLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.button <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Button<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>RootWidget<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(FloatLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>__init__<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self, **kwargs)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># make sure we aren&#x27;t overriding any important functionality<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        super(RootWidget, self).__init_<span class="hljs-number">_</span>(**kwargs)<br><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># let&#x27;s add a Widget to this layout<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        self.add_widget(<br>            Button(<br>                <span class="hljs-type">text</span>=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&quot;Hello World&quot;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>,<br>                size_hint=(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>),<br>                pos_hint=&#123;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;center_x&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;center_y&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>: <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;))<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>MainApp<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(App)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>build<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        self<span class="hljs-built_in">.root</span> =<span class="hljs-built_in"> root</span> = RootWidget()<br>       <span class="hljs-built_in"> root</span>.bind(size=self._update_rect, pos=self._update_rect)<br><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>with<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="hljs-built_in"> root</span>.canvas.before:<br>            Color(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># green; colors range from 0-1 not 0-255<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>            self.rect = Rectangle(size<span class="hljs-built_in">=root</span>.size, pos<span class="hljs-built_in">=root</span>.pos)<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>return<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="hljs-built_in"> root</span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>_update_rect<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self, instance, value)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        self.rect.pos = <span class="hljs-keyword">instance</span>.pos<br>        self.rect.size = <span class="hljs-keyword">instance</span>.size<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>if<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> __name_<span class="hljs-number">_</span> == <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;__main__&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<br>    MainApp().run()<br></code></pre></td></tr></table></figure>

<p>使用 Kv 语言：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.app <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> App<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy<span class="hljs-built_in">.lang</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Builder<br><br><span class="hljs-built_in"></span><br><span class="hljs-built_in">root</span> = Builder.load_string(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;&#x27;&#x27;</span><br><span class="language-xml">FloatLayout:</span><br><span class="language-xml">    canvas.before:</span><br><span class="language-xml">        Color:</span><br><span class="language-xml">            rgba: 0, 1, 0, 1</span><br><span class="language-xml">        Rectangle:</span><br><span class="language-xml">            # self here refers to the widget i.e FloatLayout</span><br><span class="language-xml">            pos: self.pos</span><br><span class="language-xml">            size: self.size</span><br><span class="language-xml">    Button:</span><br><span class="language-xml">        text: &#x27;Hello World!!&#x27;</span><br><span class="language-xml">        size_hint: .5, .5</span><br><span class="language-xml">        pos_hint: </span><span class="language-xquery">&#123;<span class="hljs-string">&#x27;center_x&#x27;</span>:.<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;center_y&#x27;</span>: .<span class="hljs-number">5</span>&#125;</span><span class="language-xml"></span><br><span class="language-xml">&#x27;&#x27;&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>MainApp<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(App)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>build<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>return<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="hljs-built_in"> root</span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>if<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> __name_<span class="hljs-number">_</span> == <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;__main__&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<br>    MainApp().run()<br></code></pre></td></tr></table></figure>

<p>上面这两个应用的效果都如下图所示： <img src="https://kivy.org/docs/_images/layout_background.png" alt="../_images/layout_background.png"></p>
<h3 id="给自定义布局规则-类增加背景色"><a href="#给自定义布局规则-类增加背景色" class="headerlink" title="给自定义布局规则&#x2F;类增加背景色"></a>给<strong>自定义布局规则&#x2F;类</strong>增加背景色</h3><p>上面那一段中咱们对布局实例增加背景的方法，如果用到很多歌布局里面，那就很快变得特别麻烦了。要解决这种需求，就可以基于布局类 Layout 创建一个自定义的布局子类，给自定义的这个类增加一个背景。</p>
<p>使用 Python：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.app <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> App<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.graphics <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Color, Rectangle<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.boxlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> BoxLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.floatlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> FloatLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.image <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> AsyncImage<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>RootWidget<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(BoxLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>pass<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>CustomLayout<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(FloatLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>__init__<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self, **kwargs)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># make sure we aren&#x27;t overriding any important functionality<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        super(CustomLayout, self).__init_<span class="hljs-number">_</span>(**kwargs)<br><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>with<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> self.canvas.before:<br>            Color(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span># green; colors range from 0-1 instead of 0-255<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>            self.rect = Rectangle(size=self.size, pos=self.pos)<br><br>        self.bind(size=self._update_rect, pos=self._update_rect)<br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>_update_rect<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self, instance, value)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        self.rect.pos = <span class="hljs-keyword">instance</span>.pos<br>        self.rect.size = <span class="hljs-keyword">instance</span>.size<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>MainApp<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(App)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>build<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>       <span class="hljs-built_in"> root</span> = RootWidget()<br>        c = CustomLayout()<br>       <span class="hljs-built_in"> root</span>.add_widget(c)<br>        c.add_widget(<br>            AsyncImage(<br>                source=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&quot;http://www.everythingzoomer.com/wp-content/uploads/2013/01/Monday-joke-289x277.jpg&quot;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>,<br>                size_hint= (<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>),<br>                pos_hint=&#123;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;center_x&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;center_y&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;))<br>       <span class="hljs-built_in"> root</span>.add_widget(AsyncImage(source=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;http://www.stuffistumbledupon.com/wp-content/uploads/2012/05/Have-you-seen-this-dog-because-its-awesome-meme-puppy-doggy.jpg&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>))<br>        c = CustomLayout()<br>        c.add_widget(<br>            AsyncImage(<br>                source=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&quot;http://www.stuffistumbledupon.com/wp-content/uploads/2012/04/Get-a-Girlfriend-Meme-empty-wallet.jpg&quot;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>,<br>                size_hint= (<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>),<br>                pos_hint=&#123;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;center_x&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>, <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;center_y&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.5<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>&#125;))<br>       <span class="hljs-built_in"> root</span>.add_widget(c)<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>return<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="hljs-built_in"> root</span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>if<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> __name_<span class="hljs-number">_</span> == <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;__main__&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<br>    MainApp().run()<br></code></pre></td></tr></table></figure>

<p>使用 Kv 语言：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.app <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> App<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.floatlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> FloatLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.boxlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> BoxLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy<span class="hljs-built_in">.lang</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Builder<br><br><br>Builder.load_string(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;&#x27;&#x27;</span><br><span class="language-xml"><span class="hljs-symbol">&amp;lt;</span>CustomLayout<span class="hljs-symbol">&amp;gt;</span></span><br><span class="language-xml">    canvas.before:</span><br><span class="language-xml">        Color:</span><br><span class="language-xml">            rgba: 0, 1, 0, 1</span><br><span class="language-xml">        Rectangle:</span><br><span class="language-xml">            pos: self.pos</span><br><span class="language-xml">            size: self.size</span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-symbol">&amp;lt;</span>RootWidget<span class="hljs-symbol">&amp;gt;</span></span><br><span class="language-xml">    CustomLayout:</span><br><span class="language-xml">        AsyncImage:</span><br><span class="language-xml">            source: &#x27;http://www.everythingzoomer.com/wp-content/uploads/2013/01/Monday-joke-289x277.jpg&#x27;</span><br><span class="language-xml">            size_hint: 1, .5</span><br><span class="language-xml">            pos_hint: </span><span class="language-xquery">&#123;<span class="hljs-string">&#x27;center_x&#x27;</span>:.<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;center_y&#x27;</span>: .<span class="hljs-number">5</span>&#125;</span><span class="language-xml"></span><br><span class="language-xml">    AsyncImage:</span><br><span class="language-xml">        source: &#x27;http://www.stuffistumbledupon.com/wp-content/uploads/2012/05/Have-you-seen-this-dog-because-its-awesome-meme-puppy-doggy.jpg&#x27;</span><br><span class="language-xml">    CustomLayout</span><br><span class="language-xml">        AsyncImage:</span><br><span class="language-xml">            source: &#x27;http://www.stuffistumbledupon.com/wp-content/uploads/2012/04/Get-a-Girlfriend-Meme-empty-wallet.jpg&#x27;</span><br><span class="language-xml">            size_hint: 1, .5</span><br><span class="language-xml">            pos_hint: </span><span class="language-xquery">&#123;<span class="hljs-string">&#x27;center_x&#x27;</span>:.<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;center_y&#x27;</span>: .<span class="hljs-number">5</span>&#125;</span><span class="language-xml"></span><br><span class="language-xml">&#x27;&#x27;&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>RootWidget<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(BoxLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>pass<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>CustomLayout<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(FloatLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>pass<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>MainApp<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(App)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>build<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>return<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> RootWidget()<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>if<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> __name_<span class="hljs-number">_</span> == <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;__main__&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<br>    MainApp().run()<br></code></pre></td></tr></table></figure>

<p>上面这两个应用的效果都如下图所示：</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/custom_layout_background.png'><img src="https://kivy.org/docs/_images/custom_layout_background.png" alt="../_images/custom_layout_background.png"></p>
<p>在自定义布局类中定义了背景之后，就是要确保在自定义布局的各个实例中使用到这个新特性。</p>
<p>首先，要在<strong>全局上</strong>增加一个图形或者颜色给内置的 Kivy 布局的背景，这就需要将所用布局的默认 Kv 规则进行覆盖。</p>
<p>就拿网格布局 GridLayout 举例吧：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-symbol">&amp;lt;</span>GridLayout<span class="hljs-symbol">&amp;gt;</span><br>    canvas.before:<br>        Color:<br>            rgba: <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>, <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>, <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>, <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        BorderImage:<br>            source: <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;../examples/widgets/sequenced_images/data/images/button_white.png&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>            pos: self.pos<br>            size: self.size<br></code></pre></td></tr></table></figure>

<p>接下来把这段代码放到一个 Kivy 应用里面：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.app <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> App<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.floatlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> FloatLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy<span class="hljs-built_in">.lang</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Builder<br><br><br>Builder.load_string(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;&#x27;&#x27;</span><br><span class="language-xml"><span class="hljs-symbol">&amp;lt;</span>GridLayout<span class="hljs-symbol">&amp;gt;</span></span><br><span class="language-xml">    canvas.before:</span><br><span class="language-xml">        BorderImage:</span><br><span class="language-xml">            # BorderImage behaves like the CSS BorderImage</span><br><span class="language-xml">            border: 10, 10, 10, 10</span><br><span class="language-xml">            source: &#x27;../examples/widgets/sequenced_images/data/images/button_white.png&#x27;</span><br><span class="language-xml">            pos: self.pos</span><br><span class="language-xml">            size: self.size</span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-symbol">&amp;lt;</span>RootWidget<span class="hljs-symbol">&amp;gt;</span></span><br><span class="language-xml">    GridLayout:</span><br><span class="language-xml">        size_hint: .9, .9</span><br><span class="language-xml">        pos_hint: </span><span class="language-xquery">&#123;<span class="hljs-string">&#x27;center_x&#x27;</span>: .<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;center_y&#x27;</span>: .<span class="hljs-number">5</span>&#125;</span><span class="language-xml"></span><br><span class="language-xml">        rows:1</span><br><span class="language-xml">        Label:</span><br><span class="language-xml">            text: &quot;I don&#x27;t suffer from insanity, I enjoy every minute of it&quot;</span><br><span class="language-xml">            text_size: self.width-20, self.height-20</span><br><span class="language-xml">            valign: &#x27;top&#x27;</span><br><span class="language-xml">        Label:</span><br><span class="language-xml">            text: &quot;When I was born I was so surprised; I didn&#x27;t speak for a year and a half.&quot;</span><br><span class="language-xml">            text_size: self.width-20, self.height-20</span><br><span class="language-xml">            valign: &#x27;middle&#x27;</span><br><span class="language-xml">            halign: &#x27;center&#x27;</span><br><span class="language-xml">        Label:</span><br><span class="language-xml">            text: &quot;A consultant is someone who takes a subject you understand and makes it sound confusing&quot;</span><br><span class="language-xml">            text_size: self.width-20, self.height-20</span><br><span class="language-xml">            valign: &#x27;bottom&#x27;</span><br><span class="language-xml">            halign: &#x27;justify&#x27;</span><br><span class="language-xml">&#x27;&#x27;&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>RootWidget<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(FloatLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>pass<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>MainApp<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(App)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>build<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>return<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> RootWidget()<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>if<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> __name_<span class="hljs-number">_</span> == <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;__main__&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<br>    MainApp().run()<br></code></pre></td></tr></table></figure>

<p>效果大概如下图所示：</p>
<p class='item-img' data-src='https://kivy.org/docs/_images/global_background.png'><img src="https://kivy.org/docs/_images/global_background.png" alt="../_images/global_background.png"></p>
<p>我们已经对网格布局 GridLayout 类的规则进行了覆盖，所以接下来在应用中使用这个类就都会显示那幅图片了。</p>
<p><strong>动画背景</strong>怎么弄呢？</p>
<p>就像在矩形Rectangle&#x2F; 边界图像BorderImage &#x2F;椭圆Ellipse&#x2F;等里面添加设置绘图指令一样，可以用一个特定的纹理属性 texture ：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Rectangle:<br>    texture: <span class="hljs-keyword">reference</span> <span class="hljs-keyword">to</span> a texture<br></code></pre></td></tr></table></figure>

<p>可以用下面的代码实现一个动画背景：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.app <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> App<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.floatlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> FloatLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.gridlayout <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> GridLayout<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.uix.image <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Image<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy.properties <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> ObjectProperty<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>from<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> kivy<span class="hljs-built_in">.lang</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> Builder<br><br><br>Builder.load_string(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;&#x27;&#x27;</span><br><span class="language-xml"><span class="hljs-symbol">&amp;lt;</span>CustomLayout<span class="hljs-symbol">&amp;gt;</span></span><br><span class="language-xml">    canvas.before:</span><br><span class="language-xml">        BorderImage:</span><br><span class="language-xml">            # BorderImage behaves like the CSS BorderImage</span><br><span class="language-xml">            border: 10, 10, 10, 10</span><br><span class="language-xml">            texture: self.background_image.texture</span><br><span class="language-xml">            pos: self.pos</span><br><span class="language-xml">            size: self.size</span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-symbol">&amp;lt;</span>RootWidget<span class="hljs-symbol">&amp;gt;</span></span><br><span class="language-xml">    CustomLayout:</span><br><span class="language-xml">        size_hint: .9, .9</span><br><span class="language-xml">        pos_hint: </span><span class="language-xquery">&#123;<span class="hljs-string">&#x27;center_x&#x27;</span>: .<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;center_y&#x27;</span>: .<span class="hljs-number">5</span>&#125;</span><span class="language-xml"></span><br><span class="language-xml">        rows:1</span><br><span class="language-xml">        Label:</span><br><span class="language-xml">            text: &quot;I don&#x27;t suffer from insanity, I enjoy every minute of it&quot;</span><br><span class="language-xml">            text_size: self.width-20, self.height-20</span><br><span class="language-xml">            valign: &#x27;top&#x27;</span><br><span class="language-xml">        Label:</span><br><span class="language-xml">            text: &quot;When I was born I was so surprised; I didn&#x27;t speak for a year and a half.&quot;</span><br><span class="language-xml">            text_size: self.width-20, self.height-20</span><br><span class="language-xml">            valign: &#x27;middle&#x27;</span><br><span class="language-xml">            halign: &#x27;center&#x27;</span><br><span class="language-xml">        Label:</span><br><span class="language-xml">            text: &quot;A consultant is someone who takes a subject you understand and makes it sound confusing&quot;</span><br><span class="language-xml">            text_size: self.width-20, self.height-20</span><br><span class="language-xml">            valign: &#x27;bottom&#x27;</span><br><span class="language-xml">            halign: &#x27;justify&#x27;</span><br><span class="language-xml">&#x27;&#x27;&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>)<br><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>CustomLayout<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(GridLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    background_image = ObjectProperty(<br>        Image(<br>            source=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;../examples/widgets/sequenced_images/data/images/button_white_animated.zip&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>,<br>            anim_delay=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>))<br><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>RootWidget<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(FloatLayout)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>pass<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>class<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>MainApp<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(App)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>def<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"> </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>build<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>(self)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="language-xml">:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>return<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> RootWidget()<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>if<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span> __name_<span class="hljs-number">_</span> == <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x27;__main__&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>:<br>    MainApp().run()<br></code></pre></td></tr></table></figure>

<p>要理解这里到底发生了什么，得从第 13 行开始看：</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs glsl"><span class="hljs-built_in">texture</span>: self.background_image.<span class="hljs-built_in">texture</span><br></code></pre></td></tr></table></figure>

<p>这里是指定让边界图像 BorderImage 的纹理属性在背景图像 background_image 的纹理属性发生更新的时候进行同步更新。背景图像 background_image 属性的定义是在第 40 行：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">background_image</span> = ObjectProperty(...<br></code></pre></td></tr></table></figure>

<p>这一句代码是将背景图像 background_image 设置成一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.properties.html#kivy.properties.ObjectProperty" title="kivy.properties.ObjectProperty">对象属性 <code>ObjectProperty</code></a>，这样就可以在其中添加一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.image.html#kivy.uix.image.Image" title="kivy.uix.image.Image">图形控件 <code>Image</code></a>。图像控件有一个纹理属性（texture property）；在前面的 self.background_image.texture 这句代码中，就是建立了一个名为 texture 的到这个属性的引用。<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.image.html#kivy.uix.image.Image" title="kivy.uix.image.Image">图形控件 <code>Image</code></a> 支持动画（animation）：随着动画的改变，图像的纹理会同步更新，在这个过程中，边界图像 BorderImage 指令的 texture 纹理属性也会同步更新。</p>
<p>（译者注：texture of BorderImage instruction，这里我对 instruction 的翻译应该是不太对的，不过我还没理清楚该怎么表述。）</p>
<p>也可以直接传递自定义数据到纹理属性 texture。更多细节可以参考<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.texture.html#kivy.graphics.texture.Texture" title="kivy.graphics.texture.Texture">纹理 <code>Texture</code> 的文档</a>。</p>
<h2 id="网状布局"><a href="#网状布局" class="headerlink" title="网状布局"></a>网状布局</h2><p>嗯，看看这个过程如何扩展是很有趣的。</p>
<h2 id="尺寸和位置度量"><a href="#尺寸和位置度量" class="headerlink" title="尺寸和位置度量"></a>尺寸和位置度量</h2><p>Kivy 的默认长度单位是像素 pixel，所有的尺寸和位置都用这个单位来表达。你也可以用其他单位来衡量，在跨平台多种设备的时候，这有助于实现更好的连续性体验（这些设备会把尺寸自动转换到像素）。</p>
<p>可用单位包括 <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#kivy.metrics.pt" title="kivy.metrics.pt"><code>pt</code></a>， <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#kivy.metrics.mm" title="kivy.metrics.mm"><code>mm</code></a>，<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#kivy.metrics.cm" title="kivy.metrics.cm"><code>cm</code></a>, <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#kivy.metrics.inch" title="kivy.metrics.inch"><code>inch</code></a>， <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#kivy.metrics.dp" title="kivy.metrics.dp"><code>dp</code></a> and <a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#kivy.metrics.sp" title="kivy.metrics.sp"><code>sp</code></a>。可以在<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.metrics.html#module-kivy.metrics" title="kivy.metrics">度量文档 <code>metrics</code></a> 中了解更多相关内容。</p>
<p>你还可以探索一下<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.modules.screen.html#module-kivy.modules.screen" title="kivy.modules.screen">屏幕模块 <code>screen</code></a>的用法，这个可以模拟出不同设备的屏幕，供测试应用。</p>
<h2 id="使用屏幕管理器进行屏幕分割"><a href="#使用屏幕管理器进行屏幕分割" class="headerlink" title="使用屏幕管理器进行屏幕分割"></a>使用屏幕管理器进行屏幕分割</h2><p>如果你的应用程序要包含多个程序，那可能就需要从一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.screenmanager.html#kivy.uix.screenmanager.Screen" title="kivy.uix.screenmanager.Screen">屏幕 <code>Screen</code></a>到另一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.screenmanager.html#kivy.uix.screenmanager.Screen" title="kivy.uix.screenmanager.Screen">屏幕 <code>Screen</code></a>提供一个导航的通道。幸运的是，正好有一个<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.screenmanager.html#kivy.uix.screenmanager.ScreenManager" title="kivy.uix.screenmanager.ScreenManager">屏幕管理器类<code>ScreenManager</code></a>，这个类允许你来定义分开的各个屏幕，设置屏幕管理器的<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.uix.screenmanager.html#kivy.uix.screenmanager.TransitionBase" title="kivy.uix.screenmanager.TransitionBase"><code>TransitionBase</code></a>就可以实现从一个屏幕到另一个屏幕的跳转导航。</p>
<h1 id="图形"><a href="#图形" class="headerlink" title="图形"></a>图形</h1><p><a target="_blank" rel="noopener" href="https://kivy.org/docs/guide/graphics.html">英文原文</a></p>
<h2 id="译者前言"><a href="#译者前言" class="headerlink" title="译者前言"></a>译者前言</h2><p>这一章节比前两章节简单很多，翻译的也比较顺了。</p>
<h2 id="简介Canvas"><a href="#简介Canvas" class="headerlink" title="简介Canvas"></a>简介Canvas</h2><p>Kivy中控件图形呈现是使用Canvas完成的，可以将其看作一个无限的绘图板，也是一组绘图指令。有很多种绘图指令都可以应用或者添加到你的Canvas伤，不过总体上分为两类：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.context_instructions.html#module-kivy.graphics.context_instructions"><code>context instructions</code>环境指令</a></li>
<li><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.vertex_instructions.html#module-kivy.graphics.vertex_instructions"><code>vertex instructions</code>顶点指令</a></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.context_instructions.html#module-kivy.graphics.context_instructions"><code>context instructions</code>环境指令</a>不绘制任何图形，但会改变<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.vertex_instructions.html#module-kivy.graphics.vertex_instructions"><code>vertex instructions</code>顶点指令</a>的绘制结果。</p>
<p>Canvas都包含两个指令分支。分别是<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.html#kivy.graphics.Canvas.before"><code>canvas.before</code></a>和<a target="_blank" rel="noopener" href="https://kivy.org/docs/api-kivy.graphics.html#kivy.graphics.Canvas.after"><code>canvas.after</code></a> 这两种指令群。这两组指令分别在<code>Canvas</code>图形绘制前后执行。 绘制前的会被绘制的图形覆盖掉，绘制后的会覆盖在图形上层。这些指令都在用户对它们读取之后才会被创建。</p>
<p>要对一个控件添加Canvas绘图指令，需要使用Canvas环境指令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWidget</span>(<span class="hljs-title class_ inherited__">Widget</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        <span class="hljs-built_in">super</span>(MyWidget, self).__init__(**kwargs)<br>        <span class="hljs-keyword">with</span> self.canvas:<br>            <span class="hljs-comment"># add your instruction for main canvas here</span><br>            <span class="hljs-comment"># 这里是增加一个座位主绘图的指令</span><br><br>        <span class="hljs-keyword">with</span> self.canvas.before:<br>            <span class="hljs-comment"># you can use this to add instructions rendered before</span><br>            <span class="hljs-comment"># 这里可以在绘图之前添加指令</span><br><br>        <span class="hljs-keyword">with</span> self.canvas.after:<br>            <span class="hljs-comment"># you can use this to add instructions rendered after</span><br>            <span class="hljs-comment"># 这里可以在绘图之后添加指令</span><br></code></pre></td></tr></table></figure>

<h2 id="环境指令"><a href="#环境指令" class="headerlink" title="环境指令"></a>环境指令</h2><p>环境指令是用于操作opengl环境。 可以旋转，翻译和缩放画布。还可以附加纹理或更改绘图颜色。下面这段代码里面的是最常用到的更改颜色的指令，其他的环境指令也都很有用处：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">with</span> self.canvas.before:<br>    Color(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">.4</span>, mode=<span class="hljs-string">&#x27;rgb&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="绘图指令"><a href="#绘图指令" class="headerlink" title="绘图指令"></a>绘图指令</h2><p>绘图指令可简可繁，最简单的比如画一个多边形，更复杂的比如绘制网格或者贝塞尔曲线都可以：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">with</span> self.canvas:<br>   <span class="hljs-comment"># draw a line using the default color</span><br>   <span class="hljs-comment"># 用默认颜色画一条线</span><br>   Line(points=(x1, y1, x2, y2, x3, y3))<br><br>   <span class="hljs-comment"># lets draw a semi-transparent red square</span><br>   <span class="hljs-comment"># 接下来画一个半透明的红方块</span><br>   Color(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">.5</span>, mode=<span class="hljs-string">&#x27;rgba&#x27;</span>)<br>   Rectangle(pos=self.pos, size=self.size)<br></code></pre></td></tr></table></figure>

<h2 id="操作指令"><a href="#操作指令" class="headerlink" title="操作指令"></a>操作指令</h2><p>有时候可能需要把之前添加到Canvas绘图上的指令进行更改或者删除，这可以有很多种办法，要根据具体需求来选择：</p>
<p>可以给指令创建一个引用然后对其进行更新：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWidget</span>(<span class="hljs-title class_ inherited__">Widget</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        <span class="hljs-built_in">super</span>(MyWidget, self).__init__(**kwargs)<br>        <span class="hljs-keyword">with</span> self.canvas:<br>            self.rect = Rectangle(pos=self.pos, size=self.size)<br><br>        self.bind(pos=self.update_rect)<br>        self.bind(size=self.update_rect)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_rect</span>(<span class="hljs-params">self, *args</span>):<br>        self.rect.pos = self.pos<br>        self.rect.size = self.size<br></code></pre></td></tr></table></figure>

<p>或者也可以清空Canvas画布然后重新画：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWidget</span>(<span class="hljs-title class_ inherited__">Widget</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        <span class="hljs-built_in">super</span>(MyWidget, self).__init__(**kwargs)<br>        self.draw_my_stuff()<br><br>        self.bind(pos=self.draw_my_stuff)<br>        self.bind(size=self.draw_my_stuff)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">draw_my_stuff</span>(<span class="hljs-params">self</span>):<br>        self.canvas.clear()<br><br>        <span class="hljs-keyword">with</span> self.canvas:<br>            self.rect = Rectangle(pos=self.pos, size=self.size)<br></code></pre></td></tr></table></figure>

<p>要注意更新指令的方法是更好的选择，因为这样减少了开销，并且避免了创建新指令。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2024/07/11/NanUI%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">← Next NanUI使用文档</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2024/07/09/Ubuntu%E9%83%A8%E7%BD%B2%E8%AE%B0%E5%BD%95/">Ubuntu部署记录 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">zdx</a></h1><div id="description"><p>learn</p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/zdx-1"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:19546328912@163.com"><i class="fa fa-envelope" alt="E-Mail"></i></a><a class="social" target="_blank" rel="noopener" href="https://space.bilibili.com/353147531"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Kivy%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">Kivy简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%89%8D%E6%8F%90"><span class="toc-number">2.1.</span> <span class="toc-text">安装前提</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B"><span class="toc-number">2.2.</span> <span class="toc-text">安装过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80"><span class="toc-number">3.</span> <span class="toc-text">基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Kivy%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E6%90%AD%E5%BB%BA"><span class="toc-number">3.1.</span> <span class="toc-text">Kivy环境安装搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">创建一个应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kivy%E5%BA%94%E7%94%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">3.3.</span> <span class="toc-text">Kivy应用的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E5%BA%94%E7%94%A8"><span class="toc-number">3.4.</span> <span class="toc-text">运行应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AE%9A%E5%88%B6%E8%BF%99%E4%B8%AA%E5%BA%94%E7%94%A8"><span class="toc-number">3.5.</span> <span class="toc-text">修改定制这个应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83"><span class="toc-number">4.</span> <span class="toc-text">环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E6%8E%A7%E5%88%B6"><span class="toc-number">4.1.</span> <span class="toc-text">路径控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%88%AB%E6%B3%A8%E6%84%8F"><span class="toc-number">4.1.0.1.</span> <span class="toc-text">特别注意</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%90%E5%AE%9AKivy-core%E6%A0%B8%E5%BF%83%EF%BC%8C%E4%BD%BF%E7%94%A8%E7%89%B9%E5%AE%9A%E7%89%88%E6%9C%AC"><span class="toc-number">4.3.</span> <span class="toc-text">限定Kivy.core核心，使用特定版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E4%BD%8D"><span class="toc-number">4.4.</span> <span class="toc-text">设置单位</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E8%BE%93%E5%87%BA"><span class="toc-number">4.5.</span> <span class="toc-text">图形输出</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">5.</span> <span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BD%8D%E7%BD%AE"><span class="toc-number">5.1.</span> <span class="toc-text">找到配置文件位置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AE"><span class="toc-number">5.2.</span> <span class="toc-text">本地配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E7%90%86%E8%A7%A3%E9%85%8D%E7%BD%AE%E9%A1%B9"><span class="toc-number">5.3.</span> <span class="toc-text">详细理解配置项</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">6.</span> <span class="toc-text">架构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A8%A1%E5%9D%97%E5%92%8C%E8%BE%93%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="toc-number">6.1.</span> <span class="toc-text">核心模块和输入模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E6%8E%A5%E5%8F%A3"><span class="toc-number">6.2.</span> <span class="toc-text">图形接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A8%A1%E5%9D%97"><span class="toc-number">6.3.</span> <span class="toc-text">核心模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIX%EF%BC%88%E6%8E%A7%E4%BB%B6%E5%92%8C%E5%B8%83%E5%B1%80%EF%BC%89"><span class="toc-number">6.4.</span> <span class="toc-text">UIX（控件和布局）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">6.5.</span> <span class="toc-text">模块化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E4%BA%8B%E4%BB%B6%EF%BC%88Touches%EF%BC%89"><span class="toc-number">6.6.</span> <span class="toc-text">输入事件（Touches）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E5%92%8C%E4%BA%8B%E4%BB%B6%E8%B0%83%E5%BA%A6"><span class="toc-number">6.7.</span> <span class="toc-text">控件和事件调度</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6"><span class="toc-number">7.</span> <span class="toc-text">控件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E7%AE%80%E4%BB%8B"><span class="toc-number">7.1.</span> <span class="toc-text">控件简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%8E%A7%E4%BB%B6%E6%A0%91"><span class="toc-number">7.2.</span> <span class="toc-text">操作控件树</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%88%AB%E6%B3%A8%E6%84%8F-1"><span class="toc-number">7.2.0.1.</span> <span class="toc-text">特别注意</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E6%8E%A7%E4%BB%B6%E6%A0%91"><span class="toc-number">7.3.</span> <span class="toc-text">遍历控件树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E4%BB%B6%E7%B4%A2%E5%BC%95Z"><span class="toc-number">7.4.</span> <span class="toc-text">控件索引Z</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E7%90%86%E5%B8%83%E5%B1%80"><span class="toc-number">7.5.</span> <span class="toc-text">整理布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%99%E5%B8%83%E5%B1%80%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF"><span class="toc-number">7.6.</span> <span class="toc-text">给布局添加背景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%83%E5%B1%80%E8%A7%84%E5%88%99-%E7%B1%BB%E5%A2%9E%E5%8A%A0%E8%83%8C%E6%99%AF%E8%89%B2"><span class="toc-number">7.6.1.</span> <span class="toc-text">给自定义布局规则&#x2F;类增加背景色</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%8A%B6%E5%B8%83%E5%B1%80"><span class="toc-number">7.7.</span> <span class="toc-text">网状布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%BA%E5%AF%B8%E5%92%8C%E4%BD%8D%E7%BD%AE%E5%BA%A6%E9%87%8F"><span class="toc-number">7.8.</span> <span class="toc-text">尺寸和位置度量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B1%8F%E5%B9%95%E7%AE%A1%E7%90%86%E5%99%A8%E8%BF%9B%E8%A1%8C%E5%B1%8F%E5%B9%95%E5%88%86%E5%89%B2"><span class="toc-number">7.9.</span> <span class="toc-text">使用屏幕管理器进行屏幕分割</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2"><span class="toc-number">8.</span> <span class="toc-text">图形</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%91%E8%80%85%E5%89%8D%E8%A8%80"><span class="toc-number">8.1.</span> <span class="toc-text">译者前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8BCanvas"><span class="toc-number">8.2.</span> <span class="toc-text">简介Canvas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%8C%87%E4%BB%A4"><span class="toc-number">8.3.</span> <span class="toc-text">环境指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%98%E5%9B%BE%E6%8C%87%E4%BB%A4"><span class="toc-number">8.4.</span> <span class="toc-text">绘图指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4"><span class="toc-number">8.5.</span> <span class="toc-text">操作指令</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>